cuda-11.8.0 loaded successful
gcc-9.3.0 loaded successful
cmake-3.27.0 loaded successful
openmpi-4.1.2 loaded successful
Openblas-0.3.25 loaded successful
/home/share/huadjyin/home/zhoumin3/.conda/envs/scgpt/lib/python3.9/site-packages/scgpt/model/multiomic_model.py:19: UserWarning: flash_attn is not installed
  warnings.warn("flash_attn is not installed")
/home/share/huadjyin/home/zhoumin3/.conda/envs/scgpt/lib/python3.9/site-packages/wandb/analytics/sentry.py:90: SentryHubDeprecationWarning: `sentry_sdk.Hub` is deprecated and will be removed in a future major release. Please consult our 1.x to 2.x migration guide for details on how to migrate `Hub` usage to the new API: https://docs.sentry.io/platforms/python/migration/1.x-to-2.x
  self.hub = sentry_sdk.Hub(client)
Creating pyg object for each cell in the data...
  0%|          | 0/207 [00:00<?, ?it/s]  0%|          | 1/207 [00:04<15:20,  4.47s/it]  1%|          | 2/207 [00:04<06:59,  2.05s/it]  1%|▏         | 3/207 [00:21<29:46,  8.76s/it]  2%|▏         | 4/207 [01:16<1:31:51, 27.15s/it]  2%|▏         | 5/207 [01:17<59:39, 17.72s/it]    3%|▎         | 6/207 [01:19<40:38, 12.13s/it]  3%|▎         | 7/207 [01:46<57:19, 17.20s/it]  4%|▍         | 8/207 [02:03<56:27, 17.02s/it]  4%|▍         | 9/207 [02:31<1:07:38, 20.50s/it]  5%|▍         | 10/207 [02:33<48:36, 14.81s/it]   5%|▌         | 11/207 [03:31<1:31:17, 27.95s/it]  6%|▌         | 12/207 [03:40<1:12:03, 22.17s/it]  6%|▋         | 13/207 [03:59<1:08:36, 21.22s/it]  7%|▋         | 14/207 [04:34<1:21:23, 25.30s/it]  7%|▋         | 15/207 [04:53<1:15:38, 23.64s/it]  8%|▊         | 16/207 [05:08<1:06:25, 20.87s/it]  8%|▊         | 17/207 [05:17<54:35, 17.24s/it]    9%|▊         | 18/207 [05:17<38:12, 12.13s/it]  9%|▉         | 19/207 [08:44<3:41:32, 70.70s/it] 10%|▉         | 20/207 [08:52<2:41:24, 51.79s/it] 10%|█         | 21/207 [10:30<3:23:36, 65.68s/it] 11%|█         | 22/207 [10:33<2:24:32, 46.88s/it] 11%|█         | 23/207 [10:34<1:41:17, 33.03s/it] 12%|█▏        | 24/207 [10:34<1:10:57, 23.26s/it] 12%|█▏        | 25/207 [10:38<53:20, 17.59s/it]   13%|█▎        | 26/207 [11:02<58:07, 19.27s/it] 13%|█▎        | 27/207 [11:17<54:02, 18.01s/it] 14%|█▎        | 28/207 [11:47<1:04:24, 21.59s/it] 14%|█▍        | 29/207 [11:49<47:16, 15.94s/it]   14%|█▍        | 30/207 [11:57<39:38, 13.44s/it] 15%|█▍        | 31/207 [12:03<33:04, 11.27s/it] 15%|█▌        | 32/207 [12:12<31:00, 10.63s/it] 16%|█▌        | 33/207 [12:20<28:14,  9.74s/it] 16%|█▋        | 34/207 [12:23<22:22,  7.76s/it] 17%|█▋        | 35/207 [12:25<16:55,  5.90s/it] 17%|█▋        | 36/207 [12:25<12:08,  4.26s/it] 18%|█▊        | 37/207 [12:26<08:49,  3.12s/it] 18%|█▊        | 38/207 [12:30<09:49,  3.49s/it] 19%|█▉        | 39/207 [12:34<10:29,  3.75s/it] 19%|█▉        | 40/207 [12:45<16:03,  5.77s/it] 20%|█▉        | 41/207 [12:47<12:39,  4.57s/it] 20%|██        | 42/207 [12:52<13:34,  4.94s/it] 21%|██        | 43/207 [12:55<11:57,  4.37s/it] 21%|██▏       | 44/207 [12:57<09:20,  3.44s/it] 22%|██▏       | 45/207 [13:01<10:09,  3.76s/it] 22%|██▏       | 46/207 [13:04<09:05,  3.39s/it] 23%|██▎       | 47/207 [13:04<06:52,  2.58s/it] 23%|██▎       | 48/207 [13:05<05:09,  1.95s/it] 24%|██▎       | 49/207 [13:11<08:25,  3.20s/it] 24%|██▍       | 50/207 [13:11<06:01,  2.31s/it] 25%|██▍       | 51/207 [13:15<07:19,  2.82s/it] 25%|██▌       | 52/207 [13:16<05:24,  2.10s/it] 26%|██▌       | 53/207 [13:16<04:10,  1.63s/it] 26%|██▌       | 54/207 [13:16<03:07,  1.23s/it] 27%|██▋       | 55/207 [13:25<08:36,  3.40s/it] 27%|██▋       | 56/207 [13:26<06:29,  2.58s/it] 28%|██▊       | 57/207 [13:26<04:54,  1.96s/it] 28%|██▊       | 58/207 [13:27<03:49,  1.54s/it] 29%|██▊       | 59/207 [13:27<03:11,  1.30s/it] 29%|██▉       | 60/207 [13:30<03:49,  1.56s/it] 29%|██▉       | 61/207 [13:36<07:36,  3.13s/it] 30%|██▉       | 62/207 [13:37<05:55,  2.45s/it] 30%|███       | 63/207 [13:39<05:07,  2.14s/it] 31%|███       | 64/207 [13:40<04:49,  2.03s/it] 31%|███▏      | 65/207 [13:41<03:33,  1.50s/it] 32%|███▏      | 66/207 [13:41<02:46,  1.18s/it] 32%|███▏      | 67/207 [13:42<02:39,  1.14s/it] 33%|███▎      | 68/207 [13:45<03:48,  1.64s/it] 33%|███▎      | 69/207 [13:45<02:47,  1.21s/it] 34%|███▍      | 70/207 [13:50<04:56,  2.16s/it] 34%|███▍      | 71/207 [13:51<04:25,  1.96s/it] 35%|███▍      | 72/207 [13:54<04:48,  2.14s/it] 35%|███▌      | 73/207 [13:55<04:14,  1.90s/it] 36%|███▌      | 74/207 [13:57<04:04,  1.84s/it] 36%|███▌      | 75/207 [13:58<03:53,  1.77s/it] 37%|███▋      | 76/207 [13:59<03:19,  1.52s/it] 37%|███▋      | 77/207 [13:59<02:28,  1.14s/it] 38%|███▊      | 78/207 [14:00<02:03,  1.04it/s] 38%|███▊      | 79/207 [14:03<03:16,  1.54s/it] 39%|███▊      | 80/207 [14:04<03:06,  1.47s/it] 39%|███▉      | 81/207 [14:09<05:07,  2.44s/it] 40%|███▉      | 82/207 [14:11<04:53,  2.35s/it] 40%|████      | 83/207 [14:11<03:36,  1.75s/it] 41%|████      | 84/207 [14:12<02:43,  1.33s/it] 41%|████      | 85/207 [14:14<03:27,  1.70s/it] 42%|████▏     | 86/207 [14:15<02:35,  1.29s/it] 42%|████▏     | 87/207 [14:16<02:28,  1.24s/it] 43%|████▎     | 88/207 [14:16<02:00,  1.01s/it] 43%|████▎     | 89/207 [14:17<01:38,  1.19it/s] 43%|████▎     | 90/207 [14:18<01:49,  1.07it/s] 44%|████▍     | 91/207 [14:18<01:25,  1.36it/s] 44%|████▍     | 92/207 [14:20<01:51,  1.03it/s] 45%|████▍     | 93/207 [14:20<01:32,  1.24it/s] 45%|████▌     | 94/207 [14:22<01:55,  1.03s/it] 46%|████▌     | 95/207 [14:22<01:33,  1.19it/s] 46%|████▋     | 96/207 [14:22<01:17,  1.42it/s] 47%|████▋     | 97/207 [14:23<01:12,  1.52it/s] 47%|████▋     | 98/207 [14:23<01:10,  1.56it/s] 48%|████▊     | 99/207 [14:24<01:19,  1.36it/s] 48%|████▊     | 100/207 [14:26<01:42,  1.04it/s] 49%|████▉     | 101/207 [14:28<02:22,  1.34s/it] 49%|████▉     | 102/207 [14:29<02:05,  1.20s/it] 50%|████▉     | 103/207 [14:30<01:47,  1.04s/it] 50%|█████     | 104/207 [14:30<01:40,  1.02it/s] 51%|█████     | 105/207 [14:31<01:33,  1.09it/s] 51%|█████     | 106/207 [14:32<01:14,  1.36it/s] 52%|█████▏    | 107/207 [14:36<03:09,  1.89s/it] 52%|█████▏    | 108/207 [14:37<02:22,  1.44s/it] 53%|█████▎    | 109/207 [14:37<01:49,  1.12s/it] 53%|█████▎    | 110/207 [14:40<02:34,  1.59s/it] 54%|█████▎    | 111/207 [14:40<01:52,  1.17s/it] 54%|█████▍    | 112/207 [14:40<01:25,  1.11it/s] 55%|█████▍    | 113/207 [14:41<01:12,  1.30it/s] 55%|█████▌    | 114/207 [14:41<01:14,  1.25it/s] 56%|█████▌    | 115/207 [14:42<00:57,  1.60it/s] 56%|█████▌    | 116/207 [14:44<01:53,  1.25s/it] 57%|█████▋    | 117/207 [14:45<01:35,  1.07s/it] 57%|█████▋    | 118/207 [14:45<01:18,  1.13it/s] 57%|█████▋    | 119/207 [14:46<01:03,  1.40it/s] 58%|█████▊    | 120/207 [14:47<01:11,  1.21it/s] 58%|█████▊    | 121/207 [14:47<00:55,  1.55it/s] 59%|█████▉    | 122/207 [14:47<00:44,  1.92it/s] 59%|█████▉    | 123/207 [14:48<00:40,  2.05it/s] 60%|█████▉    | 124/207 [14:50<01:24,  1.02s/it] 60%|██████    | 125/207 [14:50<01:05,  1.25it/s] 61%|██████    | 126/207 [14:51<00:57,  1.41it/s] 61%|██████▏   | 127/207 [14:51<00:54,  1.47it/s] 62%|██████▏   | 128/207 [14:52<00:45,  1.72it/s] 62%|██████▏   | 129/207 [14:53<01:08,  1.14it/s] 63%|██████▎   | 130/207 [14:54<01:05,  1.18it/s] 63%|██████▎   | 131/207 [14:55<00:55,  1.36it/s] 64%|██████▍   | 132/207 [14:55<00:44,  1.68it/s] 64%|██████▍   | 133/207 [14:55<00:41,  1.77it/s] 65%|██████▍   | 134/207 [14:56<00:49,  1.48it/s] 65%|██████▌   | 135/207 [14:56<00:39,  1.84it/s] 66%|██████▌   | 136/207 [14:57<00:44,  1.61it/s] 66%|██████▌   | 137/207 [14:58<00:44,  1.56it/s] 67%|██████▋   | 138/207 [14:58<00:36,  1.89it/s] 67%|██████▋   | 139/207 [14:59<00:36,  1.87it/s] 68%|██████▊   | 140/207 [14:59<00:36,  1.82it/s] 68%|██████▊   | 141/207 [15:00<00:39,  1.69it/s] 69%|██████▊   | 142/207 [15:00<00:30,  2.10it/s] 69%|██████▉   | 143/207 [15:01<00:31,  2.01it/s] 70%|██████▉   | 144/207 [15:01<00:30,  2.05it/s] 70%|███████   | 145/207 [15:01<00:24,  2.49it/s] 71%|███████   | 146/207 [15:02<00:21,  2.83it/s] 71%|███████   | 147/207 [15:03<00:34,  1.74it/s] 71%|███████▏  | 148/207 [15:03<00:27,  2.15it/s] 72%|███████▏  | 149/207 [15:04<00:31,  1.87it/s] 72%|███████▏  | 150/207 [15:04<00:27,  2.09it/s] 73%|███████▎  | 151/207 [15:05<00:28,  1.99it/s] 73%|███████▎  | 152/207 [15:05<00:27,  2.00it/s] 74%|███████▍  | 153/207 [15:06<00:27,  1.97it/s] 74%|███████▍  | 154/207 [15:07<00:41,  1.27it/s] 75%|███████▍  | 155/207 [15:07<00:32,  1.61it/s] 75%|███████▌  | 156/207 [15:08<00:29,  1.71it/s] 76%|███████▌  | 157/207 [15:09<00:35,  1.40it/s] 76%|███████▋  | 158/207 [15:09<00:27,  1.75it/s] 77%|███████▋  | 159/207 [15:09<00:24,  1.95it/s] 77%|███████▋  | 160/207 [15:10<00:22,  2.11it/s] 78%|███████▊  | 161/207 [15:10<00:23,  1.98it/s] 78%|███████▊  | 162/207 [15:11<00:24,  1.83it/s] 79%|███████▊  | 163/207 [15:11<00:19,  2.25it/s] 79%|███████▉  | 164/207 [15:12<00:19,  2.20it/s] 80%|███████▉  | 165/207 [15:12<00:18,  2.32it/s] 80%|████████  | 166/207 [15:12<00:15,  2.56it/s] 81%|████████  | 167/207 [15:13<00:19,  2.08it/s] 81%|████████  | 168/207 [15:13<00:16,  2.31it/s] 82%|████████▏ | 169/207 [15:14<00:13,  2.74it/s] 82%|████████▏ | 170/207 [15:14<00:14,  2.47it/s] 83%|████████▎ | 171/207 [15:15<00:16,  2.14it/s] 83%|████████▎ | 172/207 [15:15<00:13,  2.64it/s] 84%|████████▎ | 173/207 [15:15<00:11,  3.06it/s] 84%|████████▍ | 174/207 [15:16<00:12,  2.69it/s] 85%|████████▍ | 175/207 [15:16<00:12,  2.49it/s] 85%|████████▌ | 176/207 [15:16<00:12,  2.43it/s] 86%|████████▌ | 177/207 [15:17<00:10,  2.86it/s] 86%|████████▌ | 178/207 [15:17<00:11,  2.44it/s] 86%|████████▋ | 179/207 [15:18<00:14,  1.90it/s] 87%|████████▋ | 180/207 [15:18<00:11,  2.37it/s] 87%|████████▋ | 181/207 [15:19<00:12,  2.12it/s] 88%|████████▊ | 182/207 [15:19<00:10,  2.40it/s] 88%|████████▊ | 183/207 [15:19<00:09,  2.45it/s] 89%|████████▉ | 184/207 [15:20<00:09,  2.53it/s] 89%|████████▉ | 185/207 [15:20<00:07,  3.03it/s] 90%|████████▉ | 186/207 [15:20<00:05,  3.51it/s] 90%|█████████ | 187/207 [15:21<00:06,  2.92it/s] 91%|█████████ | 188/207 [15:21<00:05,  3.22it/s] 91%|█████████▏| 189/207 [15:21<00:05,  3.58it/s] 92%|█████████▏| 190/207 [15:21<00:04,  4.02it/s] 92%|█████████▏| 191/207 [15:21<00:03,  4.41it/s] 93%|█████████▎| 192/207 [15:22<00:04,  3.45it/s] 93%|█████████▎| 193/207 [15:22<00:03,  3.86it/s] 94%|█████████▎| 194/207 [15:22<00:03,  4.12it/s] 94%|█████████▍| 195/207 [15:23<00:03,  3.53it/s] 95%|█████████▍| 196/207 [15:23<00:03,  3.39it/s] 95%|█████████▌| 197/207 [15:23<00:02,  3.86it/s] 96%|█████████▌| 198/207 [15:23<00:02,  4.22it/s] 96%|█████████▌| 199/207 [15:24<00:01,  4.18it/s] 97%|█████████▋| 200/207 [15:24<00:01,  4.54it/s] 97%|█████████▋| 201/207 [15:24<00:01,  4.14it/s] 98%|█████████▊| 202/207 [15:24<00:01,  4.34it/s] 98%|█████████▊| 203/207 [15:25<00:00,  4.33it/s] 99%|█████████▊| 204/207 [15:25<00:00,  4.31it/s] 99%|█████████▉| 205/207 [15:25<00:00,  4.45it/s]100%|█████████▉| 206/207 [15:25<00:00,  4.76it/s]100%|██████████| 207/207 [15:25<00:00,  4.80it/s]100%|██████████| 207/207 [15:25<00:00,  4.47s/it]
Saving new dataset pyg object at /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/tiankampmann2019_day7neuron/data_pyg/cell_graphs.pkl
Done!
wandb: Currently logged in as: zhoumin1130. Use `wandb login --relogin` to force relogin
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.5
wandb: Run data is saved locally in /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/script/wandb/run-20240726_084618-dwbx2xod
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run TianKampmann2019_day7neuron_split1
wandb: ⭐️ View project at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: 🚀 View run at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/dwbx2xod
Local copy of pyg dataset is detected. Loading...
Done!
Creating new splits....
Saving new splits at /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/tiankampmann2019_day7neuron/splits/tiankampmann2019_day7neuron_simulation_1_0.75.pkl
Simulation split test composition:
combo_seen0:16
combo_seen1:76
combo_seen2:22
unseen_single:7
Done!
Creating dataloaders....
Done!
wandb: - 0.001 MB of 0.001 MB uploadedwandb: \ 0.001 MB of 0.035 MB uploadedwandb: | 0.013 MB of 0.035 MB uploadedwandb: / 0.013 MB of 0.035 MB uploadedwandb: - 0.035 MB of 0.035 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: elapsed_time ▃▁▃▅▆▅█
wandb:        epoch ▁▂▃▅▆▇█
wandb:     val_loss ▃▁▄▂▁▂█
wandb:      val_mre ▆█▇▄▁▃▄
wandb: 
wandb: Run summary:
wandb:     best_model_info Best model with scor...
wandb:     early_stop_info Early stop at epoch ...
wandb:        elapsed_time 209.8286
wandb:               epoch 7
wandb: loading_params_info Loading params trans...
wandb:          match_info match 4455/5016 gene...
wandb:   resume_model_info Resume model from /h...
wandb:            run_time 2024-07-26 08:46:34
wandb:            val_loss 0.00911
wandb:             val_mre 11605.73972
wandb: 
wandb: 🚀 View run TianKampmann2019_day7neuron_split1 at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/dwbx2xod
wandb: ⭐️ View project at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240726_084618-dwbx2xod/logs
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
wandb: Tracking run with wandb version 0.17.5
wandb: Run data is saved locally in /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/script/wandb/run-20240726_092344-zdhuf0cv
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run TianKampmann2019_day7neuron_split2
wandb: ⭐️ View project at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: 🚀 View run at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/zdhuf0cv
Local copy of pyg dataset is detected. Loading...
Done!
Creating new splits....
Saving new splits at /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/tiankampmann2019_day7neuron/splits/tiankampmann2019_day7neuron_simulation_2_0.75.pkl
Simulation split test composition:
combo_seen0:18
combo_seen1:77
combo_seen2:22
unseen_single:7
Done!
Creating dataloaders....
Done!
wandb: - 0.001 MB of 0.001 MB uploadedwandb: \ 0.001 MB of 0.037 MB uploadedwandb: | 0.001 MB of 0.037 MB uploadedwandb: / 0.002 MB of 0.037 MB uploadedwandb: - 0.002 MB of 0.037 MB uploadedwandb: \ 0.037 MB of 0.037 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: elapsed_time ▁▂▄▆█▅▆██▅▃
wandb:        epoch ▁▂▂▃▄▅▅▆▇▇█
wandb:     val_loss ▂▁▄▃█▁▅▃▂▂▂
wandb:      val_mre █▆▂▃▆▄▄▅▁█▁
wandb: 
wandb: Run summary:
wandb:     best_model_info Best model with scor...
wandb:     early_stop_info Early stop at epoch ...
wandb:        elapsed_time 218.18797
wandb:               epoch 11
wandb: loading_params_info Loading params trans...
wandb:          match_info match 4455/5016 gene...
wandb:   resume_model_info Resume model from /h...
wandb:            run_time 2024-07-26 09:23:58
wandb:            val_loss 0.00923
wandb:             val_mre 12034.58973
wandb: 
wandb: 🚀 View run TianKampmann2019_day7neuron_split2 at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/zdhuf0cv
wandb: ⭐️ View project at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240726_092344-zdhuf0cv/logs
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.5
wandb: Run data is saved locally in /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/script/wandb/run-20240726_101316-spwjzg22
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run TianKampmann2019_day7neuron_split3
wandb: ⭐️ View project at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: 🚀 View run at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/spwjzg22
Local copy of pyg dataset is detected. Loading...
Done!
Creating new splits....
Saving new splits at /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/tiankampmann2019_day7neuron/splits/tiankampmann2019_day7neuron_simulation_3_0.75.pkl
Simulation split test composition:
combo_seen0:18
combo_seen1:79
combo_seen2:21
unseen_single:7
Done!
Creating dataloaders....
Done!
wandb: - 0.001 MB of 0.001 MB uploadedwandb: \ 0.001 MB of 0.037 MB uploadedwandb: | 0.002 MB of 0.037 MB uploadedwandb: / 0.002 MB of 0.037 MB uploadedwandb: - 0.037 MB of 0.037 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: elapsed_time ▅█▇▃▁▁▁
wandb:        epoch ▁▂▃▅▆▇█
wandb:     val_loss ▂▁▂▇█▇█
wandb:      val_mre ▆▁▇█▂▃▆
wandb: 
wandb: Run summary:
wandb:     best_model_info Best model with scor...
wandb:     early_stop_info Early stop at epoch ...
wandb:        elapsed_time 290.24589
wandb:               epoch 7
wandb: loading_params_info Loading params trans...
wandb:          match_info match 4455/5016 gene...
wandb:   resume_model_info Resume model from /h...
wandb:            run_time 2024-07-26 10:13:30
wandb:            val_loss 0.01142
wandb:             val_mre 15931.14973
wandb: 
wandb: 🚀 View run TianKampmann2019_day7neuron_split3 at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/spwjzg22
wandb: ⭐️ View project at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240726_101316-spwjzg22/logs
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.5
wandb: Run data is saved locally in /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/script/wandb/run-20240726_105517-6rkdl7z5
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run TianKampmann2019_day7neuron_split4
wandb: ⭐️ View project at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: 🚀 View run at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/6rkdl7z5
Local copy of pyg dataset is detected. Loading...
Done!
Creating new splits....
Saving new splits at /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/tiankampmann2019_day7neuron/splits/tiankampmann2019_day7neuron_simulation_4_0.75.pkl
Simulation split test composition:
combo_seen0:15
combo_seen1:81
combo_seen2:21
unseen_single:7
Done!
Creating dataloaders....
Done!
wandb: - 0.001 MB of 0.038 MB uploadedwandb: \ 0.001 MB of 0.038 MB uploadedwandb: | 0.013 MB of 0.038 MB uploadedwandb: / 0.013 MB of 0.038 MB uploadedwandb: - 0.038 MB of 0.038 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: elapsed_time ▅▆▇██▆▁▁▁▁
wandb:        epoch ▁▂▃▃▄▅▆▆▇█
wandb:     val_loss ▄▅██▁     
wandb:      val_mre ▁█▃▂▂     
wandb: 
wandb: Run summary:
wandb:     best_model_info Best model with scor...
wandb:     early_stop_info Early stop at epoch ...
wandb:        elapsed_time 232.59921
wandb:               epoch 10
wandb: loading_params_info Loading params trans...
wandb:          match_info match 4455/5016 gene...
wandb:   resume_model_info Resume model from /h...
wandb:            run_time 2024-07-26 10:55:32
wandb:            val_loss nan
wandb:             val_mre nan
wandb: 
wandb: 🚀 View run TianKampmann2019_day7neuron_split4 at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/6rkdl7z5
wandb: ⭐️ View project at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240726_105517-6rkdl7z5/logs
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
wandb: Tracking run with wandb version 0.17.5
wandb: Run data is saved locally in /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/script/wandb/run-20240726_114537-50m8ftcu
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run TianKampmann2019_day7neuron_split5
wandb: ⭐️ View project at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: 🚀 View run at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/50m8ftcu
Local copy of pyg dataset is detected. Loading...
Done!
Creating new splits....
Saving new splits at /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/tiankampmann2019_day7neuron/splits/tiankampmann2019_day7neuron_simulation_5_0.75.pkl
Simulation split test composition:
combo_seen0:13
combo_seen1:75
combo_seen2:23
unseen_single:7
Done!
Creating dataloaders....
Done!
wandb: - 0.001 MB of 0.001 MB uploadedwandb: \ 0.001 MB of 0.040 MB uploadedwandb: | 0.035 MB of 0.040 MB uploadedwandb: / 0.040 MB of 0.040 MB uploadedwandb: - 0.040 MB of 0.040 MB uploadedwandb: \ 0.040 MB of 0.040 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: elapsed_time ▁▂▃▄▄▄█▇▆▇▇▆▆█
wandb:        epoch ▁▂▂▃▃▄▄▅▅▆▆▇▇█
wandb:     val_loss ▄▄▃█▂▂▇▃▁▅▃▃▂▂
wandb:      val_mre ▂▄█▆▆▁▅▃▂▅▂▂▂▁
wandb: 
wandb: Run summary:
wandb:     best_model_info Best model with scor...
wandb:     early_stop_info Early stop at epoch ...
wandb:        elapsed_time 210.06465
wandb:               epoch 14
wandb: loading_params_info Loading params trans...
wandb:          match_info match 4455/5016 gene...
wandb:   resume_model_info Resume model from /h...
wandb:            run_time 2024-07-26 11:45:53
wandb:            val_loss 0.00883
wandb:             val_mre 9985.8847
wandb: 
wandb: 🚀 View run TianKampmann2019_day7neuron_split5 at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/50m8ftcu
wandb: ⭐️ View project at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240726_114537-50m8ftcu/logs
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
/home/share/huadjyin/home/zhoumin3/.conda/envs/scgpt/lib/python3.9/site-packages/scgpt/model/multiomic_model.py:19: UserWarning: flash_attn is not installed
  warnings.warn("flash_attn is not installed")
/home/share/huadjyin/home/zhoumin3/.conda/envs/scgpt/lib/python3.9/site-packages/wandb/analytics/sentry.py:90: SentryHubDeprecationWarning: `sentry_sdk.Hub` is deprecated and will be removed in a future major release. Please consult our 1.x to 2.x migration guide for details on how to migrate `Hub` usage to the new API: https://docs.sentry.io/platforms/python/migration/1.x-to-2.x
  self.hub = sentry_sdk.Hub(client)
Creating pyg object for each cell in the data...
  0%|          | 0/249 [00:00<?, ?it/s]  0%|          | 1/249 [00:42<2:55:51, 42.55s/it]  1%|          | 2/249 [00:54<1:40:11, 24.34s/it]  1%|          | 3/249 [00:58<1:03:10, 15.41s/it]  2%|▏         | 4/249 [03:27<4:37:41, 68.01s/it]  2%|▏         | 5/249 [05:06<5:21:48, 79.13s/it]  2%|▏         | 6/249 [05:21<3:52:06, 57.31s/it]  3%|▎         | 7/249 [05:24<2:39:11, 39.47s/it]  3%|▎         | 8/249 [05:56<2:29:16, 37.16s/it]  4%|▎         | 9/249 [05:56<1:42:36, 25.65s/it]  4%|▍         | 10/249 [06:00<1:15:01, 18.83s/it]  5%|▍         | 12/249 [06:00<39:55, 10.11s/it]    5%|▌         | 13/249 [06:12<41:37, 10.58s/it]  6%|▌         | 14/249 [06:20<38:28,  9.83s/it]  6%|▌         | 15/249 [06:21<29:23,  7.54s/it]  6%|▋         | 16/249 [07:05<1:08:37, 17.67s/it]  7%|▋         | 17/249 [07:39<1:26:06, 22.27s/it]  7%|▋         | 18/249 [07:58<1:22:28, 21.42s/it]  8%|▊         | 19/249 [08:05<1:06:26, 17.33s/it]  8%|▊         | 20/249 [08:17<59:05, 15.48s/it]    8%|▊         | 21/249 [08:18<42:59, 11.31s/it]  9%|▉         | 22/249 [08:22<35:07,  9.28s/it]  9%|▉         | 23/249 [08:31<34:23,  9.13s/it] 10%|▉         | 24/249 [08:32<25:05,  6.69s/it] 10%|█         | 25/249 [08:45<31:15,  8.37s/it] 10%|█         | 26/249 [08:57<35:39,  9.59s/it] 11%|█         | 27/249 [08:59<27:21,  7.40s/it] 11%|█         | 28/249 [09:07<27:24,  7.44s/it] 12%|█▏        | 29/249 [09:07<19:27,  5.30s/it] 12%|█▏        | 30/249 [09:08<14:47,  4.05s/it] 12%|█▏        | 31/249 [09:08<10:25,  2.87s/it] 13%|█▎        | 32/249 [09:12<11:28,  3.17s/it] 13%|█▎        | 33/249 [09:12<08:10,  2.27s/it] 14%|█▎        | 34/249 [09:22<16:33,  4.62s/it] 14%|█▍        | 35/249 [09:40<30:01,  8.42s/it] 14%|█▍        | 36/249 [09:42<23:47,  6.70s/it] 15%|█▍        | 37/249 [09:44<18:00,  5.10s/it] 15%|█▌        | 38/249 [09:46<15:18,  4.35s/it] 16%|█▌        | 39/249 [09:47<10:48,  3.09s/it] 16%|█▌        | 40/249 [09:47<08:20,  2.39s/it] 16%|█▋        | 41/249 [09:54<13:05,  3.78s/it] 17%|█▋        | 42/249 [09:55<10:06,  2.93s/it] 17%|█▋        | 43/249 [09:58<10:00,  2.91s/it] 18%|█▊        | 44/249 [10:02<10:46,  3.15s/it] 18%|█▊        | 45/249 [10:06<11:29,  3.38s/it] 18%|█▊        | 46/249 [10:13<15:05,  4.46s/it] 19%|█▉        | 47/249 [10:14<11:57,  3.55s/it] 19%|█▉        | 48/249 [10:20<14:00,  4.18s/it] 20%|█▉        | 49/249 [10:22<12:20,  3.70s/it] 20%|██        | 50/249 [10:27<12:59,  3.92s/it] 20%|██        | 51/249 [10:28<09:55,  3.01s/it] 21%|██        | 52/249 [10:30<09:03,  2.76s/it] 21%|██▏       | 53/249 [10:32<08:37,  2.64s/it] 22%|██▏       | 54/249 [10:32<06:10,  1.90s/it] 22%|██▏       | 55/249 [10:34<05:58,  1.85s/it] 22%|██▏       | 56/249 [10:38<08:18,  2.58s/it] 23%|██▎       | 57/249 [10:44<11:08,  3.48s/it] 23%|██▎       | 58/249 [10:48<11:59,  3.77s/it] 24%|██▎       | 59/249 [10:52<11:17,  3.56s/it] 24%|██▍       | 60/249 [10:52<08:11,  2.60s/it] 24%|██▍       | 61/249 [10:52<06:13,  1.99s/it] 25%|██▍       | 62/249 [10:53<04:53,  1.57s/it] 25%|██▌       | 63/249 [10:56<05:57,  1.92s/it] 26%|██▌       | 64/249 [10:58<05:42,  1.85s/it] 26%|██▌       | 65/249 [11:01<07:31,  2.45s/it] 27%|██▋       | 66/249 [11:02<05:40,  1.86s/it] 27%|██▋       | 67/249 [11:02<04:20,  1.43s/it] 27%|██▋       | 68/249 [11:02<03:09,  1.05s/it] 28%|██▊       | 69/249 [11:06<05:37,  1.87s/it] 28%|██▊       | 70/249 [11:06<04:01,  1.35s/it] 29%|██▊       | 71/249 [11:07<02:58,  1.01s/it] 29%|██▉       | 72/249 [11:07<02:20,  1.26it/s] 29%|██▉       | 73/249 [11:07<02:11,  1.34it/s] 30%|███       | 75/249 [11:08<01:17,  2.24it/s] 31%|███       | 76/249 [11:09<01:42,  1.68it/s] 31%|███       | 77/249 [11:09<01:25,  2.01it/s] 31%|███▏      | 78/249 [11:11<02:44,  1.04it/s] 32%|███▏      | 79/249 [11:11<02:03,  1.38it/s] 32%|███▏      | 80/249 [11:11<01:37,  1.74it/s] 33%|███▎      | 81/249 [11:13<02:40,  1.05it/s] 33%|███▎      | 82/249 [11:14<02:13,  1.25it/s] 33%|███▎      | 83/249 [11:14<01:51,  1.49it/s] 34%|███▎      | 84/249 [11:15<02:14,  1.23it/s] 34%|███▍      | 85/249 [11:16<01:48,  1.51it/s] 35%|███▍      | 86/249 [11:17<02:39,  1.02it/s] 35%|███▍      | 87/249 [11:18<02:03,  1.31it/s] 35%|███▌      | 88/249 [11:19<02:38,  1.01it/s] 36%|███▌      | 89/249 [11:20<02:44,  1.03s/it] 36%|███▌      | 90/249 [11:21<02:13,  1.19it/s] 37%|███▋      | 91/249 [11:21<01:51,  1.42it/s] 37%|███▋      | 92/249 [11:23<02:32,  1.03it/s] 37%|███▋      | 93/249 [11:23<01:53,  1.38it/s] 38%|███▊      | 94/249 [11:23<01:49,  1.41it/s] 38%|███▊      | 95/249 [11:24<01:27,  1.75it/s] 39%|███▊      | 96/249 [11:25<01:54,  1.33it/s] 39%|███▉      | 97/249 [11:28<03:52,  1.53s/it] 39%|███▉      | 98/249 [11:29<02:57,  1.18s/it] 40%|███▉      | 99/249 [11:30<02:48,  1.12s/it] 40%|████      | 100/249 [11:30<02:32,  1.03s/it] 41%|████      | 101/249 [11:32<03:07,  1.26s/it] 41%|████      | 102/249 [11:33<02:38,  1.08s/it] 41%|████▏     | 103/249 [11:34<02:36,  1.07s/it] 42%|████▏     | 104/249 [11:34<02:05,  1.15it/s] 42%|████▏     | 105/249 [11:35<02:00,  1.20it/s] 43%|████▎     | 106/249 [11:36<01:56,  1.23it/s] 43%|████▎     | 107/249 [11:37<02:04,  1.14it/s] 43%|████▎     | 108/249 [11:38<02:20,  1.00it/s] 44%|████▍     | 109/249 [11:41<03:30,  1.51s/it] 44%|████▍     | 110/249 [11:42<03:02,  1.31s/it] 45%|████▍     | 111/249 [11:43<02:42,  1.18s/it] 45%|████▍     | 112/249 [11:45<03:25,  1.50s/it] 45%|████▌     | 113/249 [11:46<02:57,  1.30s/it] 46%|████▌     | 114/249 [11:46<02:13,  1.01it/s] 46%|████▌     | 115/249 [11:47<02:07,  1.05it/s] 47%|████▋     | 116/249 [11:48<02:07,  1.04it/s] 47%|████▋     | 117/249 [11:48<01:33,  1.42it/s] 47%|████▋     | 118/249 [11:48<01:09,  1.89it/s] 48%|████▊     | 119/249 [11:49<01:10,  1.83it/s] 48%|████▊     | 120/249 [11:49<01:03,  2.02it/s] 49%|████▊     | 121/249 [11:49<00:57,  2.23it/s] 49%|████▉     | 122/249 [11:49<00:44,  2.87it/s] 49%|████▉     | 123/249 [11:50<00:46,  2.72it/s] 50%|████▉     | 124/249 [11:50<00:41,  3.04it/s] 50%|█████     | 125/249 [11:53<02:06,  1.02s/it] 51%|█████     | 126/249 [11:53<01:44,  1.18it/s] 51%|█████     | 127/249 [11:54<02:00,  1.02it/s] 51%|█████▏    | 128/249 [11:55<01:34,  1.29it/s] 52%|█████▏    | 129/249 [11:55<01:14,  1.62it/s] 52%|█████▏    | 130/249 [11:55<01:07,  1.76it/s] 53%|█████▎    | 131/249 [11:56<01:13,  1.61it/s] 53%|█████▎    | 132/249 [11:56<01:01,  1.91it/s] 53%|█████▎    | 133/249 [11:57<01:10,  1.63it/s] 54%|█████▍    | 134/249 [11:57<00:58,  1.97it/s] 54%|█████▍    | 135/249 [11:58<00:43,  2.60it/s] 55%|█████▍    | 136/249 [11:58<00:33,  3.34it/s] 55%|█████▌    | 137/249 [11:59<01:10,  1.59it/s] 55%|█████▌    | 138/249 [11:59<00:54,  2.03it/s] 56%|█████▌    | 139/249 [12:00<01:01,  1.79it/s] 56%|█████▌    | 140/249 [12:01<00:59,  1.82it/s] 57%|█████▋    | 141/249 [12:01<00:51,  2.10it/s] 57%|█████▋    | 142/249 [12:01<00:52,  2.03it/s] 58%|█████▊    | 144/249 [12:02<00:37,  2.78it/s] 58%|█████▊    | 145/249 [12:02<00:33,  3.11it/s] 59%|█████▊    | 146/249 [12:02<00:29,  3.54it/s] 59%|█████▉    | 147/249 [12:02<00:25,  4.05it/s] 59%|█████▉    | 148/249 [12:02<00:23,  4.36it/s] 60%|█████▉    | 149/249 [12:03<00:21,  4.76it/s] 60%|██████    | 150/249 [12:03<00:22,  4.33it/s] 61%|██████    | 152/249 [12:03<00:18,  5.36it/s] 62%|██████▏   | 154/249 [12:03<00:14,  6.47it/s] 62%|██████▏   | 155/249 [12:04<00:20,  4.56it/s] 63%|██████▎   | 156/249 [12:04<00:21,  4.28it/s] 63%|██████▎   | 158/249 [12:04<00:15,  5.70it/s] 64%|██████▍   | 159/249 [12:04<00:15,  5.89it/s] 64%|██████▍   | 160/249 [12:05<00:18,  4.92it/s] 65%|██████▍   | 161/249 [12:05<00:16,  5.42it/s] 65%|██████▌   | 162/249 [12:05<00:21,  4.07it/s] 65%|██████▌   | 163/249 [12:05<00:19,  4.37it/s] 66%|██████▌   | 164/249 [12:06<00:20,  4.12it/s] 67%|██████▋   | 166/249 [12:06<00:15,  5.46it/s] 67%|██████▋   | 167/249 [12:06<00:13,  5.99it/s] 67%|██████▋   | 168/249 [12:06<00:16,  5.00it/s] 68%|██████▊   | 169/249 [12:07<00:14,  5.47it/s] 68%|██████▊   | 170/249 [12:07<00:29,  2.69it/s] 69%|██████▊   | 171/249 [12:08<00:24,  3.19it/s] 69%|██████▉   | 172/249 [12:08<00:35,  2.15it/s] 69%|██████▉   | 173/249 [12:09<00:29,  2.60it/s] 70%|██████▉   | 174/249 [12:09<00:23,  3.13it/s] 71%|███████   | 176/249 [12:09<00:15,  4.72it/s] 71%|███████   | 177/249 [12:09<00:16,  4.43it/s] 71%|███████▏  | 178/249 [12:09<00:13,  5.09it/s] 72%|███████▏  | 179/249 [12:10<00:14,  4.87it/s] 72%|███████▏  | 180/249 [12:10<00:16,  4.28it/s] 73%|███████▎  | 181/249 [12:10<00:16,  4.18it/s] 73%|███████▎  | 182/249 [12:10<00:14,  4.51it/s] 73%|███████▎  | 183/249 [12:10<00:14,  4.66it/s] 74%|███████▍  | 184/249 [12:11<00:12,  5.01it/s] 74%|███████▍  | 185/249 [12:11<00:22,  2.87it/s] 75%|███████▌  | 187/249 [12:12<00:17,  3.59it/s] 76%|███████▌  | 188/249 [12:12<00:14,  4.17it/s] 76%|███████▌  | 189/249 [12:12<00:13,  4.55it/s] 77%|███████▋  | 191/249 [12:12<00:10,  5.72it/s] 77%|███████▋  | 192/249 [12:12<00:09,  6.18it/s] 78%|███████▊  | 194/249 [12:13<00:07,  6.98it/s] 79%|███████▊  | 196/249 [12:13<00:06,  8.47it/s] 79%|███████▉  | 197/249 [12:13<00:08,  6.21it/s] 80%|███████▉  | 198/249 [12:14<00:12,  4.08it/s] 80%|███████▉  | 199/249 [12:14<00:10,  4.77it/s] 80%|████████  | 200/249 [12:14<00:12,  4.04it/s] 81%|████████  | 201/249 [12:14<00:10,  4.58it/s] 81%|████████  | 202/249 [12:14<00:10,  4.41it/s] 82%|████████▏ | 203/249 [12:15<00:10,  4.58it/s] 82%|████████▏ | 204/249 [12:15<00:09,  4.81it/s] 82%|████████▏ | 205/249 [12:15<00:11,  3.99it/s] 83%|████████▎ | 206/249 [12:15<00:10,  4.09it/s] 83%|████████▎ | 207/249 [12:16<00:09,  4.64it/s] 84%|████████▍ | 209/249 [12:16<00:06,  6.34it/s] 84%|████████▍ | 210/249 [12:16<00:09,  4.27it/s] 85%|████████▍ | 211/249 [12:16<00:09,  3.99it/s] 86%|████████▌ | 213/249 [12:17<00:06,  5.26it/s] 86%|████████▋ | 215/249 [12:17<00:05,  6.06it/s] 87%|████████▋ | 216/249 [12:17<00:05,  6.41it/s] 88%|████████▊ | 218/249 [12:17<00:04,  7.57it/s] 88%|████████▊ | 219/249 [12:17<00:03,  7.96it/s] 88%|████████▊ | 220/249 [12:17<00:03,  8.09it/s] 89%|████████▉ | 221/249 [12:18<00:03,  7.94it/s] 89%|████████▉ | 222/249 [12:18<00:03,  7.83it/s] 90%|████████▉ | 224/249 [12:18<00:02,  9.16it/s] 91%|█████████ | 226/249 [12:18<00:03,  7.02it/s] 92%|█████████▏| 228/249 [12:18<00:02,  8.22it/s] 92%|█████████▏| 229/249 [12:19<00:02,  7.89it/s] 93%|█████████▎| 231/249 [12:19<00:02,  8.76it/s] 93%|█████████▎| 232/249 [12:19<00:02,  7.79it/s] 94%|█████████▍| 234/249 [12:19<00:01,  8.73it/s] 95%|█████████▍| 236/249 [12:19<00:01,  9.37it/s] 96%|█████████▌| 238/249 [12:20<00:01,  8.70it/s] 96%|█████████▋| 240/249 [12:20<00:00, 10.03it/s] 97%|█████████▋| 242/249 [12:20<00:00, 10.36it/s] 98%|█████████▊| 244/249 [12:20<00:00, 10.85it/s] 99%|█████████▉| 246/249 [12:20<00:00, 11.18it/s]100%|█████████▉| 248/249 [12:20<00:00, 10.82it/s]100%|██████████| 249/249 [12:21<00:00,  2.98s/it]
Saving new dataset pyg object at /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/tiankampmann2019_ipsc/data_pyg/cell_graphs.pkl
Done!
wandb: Currently logged in as: zhoumin1130. Use `wandb login --relogin` to force relogin
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.5
wandb: Run data is saved locally in /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/script/wandb/run-20240726_130125-l85b7hyj
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run TianKampmann2019_iPSC_split1
wandb: ⭐️ View project at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: 🚀 View run at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/l85b7hyj
Local copy of pyg dataset is detected. Loading...
Done!
Creating new splits....
Saving new splits at /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/tiankampmann2019_ipsc/splits/tiankampmann2019_ipsc_simulation_1_0.75.pkl
Simulation split test composition:
combo_seen0:21
combo_seen1:100
combo_seen2:26
unseen_single:7
Done!
Creating dataloaders....
Done!
wandb: - 0.001 MB of 0.001 MB uploadedwandb: \ 0.001 MB of 0.037 MB uploadedwandb: | 0.002 MB of 0.037 MB uploadedwandb: / 0.037 MB of 0.037 MB uploadedwandb: - 0.037 MB of 0.037 MB uploadedwandb: \ 0.037 MB of 0.037 MB uploadedwandb: | 0.037 MB of 0.037 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: elapsed_time ▂▁▁▂▅▄██
wandb:        epoch ▁▂▃▄▅▆▇█
wandb:     val_loss ▁▄▁▄▄█▃▃
wandb:      val_mre ▆▄▃▁▃█▁▅
wandb: 
wandb: Run summary:
wandb:     best_model_info Best model with scor...
wandb:     early_stop_info Early stop at epoch ...
wandb:        elapsed_time 278.41007
wandb:               epoch 8
wandb: loading_params_info Loading params trans...
wandb:          match_info match 4538/5020 gene...
wandb:   resume_model_info Resume model from /h...
wandb:            run_time 2024-07-26 13:01:42
wandb:            val_loss 0.00695
wandb:             val_mre 13286.98992
wandb: 
wandb: 🚀 View run TianKampmann2019_iPSC_split1 at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/l85b7hyj
wandb: ⭐️ View project at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240726_130125-l85b7hyj/logs
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.5
wandb: Run data is saved locally in /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/script/wandb/run-20240726_140521-07eveh6w
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run TianKampmann2019_iPSC_split2
wandb: ⭐️ View project at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: 🚀 View run at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/07eveh6w
Local copy of pyg dataset is detected. Loading...
Done!
Creating new splits....
Saving new splits at /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/tiankampmann2019_ipsc/splits/tiankampmann2019_ipsc_simulation_2_0.75.pkl
Simulation split test composition:
combo_seen0:17
combo_seen1:84
combo_seen2:31
unseen_single:7
Done!
Creating dataloaders....
Done!
wandb: - 0.001 MB of 0.001 MB uploadedwandb: \ 0.001 MB of 0.037 MB uploadedwandb: | 0.001 MB of 0.037 MB uploadedwandb: / 0.037 MB of 0.037 MB uploadedwandb: - 0.037 MB of 0.037 MB uploadedwandb: \ 0.037 MB of 0.037 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: elapsed_time ▂▄▅▅▄▆█▁
wandb:        epoch ▁▂▃▄▅▆▇█
wandb:     val_loss ▃█▁▂▅▂▁ 
wandb:      val_mre ▄▂▆▅▁▃█ 
wandb: 
wandb: Run summary:
wandb:     best_model_info Best model with scor...
wandb:     early_stop_info Early stop at epoch ...
wandb:        elapsed_time 324.91205
wandb:               epoch 8
wandb: loading_params_info Loading params trans...
wandb:          match_info match 4538/5020 gene...
wandb:   resume_model_info Resume model from /h...
wandb:            run_time 2024-07-26 14:05:36
wandb:            val_loss nan
wandb:             val_mre nan
wandb: 
wandb: 🚀 View run TianKampmann2019_iPSC_split2 at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/07eveh6w
wandb: ⭐️ View project at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240726_140521-07eveh6w/logs
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.5
wandb: Run data is saved locally in /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/script/wandb/run-20240726_150314-mps2dt7t
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run TianKampmann2019_iPSC_split3
wandb: ⭐️ View project at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: 🚀 View run at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/mps2dt7t
Local copy of pyg dataset is detected. Loading...
Done!
Creating new splits....
Saving new splits at /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/tiankampmann2019_ipsc/splits/tiankampmann2019_ipsc_simulation_3_0.75.pkl
Simulation split test composition:
combo_seen0:17
combo_seen1:90
combo_seen2:29
unseen_single:7
Done!
Creating dataloaders....
Done!
wandb: - 0.001 MB of 0.001 MB uploadedwandb: \ 0.001 MB of 0.044 MB uploadedwandb: | 0.001 MB of 0.044 MB uploadedwandb: / 0.006 MB of 0.044 MB uploadedwandb: - 0.044 MB of 0.044 MB uploadedwandb: \ 0.044 MB of 0.044 MB uploadedwandb: | 0.044 MB of 0.044 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: elapsed_time ▁▂▃▄▅▅▅▆▅▇▇█
wandb:        epoch ▁▂▂▃▄▄▅▅▆▇▇█
wandb:     val_loss ▆▅▃█▁▃▁▂▄▃▄▄
wandb:      val_mre ▄▁█▆▆▆▆▆▄▄▃▅
wandb: 
wandb: Run summary:
wandb:     best_model_info Best model with scor...
wandb:     early_stop_info Early stop at epoch ...
wandb:        elapsed_time 360.9813
wandb:               epoch 12
wandb: loading_params_info Loading params trans...
wandb:          match_info match 4538/5020 gene...
wandb:   resume_model_info Resume model from /h...
wandb:            run_time 2024-07-26 15:03:29
wandb:            val_loss 0.00701
wandb:             val_mre 8022.18587
wandb: 
wandb: 🚀 View run TianKampmann2019_iPSC_split3 at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/mps2dt7t
wandb: ⭐️ View project at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240726_150314-mps2dt7t/logs
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: | Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.5
wandb: Run data is saved locally in /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/script/wandb/run-20240726_163115-k3yv1mnz
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run TianKampmann2019_iPSC_split4
wandb: ⭐️ View project at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: 🚀 View run at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/k3yv1mnz
Local copy of pyg dataset is detected. Loading...
Done!
Creating new splits....
Saving new splits at /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/tiankampmann2019_ipsc/splits/tiankampmann2019_ipsc_simulation_4_0.75.pkl
Simulation split test composition:
combo_seen0:19
combo_seen1:92
combo_seen2:28
unseen_single:7
Done!
Creating dataloaders....
Done!
wandb: - 0.001 MB of 0.001 MB uploadedwandb: \ 0.001 MB of 0.034 MB uploadedwandb: | 0.001 MB of 0.038 MB uploadedwandb: / 0.038 MB of 0.038 MB uploadedwandb: - 0.038 MB of 0.038 MB uploadedwandb: \ 0.038 MB of 0.038 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: elapsed_time ▇█▅▃▁▁▁
wandb:        epoch ▁▂▃▅▆▇█
wandb:     val_loss █▁     
wandb:      val_mre ▁█     
wandb: 
wandb: Run summary:
wandb:     best_model_info Best model with scor...
wandb:     early_stop_info Early stop at epoch ...
wandb:        elapsed_time 371.78682
wandb:               epoch 7
wandb: loading_params_info Loading params trans...
wandb:          match_info match 4538/5020 gene...
wandb:   resume_model_info Resume model from /h...
wandb:            run_time 2024-07-26 16:31:35
wandb:            val_loss nan
wandb:             val_mre nan
wandb: 
wandb: 🚀 View run TianKampmann2019_iPSC_split4 at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/k3yv1mnz
wandb: ⭐️ View project at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240726_163115-k3yv1mnz/logs
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: | Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.5
wandb: Run data is saved locally in /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/script/wandb/run-20240726_173116-wheejyzb
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run TianKampmann2019_iPSC_split5
wandb: ⭐️ View project at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: 🚀 View run at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/wheejyzb
Local copy of pyg dataset is detected. Loading...
Done!
Creating new splits....
Saving new splits at /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/tiankampmann2019_ipsc/splits/tiankampmann2019_ipsc_simulation_5_0.75.pkl
Simulation split test composition:
combo_seen0:12
combo_seen1:91
combo_seen2:30
unseen_single:7
Done!
Creating dataloaders....
Done!
wandb: - 0.001 MB of 0.001 MB uploadedwandb: \ 0.001 MB of 0.043 MB uploadedwandb: | 0.042 MB of 0.043 MB uploadedwandb: / 0.042 MB of 0.043 MB uploadedwandb: - 0.043 MB of 0.043 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: elapsed_time ▁▄█▇▆▆▆█▆▆█▆▆
wandb:        epoch ▁▂▂▃▃▄▅▅▆▆▇▇█
wandb:     val_loss █▃▁▂▃▃▃▁▅▂▂▃▃
wandb:      val_mre ▁▆▄▅▄▅▇▃▃█▃▃▅
wandb: 
wandb: Run summary:
wandb:     best_model_info Best model with scor...
wandb:     early_stop_info Early stop at epoch ...
wandb:        elapsed_time 325.39169
wandb:               epoch 13
wandb: loading_params_info Loading params trans...
wandb:          match_info match 4538/5020 gene...
wandb:   resume_model_info Resume model from /h...
wandb:            run_time 2024-07-26 17:31:32
wandb:            val_loss 0.00706
wandb:             val_mre 8876.11592
wandb: 
wandb: 🚀 View run TianKampmann2019_iPSC_split5 at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/wheejyzb
wandb: ⭐️ View project at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240726_173116-wheejyzb/logs
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
/home/share/huadjyin/home/zhoumin3/.conda/envs/scgpt/lib/python3.9/site-packages/scgpt/model/multiomic_model.py:19: UserWarning: flash_attn is not installed
  warnings.warn("flash_attn is not installed")
/home/share/huadjyin/home/zhoumin3/.conda/envs/scgpt/lib/python3.9/site-packages/wandb/analytics/sentry.py:90: SentryHubDeprecationWarning: `sentry_sdk.Hub` is deprecated and will be removed in a future major release. Please consult our 1.x to 2.x migration guide for details on how to migrate `Hub` usage to the new API: https://docs.sentry.io/platforms/python/migration/1.x-to-2.x
  self.hub = sentry_sdk.Hub(client)
Creating pyg object for each cell in the data...
  0%|          | 0/96 [00:00<?, ?it/s]  1%|          | 1/96 [00:09<15:18,  9.66s/it]  2%|▏         | 2/96 [00:16<12:44,  8.13s/it]  3%|▎         | 3/96 [00:34<19:09, 12.36s/it]  4%|▍         | 4/96 [00:43<16:59, 11.08s/it]  5%|▌         | 5/96 [00:49<14:01,  9.25s/it]  6%|▋         | 6/96 [00:53<11:19,  7.55s/it]  7%|▋         | 7/96 [00:57<09:33,  6.44s/it]  8%|▊         | 8/96 [01:05<10:05,  6.89s/it]  9%|▉         | 9/96 [01:12<10:10,  7.02s/it] 10%|█         | 10/96 [01:21<11:00,  7.68s/it] 11%|█▏        | 11/96 [01:28<10:14,  7.23s/it] 12%|█▎        | 12/96 [01:37<10:56,  7.81s/it] 14%|█▎        | 13/96 [01:51<13:18,  9.62s/it] 15%|█▍        | 14/96 [01:56<11:15,  8.24s/it] 16%|█▌        | 15/96 [02:02<10:11,  7.55s/it] 17%|█▋        | 16/96 [02:07<09:14,  6.94s/it] 18%|█▊        | 17/96 [02:19<11:09,  8.47s/it] 19%|█▉        | 18/96 [02:26<10:24,  8.01s/it] 20%|█▉        | 19/96 [02:35<10:34,  8.24s/it] 21%|██        | 20/96 [02:42<10:04,  7.95s/it] 22%|██▏       | 21/96 [02:51<10:16,  8.22s/it] 23%|██▎       | 22/96 [02:56<08:55,  7.24s/it] 24%|██▍       | 23/96 [03:01<08:04,  6.64s/it] 25%|██▌       | 24/96 [03:08<07:54,  6.59s/it] 26%|██▌       | 25/96 [03:11<06:40,  5.65s/it] 27%|██▋       | 26/96 [03:11<04:39,  3.99s/it] 28%|██▊       | 27/96 [03:15<04:35,  4.00s/it] 29%|██▉       | 28/96 [03:21<05:05,  4.49s/it] 30%|███       | 29/96 [03:26<05:18,  4.75s/it] 31%|███▏      | 30/96 [03:29<04:28,  4.06s/it] 32%|███▏      | 31/96 [03:33<04:34,  4.22s/it] 33%|███▎      | 32/96 [03:37<04:15,  3.99s/it] 34%|███▍      | 33/96 [03:44<05:17,  5.05s/it] 35%|███▌      | 34/96 [03:55<07:05,  6.86s/it] 36%|███▋      | 35/96 [03:59<05:52,  5.78s/it] 38%|███▊      | 36/96 [04:04<05:45,  5.76s/it] 39%|███▊      | 37/96 [04:09<05:26,  5.53s/it] 40%|███▉      | 38/96 [04:19<06:39,  6.89s/it] 41%|████      | 39/96 [04:28<06:57,  7.33s/it] 42%|████▏     | 40/96 [04:33<06:21,  6.82s/it] 43%|████▎     | 41/96 [04:40<06:18,  6.88s/it] 44%|████▍     | 42/96 [04:46<05:53,  6.55s/it] 45%|████▍     | 43/96 [04:55<06:19,  7.17s/it] 46%|████▌     | 44/96 [05:01<05:59,  6.92s/it] 47%|████▋     | 45/96 [05:07<05:31,  6.51s/it] 48%|████▊     | 46/96 [05:12<05:11,  6.22s/it] 49%|████▉     | 47/96 [05:18<04:52,  5.97s/it] 50%|█████     | 48/96 [05:25<05:07,  6.42s/it] 51%|█████     | 49/96 [05:34<05:34,  7.12s/it] 52%|█████▏    | 50/96 [05:50<07:27,  9.73s/it] 53%|█████▎    | 51/96 [05:53<05:56,  7.92s/it] 54%|█████▍    | 52/96 [05:59<05:24,  7.38s/it] 55%|█████▌    | 53/96 [06:05<04:53,  6.84s/it] 56%|█████▋    | 54/96 [06:10<04:28,  6.38s/it] 57%|█████▋    | 55/96 [06:19<04:51,  7.12s/it] 58%|█████▊    | 56/96 [06:25<04:30,  6.76s/it] 59%|█████▉    | 57/96 [06:32<04:26,  6.83s/it] 60%|██████    | 58/96 [06:39<04:23,  6.93s/it] 61%|██████▏   | 59/96 [06:48<04:34,  7.42s/it] 62%|██████▎   | 60/96 [06:55<04:30,  7.51s/it] 64%|██████▎   | 61/96 [07:03<04:24,  7.56s/it] 65%|██████▍   | 62/96 [07:08<03:49,  6.76s/it] 66%|██████▌   | 63/96 [07:15<03:45,  6.85s/it] 67%|██████▋   | 64/96 [07:21<03:33,  6.66s/it] 68%|██████▊   | 65/96 [07:27<03:17,  6.38s/it] 69%|██████▉   | 66/96 [07:31<02:53,  5.79s/it] 70%|██████▉   | 67/96 [07:36<02:36,  5.39s/it] 71%|███████   | 68/96 [07:44<02:53,  6.21s/it] 72%|███████▏  | 69/96 [07:48<02:32,  5.66s/it] 73%|███████▎  | 70/96 [08:02<03:32,  8.17s/it] 74%|███████▍  | 71/96 [08:13<03:40,  8.84s/it] 75%|███████▌  | 72/96 [08:20<03:17,  8.23s/it] 76%|███████▌  | 73/96 [08:30<03:23,  8.84s/it] 77%|███████▋  | 74/96 [08:38<03:08,  8.57s/it] 78%|███████▊  | 75/96 [08:46<02:59,  8.53s/it] 79%|███████▉  | 76/96 [08:52<02:31,  7.59s/it] 80%|████████  | 77/96 [08:58<02:18,  7.31s/it] 81%|████████▏ | 78/96 [09:09<02:26,  8.16s/it] 82%|████████▏ | 79/96 [09:12<01:54,  6.75s/it] 83%|████████▎ | 80/96 [09:17<01:37,  6.11s/it] 84%|████████▍ | 81/96 [09:23<01:31,  6.10s/it] 85%|████████▌ | 82/96 [09:27<01:17,  5.55s/it] 86%|████████▋ | 83/96 [09:32<01:08,  5.31s/it] 88%|████████▊ | 84/96 [09:35<00:58,  4.86s/it] 89%|████████▊ | 85/96 [09:45<01:09,  6.33s/it] 90%|████████▉ | 86/96 [09:51<01:00,  6.05s/it] 91%|█████████ | 87/96 [09:54<00:47,  5.32s/it] 92%|█████████▏| 88/96 [09:56<00:34,  4.33s/it] 93%|█████████▎| 89/96 [10:01<00:32,  4.57s/it] 94%|█████████▍| 90/96 [10:04<00:24,  4.10s/it] 95%|█████████▍| 91/96 [10:08<00:19,  3.86s/it] 96%|█████████▌| 92/96 [10:13<00:16,  4.15s/it] 97%|█████████▋| 93/96 [10:14<00:09,  3.29s/it] 98%|█████████▊| 94/96 [10:15<00:05,  2.68s/it] 99%|█████████▉| 95/96 [10:16<00:02,  2.26s/it]100%|██████████| 96/96 [10:22<00:00,  3.18s/it]100%|██████████| 96/96 [10:22<00:00,  6.48s/it]
Saving new dataset pyg object at /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/tiankampmann2021_crispra/data_pyg/cell_graphs.pkl
Done!
wandb: Currently logged in as: zhoumin1130. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.17.5
wandb: Run data is saved locally in /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/script/wandb/run-20240726_191513-thohjrco
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run TianKampmann2021_CRISPRa_split1
wandb: ⭐️ View project at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: 🚀 View run at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/thohjrco
Local copy of pyg dataset is detected. Loading...
Done!
Creating new splits....
Saving new splits at /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/tiankampmann2021_crispra/splits/tiankampmann2021_crispra_simulation_1_0.75.pkl
Simulation split test composition:
combo_seen0:0
combo_seen1:0
combo_seen2:0
unseen_single:24
Done!
Creating dataloaders....
Done!
wandb: - 0.001 MB of 0.001 MB uploadedwandb: \ 0.001 MB of 0.030 MB uploadedwandb: | 0.001 MB of 0.035 MB uploadedwandb: / 0.034 MB of 0.035 MB uploadedwandb: - 0.034 MB of 0.035 MB uploadedwandb: \ 0.035 MB of 0.035 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: elapsed_time █▅▂▂▃▂▁▁▁
wandb:        epoch ▁▂▃▄▅▅▆▇█
wandb:     val_loss ▆█▄▁▂▂▁▃▂
wandb:      val_mre ▄▁▂▃▅█▃▄▅
wandb: 
wandb: Run summary:
wandb:     best_model_info Best model with scor...
wandb:     early_stop_info Early stop at epoch ...
wandb:        elapsed_time 139.46853
wandb:               epoch 9
wandb: loading_params_info Loading params trans...
wandb:          match_info match 3930/5034 gene...
wandb:   resume_model_info Resume model from /h...
wandb:            run_time 2024-07-26 19:15:29
wandb:            val_loss 0.06659
wandb:             val_mre 51235.0232
wandb: 
wandb: 🚀 View run TianKampmann2021_CRISPRa_split1 at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/thohjrco
wandb: ⭐️ View project at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240726_191513-thohjrco/logs
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.5
wandb: Run data is saved locally in /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/script/wandb/run-20240726_194114-bdgkdgh8
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run TianKampmann2021_CRISPRa_split2
wandb: ⭐️ View project at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: 🚀 View run at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/bdgkdgh8
Local copy of pyg dataset is detected. Loading...
Done!
Creating new splits....
Saving new splits at /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/tiankampmann2021_crispra/splits/tiankampmann2021_crispra_simulation_2_0.75.pkl
Simulation split test composition:
combo_seen0:0
combo_seen1:0
combo_seen2:0
unseen_single:24
Done!
Creating dataloaders....
Done!
wandb: - 0.001 MB of 0.001 MB uploadedwandb: \ 0.001 MB of 0.037 MB uploadedwandb: | 0.025 MB of 0.037 MB uploadedwandb: / 0.026 MB of 0.037 MB uploadedwandb: - 0.037 MB of 0.037 MB uploadedwandb: \ 0.037 MB of 0.037 MB uploadedwandb: | 0.037 MB of 0.037 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: elapsed_time █▂▁▁▁▁▁▂▁▁▂▂
wandb:        epoch ▁▂▂▃▄▄▅▅▆▇▇█
wandb:     val_loss █▃▄▃▂▂▁▄▃▂▄▂
wandb:      val_mre █▄▃▂▂▄▃▄▁▂▃▁
wandb: 
wandb: Run summary:
wandb:     best_model_info Best model with scor...
wandb:     early_stop_info Early stop at epoch ...
wandb:        elapsed_time 131.00974
wandb:               epoch 12
wandb: loading_params_info Loading params trans...
wandb:          match_info match 3930/5034 gene...
wandb:   resume_model_info Resume model from /h...
wandb:            run_time 2024-07-26 19:41:32
wandb:            val_loss 0.0654
wandb:             val_mre 43009.78255
wandb: 
wandb: 🚀 View run TianKampmann2021_CRISPRa_split2 at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/bdgkdgh8
wandb: ⭐️ View project at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240726_194114-bdgkdgh8/logs
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: | Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.5
wandb: Run data is saved locally in /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/script/wandb/run-20240726_201321-lypwvm0w
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run TianKampmann2021_CRISPRa_split3
wandb: ⭐️ View project at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: 🚀 View run at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/lypwvm0w
Local copy of pyg dataset is detected. Loading...
Done!
Creating new splits....
Saving new splits at /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/tiankampmann2021_crispra/splits/tiankampmann2021_crispra_simulation_3_0.75.pkl
Simulation split test composition:
combo_seen0:0
combo_seen1:0
combo_seen2:0
unseen_single:24
Done!
Creating dataloaders....
Done!
wandb: - 0.001 MB of 0.001 MB uploadedwandb: \ 0.001 MB of 0.037 MB uploadedwandb: | 0.002 MB of 0.037 MB uploadedwandb: / 0.036 MB of 0.037 MB uploadedwandb: - 0.036 MB of 0.037 MB uploadedwandb: \ 0.036 MB of 0.037 MB uploadedwandb: | 0.037 MB of 0.037 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: elapsed_time ▆▆▆▆▃▁▃▄▄▄▅▅█
wandb:        epoch ▁▂▂▃▃▄▅▅▆▆▇▇█
wandb:     val_loss █▄▂▃▂▂▄▁▃▁▁▁▁
wandb:      val_mre █▂▂▄▃▄▁▃▁▂▂▂▂
wandb: 
wandb: Run summary:
wandb:     best_model_info Best model with scor...
wandb:     early_stop_info Early stop at epoch ...
wandb:        elapsed_time 134.31211
wandb:               epoch 13
wandb: loading_params_info Loading params trans...
wandb:          match_info match 3930/5034 gene...
wandb:   resume_model_info Resume model from /h...
wandb:            run_time 2024-07-26 20:13:37
wandb:            val_loss 0.06705
wandb:             val_mre 47603.40564
wandb: 
wandb: 🚀 View run TianKampmann2021_CRISPRa_split3 at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/lypwvm0w
wandb: ⭐️ View project at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240726_201321-lypwvm0w/logs
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
wandb: Tracking run with wandb version 0.17.5
wandb: Run data is saved locally in /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/script/wandb/run-20240726_204736-pe8pprno
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run TianKampmann2021_CRISPRa_split4
wandb: ⭐️ View project at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: 🚀 View run at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/pe8pprno
Local copy of pyg dataset is detected. Loading...
Done!
Creating new splits....
Saving new splits at /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/tiankampmann2021_crispra/splits/tiankampmann2021_crispra_simulation_4_0.75.pkl
Simulation split test composition:
combo_seen0:0
combo_seen1:0
combo_seen2:0
unseen_single:24
Done!
Creating dataloaders....
Done!
wandb: - 0.001 MB of 0.001 MB uploadedwandb: \ 0.001 MB of 0.037 MB uploadedwandb: | 0.001 MB of 0.037 MB uploadedwandb: / 0.001 MB of 0.037 MB uploadedwandb: - 0.036 MB of 0.037 MB uploadedwandb: \ 0.037 MB of 0.037 MB uploadedwandb: | 0.037 MB of 0.037 MB uploadedwandb: / 0.037 MB of 0.037 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: elapsed_time ▄▂▁▃▂▄▆▄▆▆▆▆█
wandb:        epoch ▁▂▂▃▃▄▅▅▆▆▇▇█
wandb:     val_loss █▅▃▂▃▃▃▁▂▂▂▁▂
wandb:      val_mre ▇▄▃█▃▃▁▂▃▃▁██
wandb: 
wandb: Run summary:
wandb:     best_model_info Best model with scor...
wandb:     early_stop_info Early stop at epoch ...
wandb:        elapsed_time 133.39585
wandb:               epoch 13
wandb: loading_params_info Loading params trans...
wandb:          match_info match 3930/5034 gene...
wandb:   resume_model_info Resume model from /h...
wandb:            run_time 2024-07-26 20:47:50
wandb:            val_loss 0.06427
wandb:             val_mre 55593.72891
wandb: 
wandb: 🚀 View run TianKampmann2021_CRISPRa_split4 at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/pe8pprno
wandb: ⭐️ View project at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240726_204736-pe8pprno/logs
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.5
wandb: Run data is saved locally in /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/script/wandb/run-20240726_212144-2512insq
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run TianKampmann2021_CRISPRa_split5
wandb: ⭐️ View project at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: 🚀 View run at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/2512insq
Local copy of pyg dataset is detected. Loading...
Done!
Creating new splits....
Saving new splits at /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/tiankampmann2021_crispra/splits/tiankampmann2021_crispra_simulation_5_0.75.pkl
Simulation split test composition:
combo_seen0:0
combo_seen1:0
combo_seen2:0
unseen_single:24
Done!
Creating dataloaders....
Done!
wandb: - 0.001 MB of 0.001 MB uploadedwandb: \ 0.001 MB of 0.038 MB uploadedwandb: | 0.002 MB of 0.038 MB uploadedwandb: / 0.013 MB of 0.038 MB uploadedwandb: - 0.038 MB of 0.038 MB uploadedwandb: \ 0.038 MB of 0.038 MB uploadedwandb: | 0.038 MB of 0.038 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: elapsed_time ▄▂▁▂▃▂▅▅▅▃▅█▇▇█
wandb:        epoch ▁▁▂▃▃▃▄▅▅▅▆▇▇▇█
wandb:     val_loss █▃▂▂▂▂▂▁▁▂▁▂▁▁▂
wandb:      val_mre ▁█▇▃▄▄▂▃▄▅▅▅▅▄▃
wandb: 
wandb: Run summary:
wandb:     best_model_info Best model with scor...
wandb:        elapsed_time 130.39557
wandb:               epoch 15
wandb: loading_params_info Loading params trans...
wandb:          match_info match 3930/5034 gene...
wandb:   resume_model_info Resume model from /h...
wandb:            run_time 2024-07-26 21:21:58
wandb:            val_loss 0.06627
wandb:             val_mre 49357.4415
wandb: 
wandb: 🚀 View run TianKampmann2021_CRISPRa_split5 at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/2512insq
wandb: ⭐️ View project at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240726_212144-2512insq/logs
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
/home/share/huadjyin/home/zhoumin3/.conda/envs/scgpt/lib/python3.9/site-packages/scgpt/model/multiomic_model.py:19: UserWarning: flash_attn is not installed
  warnings.warn("flash_attn is not installed")
/home/share/huadjyin/home/zhoumin3/.conda/envs/scgpt/lib/python3.9/site-packages/wandb/analytics/sentry.py:90: SentryHubDeprecationWarning: `sentry_sdk.Hub` is deprecated and will be removed in a future major release. Please consult our 1.x to 2.x migration guide for details on how to migrate `Hub` usage to the new API: https://docs.sentry.io/platforms/python/migration/1.x-to-2.x
  self.hub = sentry_sdk.Hub(client)
Creating pyg object for each cell in the data...
  0%|          | 0/182 [00:00<?, ?it/s]  1%|          | 1/182 [00:06<18:30,  6.14s/it]  1%|          | 2/182 [00:32<54:27, 18.15s/it]  2%|▏         | 3/182 [00:45<46:51, 15.70s/it]  2%|▏         | 4/182 [01:02<47:38, 16.06s/it]  3%|▎         | 5/182 [01:11<40:16, 13.66s/it]  3%|▎         | 6/182 [01:27<42:01, 14.33s/it]  4%|▍         | 7/182 [01:42<42:23, 14.53s/it]  4%|▍         | 8/182 [01:51<37:48, 13.04s/it]  5%|▍         | 9/182 [02:00<34:00, 11.79s/it]  5%|▌         | 10/182 [02:14<35:27, 12.37s/it]  6%|▌         | 11/182 [02:24<33:17, 11.68s/it]  7%|▋         | 12/182 [02:35<32:41, 11.54s/it]  7%|▋         | 13/182 [02:50<34:59, 12.42s/it]  8%|▊         | 14/182 [02:59<31:40, 11.31s/it]  8%|▊         | 15/182 [03:11<32:18, 11.61s/it]  9%|▉         | 16/182 [03:25<33:48, 12.22s/it]  9%|▉         | 17/182 [03:34<31:37, 11.50s/it] 10%|▉         | 18/182 [03:56<39:38, 14.50s/it] 10%|█         | 19/182 [04:07<36:35, 13.47s/it] 11%|█         | 20/182 [04:20<35:46, 13.25s/it] 12%|█▏        | 21/182 [04:34<36:39, 13.66s/it] 12%|█▏        | 22/182 [04:52<39:44, 14.90s/it] 13%|█▎        | 23/182 [05:07<39:09, 14.77s/it] 13%|█▎        | 24/182 [05:16<35:00, 13.30s/it] 14%|█▎        | 25/182 [05:27<32:28, 12.41s/it] 14%|█▍        | 26/182 [05:36<29:52, 11.49s/it] 15%|█▍        | 27/182 [05:48<29:37, 11.47s/it] 15%|█▌        | 28/182 [06:05<33:48, 13.18s/it] 16%|█▌        | 29/182 [06:17<32:42, 12.82s/it] 16%|█▋        | 30/182 [06:26<29:34, 11.67s/it] 17%|█▋        | 31/182 [06:48<37:03, 14.72s/it] 18%|█▊        | 32/182 [06:57<32:29, 13.00s/it] 18%|█▊        | 33/182 [07:12<34:18, 13.81s/it] 19%|█▊        | 34/182 [07:23<31:43, 12.86s/it] 19%|█▉        | 35/182 [07:32<28:31, 11.65s/it] 20%|█▉        | 36/182 [07:42<27:35, 11.34s/it] 20%|██        | 37/182 [07:50<25:03, 10.37s/it] 21%|██        | 38/182 [08:02<26:03, 10.85s/it] 21%|██▏       | 39/182 [08:12<25:14, 10.59s/it] 22%|██▏       | 40/182 [08:30<30:23, 12.84s/it] 23%|██▎       | 41/182 [08:40<27:56, 11.89s/it] 23%|██▎       | 42/182 [08:54<29:16, 12.55s/it] 24%|██▎       | 43/182 [09:05<27:37, 11.93s/it] 24%|██▍       | 44/182 [09:12<24:11, 10.52s/it] 25%|██▍       | 45/182 [09:21<23:07, 10.13s/it] 25%|██▌       | 46/182 [09:32<23:45, 10.48s/it] 26%|██▌       | 47/182 [09:45<25:03, 11.14s/it] 26%|██▋       | 48/182 [09:55<23:57, 10.73s/it] 27%|██▋       | 49/182 [10:05<23:05, 10.42s/it] 27%|██▋       | 50/182 [10:21<26:49, 12.19s/it] 28%|██▊       | 51/182 [10:31<25:15, 11.57s/it] 29%|██▊       | 52/182 [10:40<23:36, 10.90s/it] 29%|██▉       | 53/182 [10:47<20:29,  9.53s/it] 30%|██▉       | 54/182 [10:58<21:30, 10.08s/it] 30%|███       | 55/182 [11:11<23:09, 10.94s/it] 31%|███       | 56/182 [11:23<23:56, 11.40s/it] 31%|███▏      | 57/182 [11:32<21:43, 10.43s/it] 32%|███▏      | 58/182 [11:35<17:01,  8.23s/it] 32%|███▏      | 59/182 [11:48<20:04,  9.79s/it] 33%|███▎      | 60/182 [11:59<20:48, 10.24s/it] 34%|███▎      | 61/182 [12:20<26:54, 13.34s/it] 34%|███▍      | 62/182 [12:32<26:00, 13.00s/it] 35%|███▍      | 63/182 [12:44<24:55, 12.57s/it] 35%|███▌      | 64/182 [12:59<26:02, 13.24s/it] 36%|███▌      | 65/182 [13:08<23:35, 12.09s/it] 36%|███▋      | 66/182 [13:17<21:27, 11.10s/it] 37%|███▋      | 67/182 [13:27<20:47, 10.85s/it] 37%|███▋      | 68/182 [13:42<23:10, 12.20s/it] 38%|███▊      | 69/182 [13:56<24:00, 12.75s/it] 38%|███▊      | 70/182 [14:06<21:53, 11.73s/it] 39%|███▉      | 71/182 [14:17<21:29, 11.62s/it] 40%|███▉      | 72/182 [14:36<25:03, 13.67s/it] 40%|████      | 73/182 [14:43<21:26, 11.80s/it] 41%|████      | 74/182 [14:57<22:31, 12.52s/it] 41%|████      | 75/182 [15:05<19:46, 11.08s/it] 42%|████▏     | 76/182 [15:24<24:01, 13.60s/it] 42%|████▏     | 77/182 [15:36<22:36, 12.92s/it] 43%|████▎     | 78/182 [15:48<22:06, 12.76s/it] 43%|████▎     | 79/182 [15:56<19:30, 11.36s/it] 44%|████▍     | 80/182 [16:10<20:27, 12.03s/it] 45%|████▍     | 81/182 [16:28<23:07, 13.74s/it] 45%|████▌     | 82/182 [16:38<20:58, 12.59s/it] 46%|████▌     | 83/182 [16:51<21:14, 12.88s/it] 46%|████▌     | 84/182 [17:00<19:09, 11.73s/it] 47%|████▋     | 85/182 [17:09<17:46, 11.00s/it] 47%|████▋     | 86/182 [17:23<19:01, 11.89s/it] 48%|████▊     | 87/182 [17:36<19:21, 12.23s/it] 48%|████▊     | 88/182 [17:45<17:31, 11.19s/it] 49%|████▉     | 89/182 [17:50<14:25,  9.31s/it] 49%|████▉     | 90/182 [18:03<16:06, 10.51s/it] 50%|█████     | 91/182 [18:16<16:52, 11.13s/it] 51%|█████     | 92/182 [18:16<11:45,  7.84s/it] 51%|█████     | 93/182 [18:23<11:01,  7.44s/it] 52%|█████▏    | 94/182 [18:35<12:54,  8.80s/it] 52%|█████▏    | 95/182 [18:48<14:50, 10.24s/it] 53%|█████▎    | 96/182 [19:01<15:50, 11.05s/it] 53%|█████▎    | 97/182 [19:12<15:43, 11.10s/it] 54%|█████▍    | 98/182 [19:26<16:31, 11.80s/it] 54%|█████▍    | 99/182 [19:39<17:06, 12.36s/it] 55%|█████▍    | 100/182 [19:49<15:39, 11.45s/it] 55%|█████▌    | 101/182 [19:58<14:41, 10.88s/it] 56%|█████▌    | 102/182 [20:10<14:50, 11.13s/it] 57%|█████▋    | 103/182 [20:21<14:32, 11.05s/it] 57%|█████▋    | 104/182 [20:34<15:06, 11.62s/it] 58%|█████▊    | 105/182 [20:58<19:42, 15.35s/it] 58%|█████▊    | 106/182 [21:10<18:01, 14.23s/it] 59%|█████▉    | 107/182 [21:19<16:08, 12.91s/it] 59%|█████▉    | 108/182 [21:28<14:30, 11.77s/it] 60%|█████▉    | 109/182 [21:42<14:49, 12.19s/it] 60%|██████    | 110/182 [21:50<13:21, 11.13s/it] 61%|██████    | 111/182 [22:02<13:17, 11.24s/it] 62%|██████▏   | 112/182 [22:11<12:26, 10.67s/it] 62%|██████▏   | 113/182 [22:22<12:15, 10.66s/it] 63%|██████▎   | 114/182 [22:35<13:06, 11.57s/it] 63%|██████▎   | 115/182 [22:46<12:41, 11.37s/it] 64%|██████▎   | 116/182 [22:56<11:48, 10.74s/it] 64%|██████▍   | 117/182 [23:11<13:08, 12.14s/it] 65%|██████▍   | 118/182 [23:21<12:16, 11.51s/it] 65%|██████▌   | 119/182 [23:35<12:47, 12.18s/it] 66%|██████▌   | 120/182 [23:45<11:54, 11.52s/it] 66%|██████▋   | 121/182 [23:56<11:43, 11.53s/it] 67%|██████▋   | 122/182 [24:08<11:30, 11.50s/it] 68%|██████▊   | 123/182 [24:16<10:13, 10.39s/it] 68%|██████▊   | 124/182 [24:33<11:57, 12.37s/it] 69%|██████▊   | 125/182 [24:44<11:31, 12.13s/it] 69%|██████▉   | 126/182 [24:55<10:52, 11.66s/it] 70%|██████▉   | 127/182 [25:05<10:19, 11.26s/it] 70%|███████   | 128/182 [25:14<09:33, 10.62s/it] 71%|███████   | 129/182 [25:25<09:33, 10.81s/it] 71%|███████▏  | 130/182 [25:37<09:36, 11.09s/it] 72%|███████▏  | 131/182 [25:47<09:02, 10.64s/it] 73%|███████▎  | 132/182 [25:59<09:22, 11.25s/it] 73%|███████▎  | 133/182 [26:15<10:21, 12.69s/it] 74%|███████▎  | 134/182 [26:27<09:53, 12.36s/it] 74%|███████▍  | 135/182 [26:37<09:12, 11.76s/it] 75%|███████▍  | 136/182 [26:46<08:17, 10.82s/it] 75%|███████▌  | 137/182 [26:55<07:43, 10.29s/it] 76%|███████▌  | 138/182 [27:07<07:58, 10.87s/it] 76%|███████▋  | 139/182 [27:19<08:00, 11.18s/it] 77%|███████▋  | 140/182 [27:31<07:51, 11.22s/it] 77%|███████▋  | 141/182 [27:44<08:03, 11.80s/it] 78%|███████▊  | 142/182 [27:55<07:50, 11.76s/it] 79%|███████▊  | 143/182 [28:05<07:12, 11.10s/it] 79%|███████▉  | 144/182 [28:16<07:03, 11.15s/it] 80%|███████▉  | 145/182 [28:30<07:27, 12.09s/it] 80%|████████  | 146/182 [28:41<07:01, 11.72s/it] 81%|████████  | 147/182 [28:51<06:29, 11.13s/it] 81%|████████▏ | 148/182 [28:59<05:46, 10.18s/it] 82%|████████▏ | 149/182 [29:13<06:12, 11.27s/it] 82%|████████▏ | 150/182 [29:25<06:05, 11.44s/it] 83%|████████▎ | 151/182 [29:32<05:20, 10.32s/it] 84%|████████▎ | 152/182 [29:43<05:14, 10.47s/it] 84%|████████▍ | 153/182 [30:01<06:04, 12.56s/it] 85%|████████▍ | 154/182 [30:10<05:26, 11.68s/it] 85%|████████▌ | 155/182 [30:25<05:40, 12.62s/it] 86%|████████▌ | 156/182 [30:37<05:20, 12.34s/it] 86%|████████▋ | 157/182 [30:49<05:10, 12.44s/it] 87%|████████▋ | 158/182 [31:00<04:46, 11.92s/it] 87%|████████▋ | 159/182 [31:08<04:05, 10.69s/it] 88%|████████▊ | 160/182 [31:21<04:07, 11.27s/it] 88%|████████▊ | 161/182 [31:41<04:51, 13.88s/it] 89%|████████▉ | 162/182 [31:50<04:13, 12.69s/it] 90%|████████▉ | 163/182 [32:00<03:44, 11.81s/it] 90%|█████████ | 164/182 [32:14<03:44, 12.46s/it] 91%|█████████ | 165/182 [32:24<03:16, 11.56s/it] 91%|█████████ | 166/182 [32:35<03:05, 11.61s/it] 92%|█████████▏| 167/182 [32:47<02:54, 11.64s/it] 92%|█████████▏| 168/182 [32:56<02:29, 10.71s/it] 93%|█████████▎| 169/182 [33:05<02:13, 10.26s/it] 93%|█████████▎| 170/182 [33:21<02:24, 12.02s/it] 94%|█████████▍| 171/182 [33:30<02:01, 11.04s/it] 95%|█████████▍| 172/182 [33:39<01:46, 10.63s/it] 95%|█████████▌| 173/182 [33:54<01:47, 11.90s/it] 96%|█████████▌| 174/182 [34:05<01:32, 11.51s/it] 96%|█████████▌| 175/182 [34:15<01:17, 11.08s/it] 97%|█████████▋| 176/182 [34:22<00:59,  9.87s/it] 97%|█████████▋| 177/182 [34:33<00:50, 10.15s/it] 98%|█████████▊| 178/182 [34:45<00:42, 10.73s/it] 98%|█████████▊| 179/182 [34:53<00:29,  9.81s/it] 99%|█████████▉| 180/182 [35:06<00:21, 10.95s/it] 99%|█████████▉| 181/182 [35:11<00:09,  9.26s/it]100%|██████████| 182/182 [35:17<00:00,  8.03s/it]100%|██████████| 182/182 [35:17<00:00, 11.63s/it]
Saving new dataset pyg object at /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/tiankampmann2021_crispri/data_pyg/cell_graphs.pkl
Done!
wandb: Currently logged in as: zhoumin1130. Use `wandb login --relogin` to force relogin
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.5
wandb: Run data is saved locally in /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/script/wandb/run-20240726_223715-0td40j4w
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run TianKampmann2021_CRISPRi_split1
wandb: ⭐️ View project at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: 🚀 View run at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/0td40j4w
Local copy of pyg dataset is detected. Loading...
Done!
Creating new splits....
Saving new splits at /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/tiankampmann2021_crispri/splits/tiankampmann2021_crispri_simulation_1_0.75.pkl
Simulation split test composition:
combo_seen0:0
combo_seen1:0
combo_seen2:0
unseen_single:46
Done!
Creating dataloaders....
Done!
wandb: - 0.001 MB of 0.001 MB uploadedwandb: \ 0.001 MB of 0.036 MB uploadedwandb: | 0.035 MB of 0.036 MB uploadedwandb: / 0.036 MB of 0.036 MB uploadedwandb: - 0.036 MB of 0.036 MB uploadedwandb: \ 0.036 MB of 0.036 MB uploadedwandb: | 0.036 MB of 0.036 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: elapsed_time █▁▂▁▅▂▄
wandb:        epoch ▁▂▃▅▆▇█
wandb:     val_loss █▁▅▂▅▇▃
wandb:      val_mre ▅▃▁▂█▁█
wandb: 
wandb: Run summary:
wandb:     best_model_info Best model with scor...
wandb:     early_stop_info Early stop at epoch ...
wandb:        elapsed_time 234.85982
wandb:               epoch 7
wandb: loading_params_info Loading params trans...
wandb:          match_info match 3830/5153 gene...
wandb:   resume_model_info Resume model from /h...
wandb:            run_time 2024-07-26 22:37:32
wandb:            val_loss 0.07395
wandb:             val_mre 61472.20919
wandb: 
wandb: 🚀 View run TianKampmann2021_CRISPRi_split1 at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/0td40j4w
wandb: ⭐️ View project at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240726_223715-0td40j4w/logs
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
wandb: Tracking run with wandb version 0.17.5
wandb: Run data is saved locally in /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/script/wandb/run-20240726_232103-tlwqw0s5
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run TianKampmann2021_CRISPRi_split2
wandb: ⭐️ View project at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: 🚀 View run at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/tlwqw0s5
Local copy of pyg dataset is detected. Loading...
Done!
Creating new splits....
Saving new splits at /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/tiankampmann2021_crispri/splits/tiankampmann2021_crispri_simulation_2_0.75.pkl
Simulation split test composition:
combo_seen0:0
combo_seen1:0
combo_seen2:0
unseen_single:46
Done!
Creating dataloaders....
Done!
wandb: - 0.001 MB of 0.001 MB uploadedwandb: \ 0.001 MB of 0.038 MB uploadedwandb: | 0.002 MB of 0.043 MB uploadedwandb: / 0.043 MB of 0.043 MB uploadedwandb: - 0.043 MB of 0.043 MB uploadedwandb: \ 0.043 MB of 0.043 MB uploadedwandb: | 0.043 MB of 0.043 MB uploadedwandb: / 0.043 MB of 0.043 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: elapsed_time █▂▁▁▁▁▁▂▂▂▂▂▂▃▂
wandb:        epoch ▁▁▂▃▃▃▄▅▅▅▆▇▇▇█
wandb:     val_loss ▅█▅▃▄▂▃▃▃▁▃▃▂▄▄
wandb:      val_mre ▇█▄▃▂▄▅▃▁▂▁▃▂▂▄
wandb: 
wandb: Run summary:
wandb:     best_model_info Best model with scor...
wandb:     early_stop_info Early stop at epoch ...
wandb:        elapsed_time 233.11021
wandb:               epoch 15
wandb: loading_params_info Loading params trans...
wandb:          match_info match 3830/5153 gene...
wandb:   resume_model_info Resume model from /h...
wandb:            run_time 2024-07-26 23:21:20
wandb:            val_loss 0.07619
wandb:             val_mre 62057.59056
wandb: 
wandb: 🚀 View run TianKampmann2021_CRISPRi_split2 at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/tlwqw0s5
wandb: ⭐️ View project at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240726_232103-tlwqw0s5/logs
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
wandb: Tracking run with wandb version 0.17.5
wandb: Run data is saved locally in /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/script/wandb/run-20240727_003537-8r2dt9vz
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run TianKampmann2021_CRISPRi_split3
wandb: ⭐️ View project at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: 🚀 View run at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/8r2dt9vz
Local copy of pyg dataset is detected. Loading...
Done!
Creating new splits....
Saving new splits at /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/tiankampmann2021_crispri/splits/tiankampmann2021_crispri_simulation_3_0.75.pkl
Simulation split test composition:
combo_seen0:0
combo_seen1:0
combo_seen2:0
unseen_single:46
Done!
Creating dataloaders....
Done!
Traceback (most recent call last):
  File "/home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/script/TianKampmann2021_CRISPRi.py", line 491, in <module>
    test_res = eval_perturb(test_loader, best_model, device, pert_data)
  File "/home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/script/TianKampmann2021_CRISPRi.py", line 277, in eval_perturb
    p = model.pred_perturb(batch, include_zero_gene, gene_ids=gene_ids)
  File "/home/share/huadjyin/home/zhoumin3/.conda/envs/scgpt/lib/python3.9/site-packages/scgpt/model/generation_model.py", line 322, in pred_perturb
    output_dict = self(
  File "/home/share/huadjyin/home/zhoumin3/.conda/envs/scgpt/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/share/huadjyin/home/zhoumin3/.conda/envs/scgpt/lib/python3.9/site-packages/scgpt/model/generation_model.py", line 206, in forward
    transformer_output = self._encode(
  File "/home/share/huadjyin/home/zhoumin3/.conda/envs/scgpt/lib/python3.9/site-packages/scgpt/model/generation_model.py", line 141, in _encode
    output = self.transformer_encoder(
  File "/home/share/huadjyin/home/zhoumin3/.conda/envs/scgpt/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/share/huadjyin/home/zhoumin3/.conda/envs/scgpt/lib/python3.9/site-packages/torch/nn/modules/transformer.py", line 315, in forward
    output = mod(output, src_mask=mask, is_causal=is_causal, src_key_padding_mask=src_key_padding_mask_for_layers)
  File "/home/share/huadjyin/home/zhoumin3/.conda/envs/scgpt/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/share/huadjyin/home/zhoumin3/.conda/envs/scgpt/lib/python3.9/site-packages/torch/nn/modules/transformer.py", line 591, in forward
    x = self.norm1(x + self._sa_block(x, src_mask, src_key_padding_mask, is_causal=is_causal))
  File "/home/share/huadjyin/home/zhoumin3/.conda/envs/scgpt/lib/python3.9/site-packages/torch/nn/modules/transformer.py", line 599, in _sa_block
    x = self.self_attn(x, x, x,
  File "/home/share/huadjyin/home/zhoumin3/.conda/envs/scgpt/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/share/huadjyin/home/zhoumin3/.conda/envs/scgpt/lib/python3.9/site-packages/torch/nn/modules/activation.py", line 1205, in forward
    attn_output, attn_output_weights = F.multi_head_attention_forward(
  File "/home/share/huadjyin/home/zhoumin3/.conda/envs/scgpt/lib/python3.9/site-packages/torch/nn/functional.py", line 5373, in multi_head_attention_forward
    attn_output = scaled_dot_product_attention(q, k, v, attn_mask, dropout_p, is_causal)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 12.66 GiB (GPU 0; 39.41 GiB total capacity; 15.80 GiB already allocated; 8.35 GiB free; 29.73 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
Traceback (most recent call last):
  File "/home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/script/TianKampmann2021_CRISPRi.py", line 491, in <module>
    test_res = eval_perturb(test_loader, best_model, device, pert_data)
  File "/home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/script/TianKampmann2021_CRISPRi.py", line 277, in eval_perturb
    p = model.pred_perturb(batch, include_zero_gene, gene_ids=gene_ids)
  File "/home/share/huadjyin/home/zhoumin3/.conda/envs/scgpt/lib/python3.9/site-packages/scgpt/model/generation_model.py", line 322, in pred_perturb
    output_dict = self(
  File "/home/share/huadjyin/home/zhoumin3/.conda/envs/scgpt/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/share/huadjyin/home/zhoumin3/.conda/envs/scgpt/lib/python3.9/site-packages/scgpt/model/generation_model.py", line 206, in forward
    transformer_output = self._encode(
  File "/home/share/huadjyin/home/zhoumin3/.conda/envs/scgpt/lib/python3.9/site-packages/scgpt/model/generation_model.py", line 141, in _encode
    output = self.transformer_encoder(
  File "/home/share/huadjyin/home/zhoumin3/.conda/envs/scgpt/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/share/huadjyin/home/zhoumin3/.conda/envs/scgpt/lib/python3.9/site-packages/torch/nn/modules/transformer.py", line 315, in forward
    output = mod(output, src_mask=mask, is_causal=is_causal, src_key_padding_mask=src_key_padding_mask_for_layers)
  File "/home/share/huadjyin/home/zhoumin3/.conda/envs/scgpt/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/share/huadjyin/home/zhoumin3/.conda/envs/scgpt/lib/python3.9/site-packages/torch/nn/modules/transformer.py", line 591, in forward
    x = self.norm1(x + self._sa_block(x, src_mask, src_key_padding_mask, is_causal=is_causal))
  File "/home/share/huadjyin/home/zhoumin3/.conda/envs/scgpt/lib/python3.9/site-packages/torch/nn/modules/transformer.py", line 599, in _sa_block
    x = self.self_attn(x, x, x,
  File "/home/share/huadjyin/home/zhoumin3/.conda/envs/scgpt/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/share/huadjyin/home/zhoumin3/.conda/envs/scgpt/lib/python3.9/site-packages/torch/nn/modules/activation.py", line 1205, in forward
    attn_output, attn_output_weights = F.multi_head_attention_forward(
  File "/home/share/huadjyin/home/zhoumin3/.conda/envs/scgpt/lib/python3.9/site-packages/torch/nn/functional.py", line 5373, in multi_head_attention_forward
    attn_output = scaled_dot_product_attention(q, k, v, attn_mask, dropout_p, is_causal)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 12.66 GiB (GPU 0; 39.41 GiB total capacity; 15.80 GiB already allocated; 8.35 GiB free; 29.73 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
wandb: - 0.001 MB of 0.001 MB uploadedwandb: \ 0.001 MB of 0.045 MB uploadedwandb: | 0.044 MB of 0.045 MB uploadedwandb: / 0.045 MB of 0.045 MB uploadedwandb: - 0.045 MB of 0.045 MB uploadedwandb: 
wandb: Run history:
wandb: elapsed_time ▃▃▁▃▅▂▅▆▅█▆
wandb:        epoch ▁▂▂▃▄▅▅▆▇▇█
wandb:     val_loss █▃▃▃▂▁▃▂▁▃▃
wandb:      val_mre ▅▁▃▆█▁▁▂▄▁▁
wandb: 
wandb: Run summary:
wandb:     best_model_info Best model with scor...
wandb:     early_stop_info Early stop at epoch ...
wandb:        elapsed_time 239.14262
wandb:               epoch 11
wandb: loading_params_info Loading params trans...
wandb:          match_info match 3830/5153 gene...
wandb:   resume_model_info Resume model from /h...
wandb:            run_time 2024-07-27 00:35:50
wandb:            val_loss 0.07377
wandb:             val_mre 53322.06621
wandb: 
wandb: 🚀 View run TianKampmann2021_CRISPRi_split3 at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/8r2dt9vz
wandb: ⭐️ View project at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240727_003537-8r2dt9vz/logs
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
