cuda-11.8.0 loaded successful
gcc-9.3.0 loaded successful
cmake-3.27.0 loaded successful
openmpi-4.1.2 loaded successful
Openblas-0.3.25 loaded successful
/home/share/huadjyin/home/zhoumin3/.conda/envs/scgpt/lib/python3.9/site-packages/scgpt/model/multiomic_model.py:19: UserWarning: flash_attn is not installed
  warnings.warn("flash_attn is not installed")
/home/share/huadjyin/home/zhoumin3/.conda/envs/scgpt/lib/python3.9/site-packages/wandb/analytics/sentry.py:90: SentryHubDeprecationWarning: `sentry_sdk.Hub` is deprecated and will be removed in a future major release. Please consult our 1.x to 2.x migration guide for details on how to migrate `Hub` usage to the new API: https://docs.sentry.io/platforms/python/migration/1.x-to-2.x
  self.hub = sentry_sdk.Hub(client)
Creating pyg object for each cell in the data...
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:17<06:23, 17.42s/it]  9%|▊         | 2/23 [00:30<05:09, 14.74s/it] 13%|█▎        | 3/23 [00:34<03:20, 10.01s/it] 17%|█▋        | 4/23 [00:40<02:36,  8.26s/it] 22%|██▏       | 5/23 [00:47<02:21,  7.87s/it] 26%|██▌       | 6/23 [00:49<01:40,  5.88s/it] 30%|███       | 7/23 [00:54<01:29,  5.61s/it] 35%|███▍      | 8/23 [01:00<01:28,  5.87s/it] 39%|███▉      | 9/23 [01:06<01:20,  5.78s/it] 43%|████▎     | 10/23 [01:12<01:14,  5.76s/it] 48%|████▊     | 11/23 [01:20<01:19,  6.59s/it] 52%|█████▏    | 12/23 [01:30<01:23,  7.63s/it] 57%|█████▋    | 13/23 [01:37<01:13,  7.36s/it] 61%|██████    | 14/23 [01:38<00:49,  5.52s/it] 65%|██████▌   | 15/23 [01:41<00:36,  4.59s/it] 70%|██████▉   | 16/23 [01:46<00:33,  4.84s/it] 74%|███████▍  | 17/23 [01:51<00:29,  4.96s/it] 78%|███████▊  | 18/23 [01:58<00:27,  5.60s/it] 83%|████████▎ | 19/23 [02:02<00:20,  5.13s/it] 87%|████████▋ | 20/23 [02:13<00:20,  6.87s/it] 91%|█████████▏| 21/23 [02:19<00:13,  6.62s/it] 96%|█████████▌| 22/23 [02:21<00:05,  5.19s/it]100%|██████████| 23/23 [02:24<00:00,  4.36s/it]100%|██████████| 23/23 [02:24<00:00,  6.27s/it]
Saving new dataset pyg object at /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/dixit_combined/data_pyg/cell_graphs.pkl
Done!
wandb: Currently logged in as: zhoumin1130. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.17.5
wandb: Run data is saved locally in /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/script/wandb/run-20240729_041445-ace85b8a
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run Dixit_combined_split1
wandb: ⭐️ View project at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: 🚀 View run at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/ace85b8a
Local copy of pyg dataset is detected. Loading...
Done!
Local copy of split is detected. Loading...
Simulation split test composition:
combo_seen0:0
combo_seen1:0
combo_seen2:0
unseen_single:6
Done!
Creating dataloaders....
Done!
wandb: - 0.001 MB of 0.001 MB uploadedwandb: \ 0.001 MB of 0.038 MB uploadedwandb: | 0.038 MB of 0.038 MB uploadedwandb: / 0.038 MB of 0.038 MB uploadedwandb: - 0.038 MB of 0.038 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: elapsed_time █▅▅▅▄▁▁
wandb:        epoch ▁▂▃▅▆▇█
wandb:     val_loss ▇▁▄█▅▇█
wandb:      val_mre █▆▅▁▆▄▄
wandb: 
wandb: Run summary:
wandb:     best_model_info Best model with scor...
wandb:     early_stop_info Early stop at epoch ...
wandb:        elapsed_time 424.24572
wandb:               epoch 7
wandb: loading_params_info Loading params trans...
wandb:          match_info match 4587/5015 gene...
wandb:   resume_model_info Resume model from /h...
wandb:            run_time 2024-07-29 04:14:58
wandb:            val_loss 0.10319
wandb:             val_mre 62998.80158
wandb: 
wandb: 🚀 View run Dixit_combined_split1 at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/ace85b8a
wandb: ⭐️ View project at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240729_041445-ace85b8a/logs
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.5
wandb: Run data is saved locally in /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/script/wandb/run-20240729_052952-apyxcg54
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run Dixit_combined_split2
wandb: ⭐️ View project at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: 🚀 View run at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/apyxcg54
Local copy of pyg dataset is detected. Loading...
Done!
Local copy of split is detected. Loading...
Simulation split test composition:
combo_seen0:0
combo_seen1:0
combo_seen2:0
unseen_single:6
Done!
Creating dataloaders....
Done!
wandb: - 0.001 MB of 0.001 MB uploadedwandb: \ 0.001 MB of 0.046 MB uploadedwandb: | 0.046 MB of 0.046 MB uploadedwandb: / 0.046 MB of 0.046 MB uploadedwandb: - 0.046 MB of 0.046 MB uploadedwandb: \ 0.046 MB of 0.046 MB uploadedwandb: | 0.046 MB of 0.046 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: elapsed_time █▇▆▆▇▂▁▁▁▁▂▂▁▁
wandb:        epoch ▁▂▂▃▃▄▄▅▅▆▆▇▇█
wandb:     val_loss ▅█▆▄▄▃▅█▁▇▄▅▄█
wandb:      val_mre ▂█▃▃▂▂▃▃▁▁▁▂▂▁
wandb: 
wandb: Run summary:
wandb:     best_model_info Best model with scor...
wandb:     early_stop_info Early stop at epoch ...
wandb:        elapsed_time 391.16193
wandb:               epoch 14
wandb: loading_params_info Loading params trans...
wandb:          match_info match 4587/5015 gene...
wandb:   resume_model_info Resume model from /h...
wandb:            run_time 2024-07-29 05:30:09
wandb:            val_loss 0.10572
wandb:             val_mre 61088.69996
wandb: 
wandb: 🚀 View run Dixit_combined_split2 at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/apyxcg54
wandb: ⭐️ View project at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240729_052952-apyxcg54/logs
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
wandb: Tracking run with wandb version 0.17.5
wandb: Run data is saved locally in /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/script/wandb/run-20240729_073259-sp5auovb
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run Dixit_combined_split3
wandb: ⭐️ View project at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: 🚀 View run at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/sp5auovb
Local copy of pyg dataset is detected. Loading...
Done!
Local copy of split is detected. Loading...
Simulation split test composition:
combo_seen0:0
combo_seen1:0
combo_seen2:0
unseen_single:6
Done!
Creating dataloaders....
Done!
wandb: - 0.001 MB of 0.001 MB uploadedwandb: \ 0.001 MB of 0.040 MB uploadedwandb: | 0.002 MB of 0.040 MB uploadedwandb: / 0.040 MB of 0.040 MB uploadedwandb: - 0.040 MB of 0.040 MB uploadedwandb: \ 0.040 MB of 0.040 MB uploadedwandb: | 0.040 MB of 0.040 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: elapsed_time █▄▄▁▃▁▂▅▁
wandb:        epoch ▁▂▃▄▅▅▆▇█
wandb:     val_loss ▄▇▄▁█▄▅▇▃
wandb:      val_mre █▁▇▅▁▁▃▂▂
wandb: 
wandb: Run summary:
wandb:     best_model_info Best model with scor...
wandb:     early_stop_info Early stop at epoch ...
wandb:        elapsed_time 422.86118
wandb:               epoch 9
wandb: loading_params_info Loading params trans...
wandb:          match_info match 4587/5015 gene...
wandb:   resume_model_info Resume model from /h...
wandb:            run_time 2024-07-29 07:33:16
wandb:            val_loss 0.1084
wandb:             val_mre 64573.16151
wandb: 
wandb: 🚀 View run Dixit_combined_split3 at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/sp5auovb
wandb: ⭐️ View project at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240729_073259-sp5auovb/logs
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.5
wandb: Run data is saved locally in /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/script/wandb/run-20240729_085958-h497v0jx
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run Dixit_combined_split4
wandb: ⭐️ View project at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: 🚀 View run at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/h497v0jx
Local copy of pyg dataset is detected. Loading...
Done!
Local copy of split is detected. Loading...
Simulation split test composition:
combo_seen0:0
combo_seen1:0
combo_seen2:0
unseen_single:6
Done!
Creating dataloaders....
Done!
wandb: - 0.001 MB of 0.001 MB uploadedwandb: \ 0.001 MB of 0.042 MB uploadedwandb: | 0.006 MB of 0.042 MB uploadedwandb: / 0.006 MB of 0.042 MB uploadedwandb: - 0.042 MB of 0.042 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: elapsed_time █▅▃▂▁▂▆▁▂
wandb:        epoch ▁▂▃▄▅▅▆▇█
wandb:     val_loss ▃█▅▁▂▄▂▃▂
wandb:      val_mre ▄▁▄█▃▅▁▃▇
wandb: 
wandb: Run summary:
wandb:     best_model_info Best model with scor...
wandb:     early_stop_info Early stop at epoch ...
wandb:        elapsed_time 457.00942
wandb:               epoch 9
wandb: loading_params_info Loading params trans...
wandb:          match_info match 4587/5015 gene...
wandb:   resume_model_info Resume model from /h...
wandb:            run_time 2024-07-29 09:00:14
wandb:            val_loss 0.10296
wandb:             val_mre 70170.22767
wandb: 
wandb: 🚀 View run Dixit_combined_split4 at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/h497v0jx
wandb: ⭐️ View project at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240729_085958-h497v0jx/logs
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
wandb: Tracking run with wandb version 0.17.5
wandb: Run data is saved locally in /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/script/wandb/run-20240729_103056-zxnt001p
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run Dixit_combined_split5
wandb: ⭐️ View project at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: 🚀 View run at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/zxnt001p
Local copy of pyg dataset is detected. Loading...
Done!
Local copy of split is detected. Loading...
Simulation split test composition:
combo_seen0:0
combo_seen1:0
combo_seen2:0
unseen_single:6
Done!
Creating dataloaders....
Done!
wandb: - 0.001 MB of 0.001 MB uploadedwandb: \ 0.001 MB of 0.044 MB uploadedwandb: | 0.033 MB of 0.044 MB uploadedwandb: / 0.033 MB of 0.044 MB uploadedwandb: - 0.044 MB of 0.044 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: elapsed_time █▂▁▂▃▂▃▂▂▂▃
wandb:        epoch ▁▂▂▃▄▅▅▆▇▇█
wandb:     val_loss ▂▅▅▅▅▁▇▄█▆▆
wandb:      val_mre ▆▇▇▅▅▁▂▂▃█▅
wandb: 
wandb: Run summary:
wandb:     best_model_info Best model with scor...
wandb:     early_stop_info Early stop at epoch ...
wandb:        elapsed_time 449.53583
wandb:               epoch 11
wandb: loading_params_info Loading params trans...
wandb:          match_info match 4587/5015 gene...
wandb:   resume_model_info Resume model from /h...
wandb:            run_time 2024-07-29 10:31:12
wandb:            val_loss 0.10136
wandb:             val_mre 68338.10411
wandb: 
wandb: 🚀 View run Dixit_combined_split5 at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/zxnt001p
wandb: ⭐️ View project at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240729_103056-zxnt001p/logs
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
/home/share/huadjyin/home/zhoumin3/.conda/envs/scgpt/lib/python3.9/site-packages/scgpt/model/multiomic_model.py:19: UserWarning: flash_attn is not installed
  warnings.warn("flash_attn is not installed")
/home/share/huadjyin/home/zhoumin3/.conda/envs/scgpt/lib/python3.9/site-packages/wandb/analytics/sentry.py:90: SentryHubDeprecationWarning: `sentry_sdk.Hub` is deprecated and will be removed in a future major release. Please consult our 1.x to 2.x migration guide for details on how to migrate `Hub` usage to the new API: https://docs.sentry.io/platforms/python/migration/1.x-to-2.x
  self.hub = sentry_sdk.Hub(client)
Creating pyg object for each cell in the data...
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [04:27<44:31, 267.12s/it] 18%|█▊        | 2/11 [08:15<36:36, 244.06s/it] 27%|██▋       | 3/11 [09:34<22:30, 168.83s/it] 36%|███▋      | 4/11 [11:13<16:27, 141.14s/it] 45%|████▌     | 5/11 [13:24<13:46, 137.80s/it] 55%|█████▍    | 6/11 [13:26<07:37, 91.42s/it]  64%|██████▎   | 7/11 [14:57<06:04, 91.22s/it] 73%|███████▎  | 8/11 [16:51<04:55, 98.61s/it] 82%|████████▏ | 9/11 [18:31<03:18, 99.12s/it] 91%|█████████ | 10/11 [20:15<01:40, 100.62s/it]100%|██████████| 11/11 [22:48<00:00, 116.51s/it]100%|██████████| 11/11 [22:48<00:00, 124.39s/it]
Saving new dataset pyg object at /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/dixit_gsm2396858/data_pyg/cell_graphs.pkl
Done!
wandb: Currently logged in as: zhoumin1130. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.17.5
wandb: Run data is saved locally in /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/script/wandb/run-20240729_123953-ibtx30de
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run Dixit_GSM2396858_split1
wandb: ⭐️ View project at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: 🚀 View run at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/ibtx30de
Local copy of pyg dataset is detected. Loading...
Done!
Local copy of split is detected. Loading...
Simulation split test composition:
combo_seen0:0
combo_seen1:0
combo_seen2:0
unseen_single:3
Done!
Creating dataloaders....
Done!
wandb: - 0.001 MB of 0.001 MB uploadedwandb: \ 0.001 MB of 0.042 MB uploadedwandb: | 0.002 MB of 0.042 MB uploadedwandb: / 0.042 MB of 0.042 MB uploadedwandb: - 0.042 MB of 0.042 MB uploadedwandb: \ 0.042 MB of 0.042 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: elapsed_time █▂▁▂▄▅▂▂▂▂▃▅▃▄▃
wandb:        epoch ▁▁▂▃▃▃▄▅▅▅▆▇▇▇█
wandb:     val_loss ▄█▄▅▂▄█▇▄▁▅▇▆▅▆
wandb:      val_mre ▁▅▂▄▄▅█▃▃▅▅▃▄▁▃
wandb: 
wandb: Run summary:
wandb:     best_model_info Best model with scor...
wandb:     early_stop_info Early stop at epoch ...
wandb:        elapsed_time 271.5352
wandb:               epoch 15
wandb: loading_params_info Loading params trans...
wandb:          match_info match 4579/5008 gene...
wandb:   resume_model_info Resume model from /h...
wandb:            run_time 2024-07-29 12:40:11
wandb:            val_loss 0.09739
wandb:             val_mre 60598.97873
wandb: 
wandb: 🚀 View run Dixit_GSM2396858_split1 at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/ibtx30de
wandb: ⭐️ View project at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240729_123953-ibtx30de/logs
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.5
wandb: Run data is saved locally in /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/script/wandb/run-20240729_135142-k8dk7qql
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run Dixit_GSM2396858_split2
wandb: ⭐️ View project at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: 🚀 View run at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/k8dk7qql
Local copy of pyg dataset is detected. Loading...
Done!
Local copy of split is detected. Loading...
Simulation split test composition:
combo_seen0:0
combo_seen1:0
combo_seen2:0
unseen_single:3
Done!
Creating dataloaders....
Done!
wandb: - 0.001 MB of 0.001 MB uploadedwandb: \ 0.001 MB of 0.035 MB uploadedwandb: | 0.001 MB of 0.035 MB uploadedwandb: / 0.035 MB of 0.035 MB uploadedwandb: - 0.035 MB of 0.035 MB uploadedwandb: \ 0.035 MB of 0.035 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: elapsed_time █▃▂▂▂▁▂
wandb:        epoch ▁▂▃▅▆▇█
wandb:     val_loss █▁▃▃▃▄▂
wandb:      val_mre █▃▅▁▃▃▁
wandb: 
wandb: Run summary:
wandb:     best_model_info Best model with scor...
wandb:     early_stop_info Early stop at epoch ...
wandb:        elapsed_time 260.49089
wandb:               epoch 7
wandb: loading_params_info Loading params trans...
wandb:          match_info match 4579/5008 gene...
wandb:   resume_model_info Resume model from /h...
wandb:            run_time 2024-07-29 13:51:59
wandb:            val_loss 0.09502
wandb:             val_mre 59280.88421
wandb: 
wandb: 🚀 View run Dixit_GSM2396858_split2 at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/k8dk7qql
wandb: ⭐️ View project at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240729_135142-k8dk7qql/logs
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.5
wandb: Run data is saved locally in /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/script/wandb/run-20240729_142620-fnlhjgxz
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run Dixit_GSM2396858_split3
wandb: ⭐️ View project at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: 🚀 View run at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/fnlhjgxz
Local copy of pyg dataset is detected. Loading...
Done!
Local copy of split is detected. Loading...
Simulation split test composition:
combo_seen0:0
combo_seen1:0
combo_seen2:0
unseen_single:3
Done!
Creating dataloaders....
Done!
wandb: - 0.001 MB of 0.001 MB uploadedwandb: \ 0.001 MB of 0.037 MB uploadedwandb: | 0.002 MB of 0.037 MB uploadedwandb: / 0.037 MB of 0.037 MB uploadedwandb: - 0.037 MB of 0.037 MB uploadedwandb: \ 0.037 MB of 0.037 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: elapsed_time ▃▁▂▂▅█▅▂▁▁
wandb:        epoch ▁▂▃▃▄▅▆▆▇█
wandb:     val_loss ▆▃▇▃▁▂▄█▄▅
wandb:      val_mre █▆▃▁▁▄▂▂▂▂
wandb: 
wandb: Run summary:
wandb:     best_model_info Best model with scor...
wandb:     early_stop_info Early stop at epoch ...
wandb:        elapsed_time 219.8678
wandb:               epoch 10
wandb: loading_params_info Loading params trans...
wandb:          match_info match 4579/5008 gene...
wandb:   resume_model_info Resume model from /h...
wandb:            run_time 2024-07-29 14:26:36
wandb:            val_loss 0.10249
wandb:             val_mre 60481.69271
wandb: 
wandb: 🚀 View run Dixit_GSM2396858_split3 at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/fnlhjgxz
wandb: ⭐️ View project at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240729_142620-fnlhjgxz/logs
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.5
wandb: Run data is saved locally in /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/script/wandb/run-20240729_150904-cwgd4h6d
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run Dixit_GSM2396858_split4
wandb: ⭐️ View project at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: 🚀 View run at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/cwgd4h6d
Local copy of pyg dataset is detected. Loading...
Done!
Local copy of split is detected. Loading...
Simulation split test composition:
combo_seen0:0
combo_seen1:0
combo_seen2:0
unseen_single:3
Done!
Creating dataloaders....
Done!
wandb: - 0.001 MB of 0.001 MB uploadedwandb: \ 0.001 MB of 0.042 MB uploadedwandb: | 0.001 MB of 0.042 MB uploadedwandb: / 0.002 MB of 0.042 MB uploadedwandb: - 0.002 MB of 0.042 MB uploadedwandb: \ 0.042 MB of 0.042 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: elapsed_time █▂▁▃▆▆▅▄▅▃▄▅▅▅
wandb:        epoch ▁▂▂▃▃▄▄▅▅▆▆▇▇█
wandb:     val_loss ▄▃▅▅▂█▄▁▁▃▄▅▇▄
wandb:      val_mre █▅▄▄▇▁▁▄▂▃▃▄▄▃
wandb: 
wandb: Run summary:
wandb:     best_model_info Best model with scor...
wandb:     early_stop_info Early stop at epoch ...
wandb:        elapsed_time 261.15603
wandb:               epoch 14
wandb: loading_params_info Loading params trans...
wandb:          match_info match 4579/5008 gene...
wandb:   resume_model_info Resume model from /h...
wandb:            run_time 2024-07-29 15:09:20
wandb:            val_loss 0.09561
wandb:             val_mre 60710.99909
wandb: 
wandb: 🚀 View run Dixit_GSM2396858_split4 at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/cwgd4h6d
wandb: ⭐️ View project at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240729_150904-cwgd4h6d/logs
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.5
wandb: Run data is saved locally in /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/script/wandb/run-20240729_161346-dnf0lrhz
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run Dixit_GSM2396858_split5
wandb: ⭐️ View project at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: 🚀 View run at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/dnf0lrhz
Local copy of pyg dataset is detected. Loading...
Done!
Local copy of split is detected. Loading...
Simulation split test composition:
combo_seen0:0
combo_seen1:0
combo_seen2:0
unseen_single:3
Done!
Creating dataloaders....
Done!
wandb: - 0.001 MB of 0.001 MB uploadedwandb: \ 0.001 MB of 0.040 MB uploadedwandb: | 0.002 MB of 0.040 MB uploadedwandb: / 0.002 MB of 0.040 MB uploadedwandb: - 0.040 MB of 0.040 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: elapsed_time █▃▁▅▄▁▂▂▃▁▆█▃▃
wandb:        epoch ▁▂▂▃▃▄▄▅▅▆▆▇▇█
wandb:     val_loss ▃▃█▂▃▆▄▅▁▃▃▃▃▃
wandb:      val_mre ▃▁▇▂▄█▅▄▄█▄▅▇▆
wandb: 
wandb: Run summary:
wandb:     best_model_info Best model with scor...
wandb:     early_stop_info Early stop at epoch ...
wandb:        elapsed_time 228.75628
wandb:               epoch 14
wandb: loading_params_info Loading params trans...
wandb:          match_info match 4579/5008 gene...
wandb:   resume_model_info Resume model from /h...
wandb:            run_time 2024-07-29 16:14:00
wandb:            val_loss 0.09991
wandb:             val_mre 67894.61559
wandb: 
wandb: 🚀 View run Dixit_GSM2396858_split5 at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/dnf0lrhz
wandb: ⭐️ View project at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240729_161346-dnf0lrhz/logs
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
/home/share/huadjyin/home/zhoumin3/.conda/envs/scgpt/lib/python3.9/site-packages/scgpt/model/multiomic_model.py:19: UserWarning: flash_attn is not installed
  warnings.warn("flash_attn is not installed")
/home/share/huadjyin/home/zhoumin3/.conda/envs/scgpt/lib/python3.9/site-packages/wandb/analytics/sentry.py:90: SentryHubDeprecationWarning: `sentry_sdk.Hub` is deprecated and will be removed in a future major release. Please consult our 1.x to 2.x migration guide for details on how to migrate `Hub` usage to the new API: https://docs.sentry.io/platforms/python/migration/1.x-to-2.x
  self.hub = sentry_sdk.Hub(client)
Creating pyg object for each cell in the data...
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [02:39<34:29, 159.18s/it] 14%|█▍        | 2/14 [04:34<26:38, 133.25s/it] 21%|██▏       | 3/14 [04:53<14:52, 81.11s/it]  29%|██▊       | 4/14 [05:38<11:08, 66.88s/it] 36%|███▌      | 5/14 [06:18<08:33, 57.10s/it] 43%|████▎     | 6/14 [07:41<08:49, 66.13s/it] 50%|█████     | 7/14 [09:04<08:20, 71.57s/it] 57%|█████▋    | 8/14 [09:05<04:54, 49.13s/it] 64%|██████▍   | 9/14 [11:05<05:55, 71.09s/it] 71%|███████▏  | 10/14 [12:09<04:35, 68.90s/it] 79%|███████▊  | 11/14 [14:56<04:57, 99.09s/it] 86%|████████▌ | 12/14 [16:29<03:14, 97.07s/it] 93%|█████████▎| 13/14 [16:56<01:16, 76.01s/it]100%|██████████| 14/14 [17:32<00:00, 64.04s/it]100%|██████████| 14/14 [17:32<00:00, 75.21s/it]
Saving new dataset pyg object at /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/dixit_gsm2396861/data_pyg/cell_graphs.pkl
Done!
wandb: Currently logged in as: zhoumin1130. Use `wandb login --relogin` to force relogin
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.5
wandb: Run data is saved locally in /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/script/wandb/run-20240729_173101-tnw4ay3q
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run Dixit_GSM2396861_split1
wandb: ⭐️ View project at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: 🚀 View run at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/tnw4ay3q
Local copy of pyg dataset is detected. Loading...
Done!
Local copy of split is detected. Loading...
Simulation split test composition:
combo_seen0:0
combo_seen1:0
combo_seen2:0
unseen_single:4
Done!
Creating dataloaders....
Done!
wandb: - 0.001 MB of 0.001 MB uploadedwandb: \ 0.001 MB of 0.035 MB uploadedwandb: | 0.035 MB of 0.035 MB uploadedwandb: / 0.035 MB of 0.035 MB uploadedwandb: - 0.035 MB of 0.035 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: elapsed_time █▄▃▂▃▁▁▁▁
wandb:        epoch ▁▂▃▄▅▅▆▇█
wandb:     val_loss █▇▃▁▄▁▄▆▂
wandb:      val_mre ▅▃▅▆▃▁▃█▃
wandb: 
wandb: Run summary:
wandb:     best_model_info Best model with scor...
wandb:     early_stop_info Early stop at epoch ...
wandb:        elapsed_time 183.30355
wandb:               epoch 9
wandb: loading_params_info Loading params trans...
wandb:          match_info match 4571/5007 gene...
wandb:   resume_model_info Resume model from /h...
wandb:            run_time 2024-07-29 17:31:19
wandb:            val_loss 0.10101
wandb:             val_mre 65298.82476
wandb: 
wandb: 🚀 View run Dixit_GSM2396861_split1 at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/tnw4ay3q
wandb: ⭐️ View project at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240729_173101-tnw4ay3q/logs
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.5
wandb: Run data is saved locally in /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/script/wandb/run-20240729_180804-ld9hdg3u
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run Dixit_GSM2396861_split2
wandb: ⭐️ View project at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: 🚀 View run at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/ld9hdg3u
Local copy of pyg dataset is detected. Loading...
Done!
Local copy of split is detected. Loading...
Simulation split test composition:
combo_seen0:0
combo_seen1:0
combo_seen2:0
unseen_single:4
Done!
Creating dataloaders....
Done!
wandb: - 0.001 MB of 0.001 MB uploadedwandb: \ 0.001 MB of 0.034 MB uploadedwandb: | 0.002 MB of 0.034 MB uploadedwandb: / 0.002 MB of 0.034 MB uploadedwandb: - 0.034 MB of 0.034 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: elapsed_time █▅▄▁▅▅▂
wandb:        epoch ▁▂▃▅▆▇█
wandb:     val_loss ▅▁▅▄▆▃█
wandb:      val_mre █▂▁▃▄▃▃
wandb: 
wandb: Run summary:
wandb:     best_model_info Best model with scor...
wandb:     early_stop_info Early stop at epoch ...
wandb:        elapsed_time 184.78151
wandb:               epoch 7
wandb: loading_params_info Loading params trans...
wandb:          match_info match 4571/5007 gene...
wandb:   resume_model_info Resume model from /h...
wandb:            run_time 2024-07-29 18:08:21
wandb:            val_loss 0.10729
wandb:             val_mre 69658.34046
wandb: 
wandb: 🚀 View run Dixit_GSM2396861_split2 at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/ld9hdg3u
wandb: ⭐️ View project at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240729_180804-ld9hdg3u/logs
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
wandb: Tracking run with wandb version 0.17.5
wandb: Run data is saved locally in /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/script/wandb/run-20240729_184148-sfqdrk9k
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run Dixit_GSM2396861_split3
wandb: ⭐️ View project at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: 🚀 View run at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/sfqdrk9k
Local copy of pyg dataset is detected. Loading...
Done!
Local copy of split is detected. Loading...
Simulation split test composition:
combo_seen0:0
combo_seen1:0
combo_seen2:0
unseen_single:4
Done!
Creating dataloaders....
Done!
wandb: - 0.001 MB of 0.001 MB uploadedwandb: \ 0.001 MB of 0.034 MB uploadedwandb: | 0.002 MB of 0.034 MB uploadedwandb: / 0.034 MB of 0.034 MB uploadedwandb: - 0.034 MB of 0.034 MB uploadedwandb: \ 0.034 MB of 0.034 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: elapsed_time █▄▁▁▁▂▃
wandb:        epoch ▁▂▃▅▆▇█
wandb:     val_loss ▆▁▄▄▇█▄
wandb:      val_mre ▁▅▄█▄▃▁
wandb: 
wandb: Run summary:
wandb:     best_model_info Best model with scor...
wandb:     early_stop_info Early stop at epoch ...
wandb:        elapsed_time 175.92012
wandb:               epoch 7
wandb: loading_params_info Loading params trans...
wandb:          match_info match 4571/5007 gene...
wandb:   resume_model_info Resume model from /h...
wandb:            run_time 2024-07-29 18:42:03
wandb:            val_loss 0.10216
wandb:             val_mre 65360.75234
wandb: 
wandb: 🚀 View run Dixit_GSM2396861_split3 at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/sfqdrk9k
wandb: ⭐️ View project at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240729_184148-sfqdrk9k/logs
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.5
wandb: Run data is saved locally in /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/script/wandb/run-20240729_191616-p0v0wz80
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run Dixit_GSM2396861_split4
wandb: ⭐️ View project at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: 🚀 View run at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/p0v0wz80
Local copy of pyg dataset is detected. Loading...
Done!
Local copy of split is detected. Loading...
Simulation split test composition:
combo_seen0:0
combo_seen1:0
combo_seen2:0
unseen_single:4
Done!
Creating dataloaders....
Done!
wandb: - 0.001 MB of 0.001 MB uploadedwandb: \ 0.001 MB of 0.039 MB uploadedwandb: | 0.002 MB of 0.039 MB uploadedwandb: / 0.039 MB of 0.039 MB uploadedwandb: - 0.039 MB of 0.039 MB uploadedwandb: \ 0.039 MB of 0.039 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: elapsed_time █▄█▂▂▁▁▅▃▄▄▅▃▅▅
wandb:        epoch ▁▁▂▃▃▃▄▅▅▅▆▇▇▇█
wandb:     val_loss █▅▅▅█▄▃█▅▅▆▃▄▁▅
wandb:      val_mre ▆▆▁▅▆▄▇▃▇▆█▆▁▆▂
wandb: 
wandb: Run summary:
wandb:     best_model_info Best model with scor...
wandb:        elapsed_time 170.88819
wandb:               epoch 15
wandb: loading_params_info Loading params trans...
wandb:          match_info match 4571/5007 gene...
wandb:   resume_model_info Resume model from /h...
wandb:            run_time 2024-07-29 19:16:32
wandb:            val_loss 0.10531
wandb:             val_mre 64459.57586
wandb: 
wandb: 🚀 View run Dixit_GSM2396861_split4 at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/p0v0wz80
wandb: ⭐️ View project at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240729_191616-p0v0wz80/logs
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
wandb: Tracking run with wandb version 0.17.5
wandb: Run data is saved locally in /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03scgpt/script/wandb/run-20240729_201350-3g9y5o4w
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run Dixit_GSM2396861_split5
wandb: ⭐️ View project at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: 🚀 View run at https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/3g9y5o4w
Local copy of pyg dataset is detected. Loading...
Done!
Local copy of split is detected. Loading...
Simulation split test composition:
combo_seen0:0
combo_seen1:0
combo_seen2:0
unseen_single:4
Done!
Creating dataloaders....
Done!
wandb: - 0.001 MB of 0.001 MB uploadedwandb: \ 0.001 MB of 0.036 MB uploadedwandb: | 0.036 MB of 0.036 MB uploadedwandb: / 0.036 MB of 0.036 MB uploadedwandb: - 0.036 MB of 0.036 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: elapsed_time █▄▃▅▅▆▅▅▄▁▂
wandb:        epoch ▁▂▂▃▄▅▅▆▇▇█
wandb:     val_loss █▃▄▄▃▁▄▄▂▄▄
wandb:      val_mre ▄▂█▁▂▄▃▂▁▂▄
wandb: 
wandb: Run summary:
wandb:     best_model_info Best model with scor...
wandb:     early_stop_info Early stop at epoch ...
wandb:        elapsed_time 163.09847
wandb:               epoch 11
wandb: loading_params_info Loading params trans...
wandb:          match_info match 4571/5007 gene...
wandb:   resume_model_info Resume model from /h...
wandb:            run_time 2024-07-29 20:14:07
wandb:            val_loss 0.10393
wandb:             val_mre 73477.48292
wandb: 
wandb: 🚀 View run Dixit_GSM2396861_split5 at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt/runs/3g9y5o4w
wandb: ⭐️ View project at: https://wandb.ai/zhoumin1130/01_dataset_all_scgpt
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240729_201350-3g9y5o4w/logs
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
