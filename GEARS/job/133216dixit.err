cuda-11.8.0 loaded successful
gcc-12.2.0 loaded successful
cmake-3.27.0 loaded successful
openmpi-4.1.2 loaded successful
Openblas-0.3.25 loaded successful
Found local copy...
Creating pyg object for each cell in the data...
Creating dataset file...
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:23<08:32, 23.28s/it]  9%|▊         | 2/23 [00:41<07:02, 20.14s/it] 13%|█▎        | 3/23 [00:47<04:37, 13.89s/it] 17%|█▋        | 4/23 [00:55<03:37, 11.45s/it] 22%|██▏       | 5/23 [01:05<03:18, 11.04s/it] 26%|██▌       | 6/23 [01:07<02:13,  7.87s/it] 30%|███       | 7/23 [01:14<02:01,  7.60s/it] 35%|███▍      | 8/23 [01:23<02:00,  8.01s/it] 39%|███▉      | 9/23 [01:31<01:52,  8.03s/it] 43%|████▎     | 10/23 [01:39<01:44,  8.00s/it] 48%|████▊     | 11/23 [01:50<01:49,  9.09s/it] 52%|█████▏    | 12/23 [02:05<01:57, 10.65s/it] 57%|█████▋    | 13/23 [02:14<01:42, 10.29s/it] 61%|██████    | 14/23 [02:16<01:09,  7.69s/it] 65%|██████▌   | 15/23 [02:19<00:51,  6.49s/it] 70%|██████▉   | 16/23 [02:26<00:46,  6.64s/it] 74%|███████▍  | 17/23 [02:34<00:41,  6.84s/it] 78%|███████▊  | 18/23 [02:44<00:39,  7.86s/it] 83%|████████▎ | 19/23 [02:50<00:29,  7.29s/it] 87%|████████▋ | 20/23 [03:05<00:28,  9.64s/it] 91%|█████████▏| 21/23 [03:14<00:18,  9.35s/it] 96%|█████████▌| 22/23 [03:16<00:07,  7.33s/it]100%|██████████| 23/23 [03:20<00:00,  6.16s/it]100%|██████████| 23/23 [03:20<00:00,  8.71s/it]
Done!
Saving new dataset pyg object at /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03final/dixit_combined/data_pyg/cell_graphs.pkl
Done!
Creating new splits....
Saving new splits at /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03final/dixit_combined/splits/dixit_combined_simulation_1_0.75.pkl
Simulation split test composition:
combo_seen0:0
combo_seen1:0
combo_seen2:0
unseen_single:6
Done!
Creating dataloaders....
Done!
  0%|          | 0/3600 [00:00<?, ?it/s]  0%|          | 6/3600 [00:00<01:02, 57.36it/s]  0%|          | 15/3600 [00:00<00:47, 75.05it/s]  1%|          | 23/3600 [00:00<00:48, 74.38it/s]  1%|          | 33/3600 [00:00<00:44, 80.81it/s]  1%|          | 42/3600 [00:00<00:45, 78.92it/s]  1%|▏         | 50/3600 [00:00<00:45, 77.82it/s]  2%|▏         | 59/3600 [00:00<00:43, 81.41it/s]  2%|▏         | 68/3600 [00:00<00:43, 81.05it/s]  2%|▏         | 78/3600 [00:00<00:40, 86.03it/s]  2%|▏         | 87/3600 [00:01<00:40, 86.17it/s]  3%|▎         | 96/3600 [00:01<00:40, 86.77it/s]  3%|▎         | 105/3600 [00:01<00:39, 87.40it/s]  3%|▎         | 114/3600 [00:01<00:39, 87.61it/s]  3%|▎         | 123/3600 [00:01<00:39, 87.75it/s]  4%|▎         | 132/3600 [00:01<00:40, 85.34it/s]  4%|▍         | 142/3600 [00:01<00:38, 89.34it/s]  4%|▍         | 151/3600 [00:01<00:39, 86.36it/s]  4%|▍         | 161/3600 [00:01<00:38, 89.34it/s]  5%|▍         | 170/3600 [00:02<00:38, 88.62it/s]  5%|▍         | 179/3600 [00:02<00:38, 88.13it/s]  5%|▌         | 188/3600 [00:02<00:38, 88.49it/s]  5%|▌         | 197/3600 [00:02<00:38, 88.91it/s]  6%|▌         | 206/3600 [00:02<00:39, 85.26it/s]  6%|▌         | 215/3600 [00:02<00:40, 84.58it/s]  6%|▌         | 224/3600 [00:02<00:40, 84.23it/s]  6%|▋         | 234/3600 [00:02<00:38, 88.36it/s]  7%|▋         | 243/3600 [00:02<00:38, 88.27it/s]  7%|▋         | 252/3600 [00:02<00:39, 85.66it/s]  7%|▋         | 263/3600 [00:03<00:37, 89.88it/s]  8%|▊         | 272/3600 [00:03<00:37, 89.65it/s]  8%|▊         | 281/3600 [00:03<00:37, 89.32it/s]  8%|▊         | 290/3600 [00:03<00:38, 85.72it/s]  8%|▊         | 300/3600 [00:03<00:37, 88.97it/s]  9%|▊         | 309/3600 [00:03<00:36, 89.12it/s]  9%|▉         | 318/3600 [00:03<00:37, 88.08it/s]  9%|▉         | 327/3600 [00:03<00:38, 84.48it/s]  9%|▉         | 336/3600 [00:03<00:38, 84.31it/s] 10%|▉         | 346/3600 [00:04<00:37, 86.28it/s] 10%|▉         | 355/3600 [00:04<00:37, 86.06it/s] 10%|█         | 364/3600 [00:04<00:37, 86.30it/s] 10%|█         | 373/3600 [00:04<00:37, 85.72it/s] 11%|█         | 382/3600 [00:04<00:37, 86.74it/s] 11%|█         | 391/3600 [00:04<00:37, 86.00it/s] 11%|█         | 400/3600 [00:04<00:37, 85.53it/s] 11%|█▏        | 409/3600 [00:04<00:37, 86.06it/s] 12%|█▏        | 418/3600 [00:04<00:37, 85.83it/s] 12%|█▏        | 427/3600 [00:04<00:37, 85.39it/s] 12%|█▏        | 436/3600 [00:05<00:36, 85.98it/s] 12%|█▏        | 445/3600 [00:05<00:36, 85.79it/s] 13%|█▎        | 454/3600 [00:05<00:37, 83.23it/s] 13%|█▎        | 464/3600 [00:05<00:36, 85.75it/s] 13%|█▎        | 473/3600 [00:05<00:38, 81.69it/s] 13%|█▎        | 482/3600 [00:05<00:37, 83.31it/s] 14%|█▎        | 492/3600 [00:05<00:36, 85.84it/s] 14%|█▍        | 501/3600 [00:05<00:37, 82.77it/s] 14%|█▍        | 511/3600 [00:05<00:37, 82.33it/s] 14%|█▍        | 520/3600 [00:06<00:37, 81.68it/s] 15%|█▍        | 530/3600 [00:06<00:36, 85.11it/s] 15%|█▍        | 539/3600 [00:06<00:35, 85.14it/s] 15%|█▌        | 548/3600 [00:06<00:36, 84.66it/s] 15%|█▌        | 557/3600 [00:06<00:35, 85.86it/s] 16%|█▌        | 566/3600 [00:06<00:36, 82.18it/s] 16%|█▌        | 576/3600 [00:06<00:36, 83.29it/s] 16%|█▋        | 586/3600 [00:06<00:34, 86.75it/s] 17%|█▋        | 595/3600 [00:06<00:35, 85.48it/s] 17%|█▋        | 604/3600 [00:07<00:35, 83.45it/s] 17%|█▋        | 614/3600 [00:07<00:34, 86.64it/s] 17%|█▋        | 623/3600 [00:07<00:34, 85.63it/s] 18%|█▊        | 632/3600 [00:07<00:35, 83.28it/s] 18%|█▊        | 642/3600 [00:07<00:34, 85.04it/s] 18%|█▊        | 651/3600 [00:07<00:35, 83.88it/s] 18%|█▊        | 660/3600 [00:07<00:35, 82.21it/s] 19%|█▊        | 669/3600 [00:07<00:35, 83.25it/s] 19%|█▉        | 679/3600 [00:07<00:33, 87.12it/s] 19%|█▉        | 688/3600 [00:08<00:33, 86.81it/s] 19%|█▉        | 697/3600 [00:08<00:33, 86.63it/s] 20%|█▉        | 706/3600 [00:08<00:33, 87.52it/s] 20%|█▉        | 715/3600 [00:08<00:34, 83.43it/s] 20%|██        | 725/3600 [00:08<00:33, 86.86it/s] 20%|██        | 734/3600 [00:08<00:33, 84.77it/s] 21%|██        | 744/3600 [00:08<00:32, 87.92it/s] 21%|██        | 753/3600 [00:08<00:32, 87.61it/s] 21%|██        | 762/3600 [00:08<00:32, 87.47it/s] 21%|██▏       | 771/3600 [00:09<00:32, 85.91it/s] 22%|██▏       | 780/3600 [00:09<00:32, 86.25it/s] 22%|██▏       | 789/3600 [00:09<00:32, 86.07it/s] 22%|██▏       | 798/3600 [00:09<00:32, 85.65it/s] 22%|██▏       | 807/3600 [00:09<00:33, 82.91it/s] 23%|██▎       | 816/3600 [00:09<00:32, 84.87it/s] 23%|██▎       | 825/3600 [00:09<00:33, 82.28it/s] 23%|██▎       | 834/3600 [00:09<00:33, 83.71it/s] 23%|██▎       | 844/3600 [00:09<00:31, 86.97it/s] 24%|██▎       | 854/3600 [00:10<00:31, 87.46it/s] 24%|██▍       | 863/3600 [00:10<00:32, 84.15it/s] 24%|██▍       | 874/3600 [00:10<00:30, 90.71it/s] 25%|██▍       | 884/3600 [00:10<00:32, 83.26it/s] 25%|██▍       | 893/3600 [00:10<00:34, 78.47it/s] 25%|██▌       | 901/3600 [00:10<00:36, 73.90it/s] 25%|██▌       | 909/3600 [00:10<00:38, 69.32it/s] 25%|██▌       | 917/3600 [00:10<00:39, 67.61it/s] 26%|██▌       | 924/3600 [00:10<00:40, 66.00it/s] 26%|██▌       | 931/3600 [00:11<00:40, 66.40it/s] 26%|██▌       | 938/3600 [00:11<00:40, 64.99it/s] 26%|██▋       | 947/3600 [00:11<00:40, 66.22it/s] 26%|██▋       | 954/3600 [00:11<00:39, 66.91it/s] 27%|██▋       | 963/3600 [00:11<00:37, 70.51it/s] 27%|██▋       | 971/3600 [00:11<00:40, 65.66it/s] 27%|██▋       | 979/3600 [00:11<00:38, 68.84it/s] 27%|██▋       | 986/3600 [00:11<00:38, 68.63it/s] 28%|██▊       | 993/3600 [00:12<00:39, 65.75it/s] 28%|██▊       | 1000/3600 [00:12<00:39, 65.61it/s] 28%|██▊       | 1007/3600 [00:12<00:42, 60.95it/s] 28%|██▊       | 1014/3600 [00:12<00:40, 63.25it/s] 28%|██▊       | 1021/3600 [00:12<00:41, 62.22it/s] 29%|██▊       | 1028/3600 [00:12<00:41, 62.38it/s] 29%|██▉       | 1035/3600 [00:12<00:41, 61.14it/s] 29%|██▉       | 1044/3600 [00:12<00:37, 67.72it/s] 29%|██▉       | 1052/3600 [00:12<00:37, 68.58it/s] 29%|██▉       | 1059/3600 [00:13<00:40, 62.64it/s] 30%|██▉       | 1067/3600 [00:13<00:37, 67.19it/s] 30%|██▉       | 1075/3600 [00:13<00:37, 67.97it/s] 30%|███       | 1082/3600 [00:13<00:37, 67.20it/s] 30%|███       | 1091/3600 [00:13<00:34, 72.34it/s] 31%|███       | 1100/3600 [00:13<00:32, 76.70it/s] 31%|███       | 1108/3600 [00:13<00:34, 71.54it/s] 31%|███       | 1116/3600 [00:13<00:34, 71.57it/s] 31%|███       | 1124/3600 [00:13<00:33, 73.27it/s] 31%|███▏      | 1132/3600 [00:14<00:33, 74.60it/s] 32%|███▏      | 1140/3600 [00:14<00:37, 65.47it/s] 32%|███▏      | 1149/3600 [00:14<00:35, 69.96it/s] 32%|███▏      | 1157/3600 [00:14<00:34, 71.66it/s] 32%|███▏      | 1165/3600 [00:14<00:34, 70.90it/s] 33%|███▎      | 1174/3600 [00:14<00:33, 71.68it/s] 33%|███▎      | 1182/3600 [00:14<00:32, 73.33it/s] 33%|███▎      | 1190/3600 [00:14<00:33, 71.34it/s] 33%|███▎      | 1199/3600 [00:14<00:32, 74.71it/s] 34%|███▎      | 1207/3600 [00:15<00:33, 72.24it/s] 34%|███▍      | 1216/3600 [00:15<00:31, 76.29it/s] 34%|███▍      | 1224/3600 [00:15<00:31, 76.01it/s] 34%|███▍      | 1232/3600 [00:15<00:32, 73.18it/s] 34%|███▍      | 1240/3600 [00:15<00:31, 74.14it/s] 35%|███▍      | 1249/3600 [00:15<00:30, 76.87it/s] 35%|███▍      | 1257/3600 [00:15<00:31, 74.61it/s] 35%|███▌      | 1266/3600 [00:15<00:29, 78.05it/s] 35%|███▌      | 1274/3600 [00:15<00:30, 76.74it/s] 36%|███▌      | 1282/3600 [00:16<00:30, 77.26it/s] 36%|███▌      | 1290/3600 [00:16<00:30, 76.98it/s] 36%|███▌      | 1298/3600 [00:16<00:30, 76.20it/s] 36%|███▋      | 1306/3600 [00:16<00:30, 76.04it/s] 36%|███▋      | 1314/3600 [00:16<00:29, 76.26it/s] 37%|███▋      | 1322/3600 [00:16<00:29, 76.12it/s] 37%|███▋      | 1330/3600 [00:16<00:29, 76.33it/s] 37%|███▋      | 1338/3600 [00:16<00:30, 74.03it/s] 37%|███▋      | 1347/3600 [00:16<00:29, 77.62it/s] 38%|███▊      | 1355/3600 [00:17<00:28, 77.54it/s] 38%|███▊      | 1363/3600 [00:17<00:29, 74.77it/s] 38%|███▊      | 1372/3600 [00:17<00:29, 74.71it/s] 38%|███▊      | 1380/3600 [00:17<00:29, 75.28it/s] 39%|███▊      | 1389/3600 [00:17<00:29, 76.08it/s] 39%|███▉      | 1398/3600 [00:17<00:27, 78.65it/s] 39%|███▉      | 1406/3600 [00:17<00:29, 75.50it/s] 39%|███▉      | 1414/3600 [00:17<00:29, 74.98it/s] 40%|███▉      | 1423/3600 [00:17<00:29, 74.31it/s] 40%|███▉      | 1432/3600 [00:18<00:27, 77.74it/s] 40%|████      | 1440/3600 [00:18<00:28, 75.04it/s] 40%|████      | 1449/3600 [00:18<00:27, 77.26it/s] 40%|████      | 1457/3600 [00:18<00:28, 75.02it/s] 41%|████      | 1465/3600 [00:18<00:28, 76.08it/s] 41%|████      | 1473/3600 [00:18<00:28, 75.88it/s] 41%|████      | 1482/3600 [00:18<00:26, 79.11it/s] 41%|████▏     | 1490/3600 [00:18<00:26, 78.67it/s] 42%|████▏     | 1498/3600 [00:18<00:27, 77.63it/s] 42%|████▏     | 1506/3600 [00:19<00:27, 75.74it/s] 42%|████▏     | 1514/3600 [00:19<00:29, 71.01it/s] 42%|████▏     | 1522/3600 [00:19<00:29, 69.40it/s] 42%|████▏     | 1529/3600 [00:19<00:30, 67.52it/s] 43%|████▎     | 1536/3600 [00:19<00:30, 66.60it/s] 43%|████▎     | 1543/3600 [00:19<00:31, 65.92it/s] 43%|████▎     | 1550/3600 [00:19<00:31, 66.08it/s] 43%|████▎     | 1557/3600 [00:19<00:31, 65.76it/s] 44%|████▎     | 1566/3600 [00:19<00:28, 71.54it/s] 44%|████▎     | 1574/3600 [00:20<00:27, 73.03it/s] 44%|████▍     | 1582/3600 [00:20<00:26, 74.94it/s] 44%|████▍     | 1590/3600 [00:20<00:26, 75.58it/s] 44%|████▍     | 1598/3600 [00:20<00:27, 72.66it/s] 45%|████▍     | 1607/3600 [00:20<00:26, 76.46it/s] 45%|████▍     | 1616/3600 [00:20<00:25, 79.06it/s] 45%|████▌     | 1624/3600 [00:20<00:25, 78.39it/s] 45%|████▌     | 1632/3600 [00:20<00:25, 78.26it/s] 46%|████▌     | 1640/3600 [00:20<00:25, 77.23it/s] 46%|████▌     | 1648/3600 [00:20<00:25, 76.67it/s] 46%|████▌     | 1656/3600 [00:21<00:25, 76.32it/s] 46%|████▌     | 1664/3600 [00:21<00:26, 73.80it/s] 46%|████▋     | 1672/3600 [00:21<00:26, 73.73it/s] 47%|████▋     | 1681/3600 [00:21<00:24, 76.98it/s] 47%|████▋     | 1689/3600 [00:21<00:24, 77.18it/s] 47%|████▋     | 1697/3600 [00:21<00:24, 76.56it/s] 47%|████▋     | 1705/3600 [00:21<00:25, 73.31it/s] 48%|████▊     | 1713/3600 [00:21<00:25, 73.38it/s] 48%|████▊     | 1721/3600 [00:21<00:25, 73.49it/s] 48%|████▊     | 1730/3600 [00:22<00:25, 74.47it/s] 48%|████▊     | 1739/3600 [00:22<00:23, 78.01it/s] 49%|████▊     | 1747/3600 [00:22<00:23, 77.30it/s] 49%|████▉     | 1755/3600 [00:22<00:23, 77.27it/s] 49%|████▉     | 1763/3600 [00:22<00:23, 77.11it/s] 49%|████▉     | 1771/3600 [00:22<00:23, 76.83it/s] 49%|████▉     | 1779/3600 [00:22<00:23, 76.97it/s] 50%|████▉     | 1787/3600 [00:22<00:23, 76.74it/s] 50%|████▉     | 1795/3600 [00:22<00:23, 76.53it/s] 50%|█████     | 1803/3600 [00:23<00:23, 76.40it/s] 50%|█████     | 1811/3600 [00:23<00:24, 73.55it/s] 51%|█████     | 1819/3600 [00:23<00:24, 73.99it/s] 51%|█████     | 1828/3600 [00:23<00:24, 73.70it/s] 51%|█████     | 1836/3600 [00:23<00:23, 74.21it/s] 51%|█████     | 1844/3600 [00:23<00:24, 71.64it/s] 51%|█████▏    | 1852/3600 [00:23<00:23, 73.16it/s] 52%|█████▏    | 1861/3600 [00:23<00:22, 75.89it/s] 52%|█████▏    | 1869/3600 [00:23<00:23, 72.40it/s] 52%|█████▏    | 1877/3600 [00:24<00:23, 72.85it/s] 52%|█████▏    | 1887/3600 [00:24<00:22, 76.35it/s] 53%|█████▎    | 1896/3600 [00:24<00:22, 76.52it/s] 53%|█████▎    | 1905/3600 [00:24<00:21, 78.85it/s] 53%|█████▎    | 1913/3600 [00:24<00:21, 78.45it/s] 53%|█████▎    | 1922/3600 [00:24<00:20, 81.39it/s] 54%|█████▎    | 1932/3600 [00:24<00:20, 82.91it/s] 54%|█████▍    | 1941/3600 [00:24<00:19, 83.10it/s] 54%|█████▍    | 1950/3600 [00:24<00:20, 81.62it/s] 54%|█████▍    | 1960/3600 [00:25<00:18, 86.41it/s] 55%|█████▍    | 1969/3600 [00:25<00:19, 85.27it/s] 55%|█████▍    | 1978/3600 [00:25<00:19, 83.42it/s] 55%|█████▌    | 1987/3600 [00:25<00:19, 84.53it/s] 55%|█████▌    | 1996/3600 [00:25<00:19, 83.63it/s] 56%|█████▌    | 2005/3600 [00:25<00:19, 80.92it/s] 56%|█████▌    | 2014/3600 [00:25<00:19, 79.67it/s] 56%|█████▌    | 2024/3600 [00:25<00:18, 83.60it/s] 56%|█████▋    | 2033/3600 [00:25<00:18, 84.45it/s] 57%|█████▋    | 2042/3600 [00:26<00:18, 84.66it/s] 57%|█████▋    | 2051/3600 [00:26<00:18, 83.03it/s] 57%|█████▋    | 2060/3600 [00:26<00:18, 84.76it/s] 57%|█████▋    | 2069/3600 [00:26<00:18, 81.59it/s] 58%|█████▊    | 2078/3600 [00:26<00:18, 83.78it/s] 58%|█████▊    | 2088/3600 [00:26<00:18, 83.26it/s] 58%|█████▊    | 2097/3600 [00:26<00:17, 84.89it/s] 58%|█████▊    | 2106/3600 [00:26<00:17, 84.73it/s] 59%|█████▉    | 2115/3600 [00:26<00:17, 82.82it/s] 59%|█████▉    | 2124/3600 [00:26<00:17, 84.76it/s] 59%|█████▉    | 2133/3600 [00:27<00:17, 85.19it/s] 60%|█████▉    | 2142/3600 [00:27<00:17, 82.50it/s] 60%|█████▉    | 2151/3600 [00:27<00:17, 81.31it/s] 60%|██████    | 2161/3600 [00:27<00:17, 83.91it/s] 60%|██████    | 2171/3600 [00:27<00:17, 83.84it/s] 61%|██████    | 2180/3600 [00:27<00:16, 84.85it/s] 61%|██████    | 2190/3600 [00:27<00:16, 83.52it/s] 61%|██████    | 2201/3600 [00:27<00:15, 88.08it/s] 61%|██████▏   | 2210/3600 [00:28<00:16, 86.52it/s] 62%|██████▏   | 2219/3600 [00:28<00:15, 86.86it/s] 62%|██████▏   | 2229/3600 [00:28<00:15, 86.41it/s] 62%|██████▏   | 2238/3600 [00:28<00:15, 86.06it/s] 62%|██████▏   | 2247/3600 [00:28<00:16, 81.55it/s] 63%|██████▎   | 2256/3600 [00:28<00:16, 80.09it/s] 63%|██████▎   | 2265/3600 [00:28<00:17, 76.04it/s] 63%|██████▎   | 2273/3600 [00:28<00:18, 71.02it/s] 63%|██████▎   | 2282/3600 [00:28<00:17, 74.98it/s] 64%|██████▎   | 2290/3600 [00:29<00:18, 71.94it/s] 64%|██████▍   | 2298/3600 [00:29<00:17, 73.41it/s] 64%|██████▍   | 2306/3600 [00:29<00:17, 74.61it/s] 64%|██████▍   | 2314/3600 [00:29<00:18, 71.20it/s] 64%|██████▍   | 2322/3600 [00:29<00:17, 72.47it/s] 65%|██████▍   | 2331/3600 [00:29<00:16, 77.17it/s] 65%|██████▍   | 2339/3600 [00:29<00:16, 75.15it/s] 65%|██████▌   | 2347/3600 [00:29<00:16, 76.00it/s] 65%|██████▌   | 2356/3600 [00:29<00:16, 77.61it/s] 66%|██████▌   | 2365/3600 [00:30<00:15, 78.67it/s] 66%|██████▌   | 2374/3600 [00:30<00:15, 77.63it/s] 66%|██████▌   | 2384/3600 [00:30<00:15, 79.72it/s] 66%|██████▋   | 2394/3600 [00:30<00:14, 82.77it/s] 67%|██████▋   | 2404/3600 [00:30<00:14, 83.20it/s] 67%|██████▋   | 2413/3600 [00:30<00:13, 85.04it/s] 67%|██████▋   | 2423/3600 [00:30<00:13, 86.49it/s] 68%|██████▊   | 2432/3600 [00:30<00:13, 86.16it/s] 68%|██████▊   | 2441/3600 [00:30<00:13, 83.83it/s] 68%|██████▊   | 2450/3600 [00:31<00:13, 85.11it/s] 68%|██████▊   | 2459/3600 [00:31<00:13, 82.88it/s] 69%|██████▊   | 2469/3600 [00:31<00:13, 84.71it/s] 69%|██████▉   | 2479/3600 [00:31<00:13, 84.31it/s] 69%|██████▉   | 2488/3600 [00:31<00:12, 85.67it/s] 69%|██████▉   | 2498/3600 [00:31<00:12, 87.79it/s] 70%|██████▉   | 2507/3600 [00:31<00:12, 87.44it/s] 70%|██████▉   | 2516/3600 [00:31<00:13, 78.91it/s] 70%|███████   | 2528/3600 [00:31<00:12, 84.27it/s] 70%|███████   | 2537/3600 [00:32<00:12, 83.49it/s] 71%|███████   | 2546/3600 [00:32<00:12, 82.27it/s] 71%|███████   | 2556/3600 [00:32<00:12, 85.79it/s] 71%|███████▏  | 2565/3600 [00:32<00:12, 82.19it/s] 72%|███████▏  | 2575/3600 [00:32<00:12, 83.24it/s] 72%|███████▏  | 2584/3600 [00:32<00:12, 83.54it/s] 72%|███████▏  | 2593/3600 [00:32<00:12, 81.62it/s] 72%|███████▏  | 2603/3600 [00:32<00:11, 85.30it/s] 73%|███████▎  | 2612/3600 [00:32<00:11, 84.67it/s] 73%|███████▎  | 2621/3600 [00:33<00:11, 83.24it/s] 73%|███████▎  | 2631/3600 [00:33<00:11, 85.83it/s] 73%|███████▎  | 2640/3600 [00:33<00:12, 79.64it/s] 74%|███████▎  | 2651/3600 [00:33<00:11, 85.92it/s] 74%|███████▍  | 2660/3600 [00:33<00:11, 82.94it/s] 74%|███████▍  | 2669/3600 [00:33<00:11, 82.33it/s] 74%|███████▍  | 2680/3600 [00:33<00:10, 87.40it/s] 75%|███████▍  | 2689/3600 [00:33<00:10, 85.34it/s] 75%|███████▍  | 2699/3600 [00:34<00:10, 86.90it/s] 75%|███████▌  | 2708/3600 [00:34<00:10, 86.87it/s] 75%|███████▌  | 2717/3600 [00:34<00:10, 83.70it/s] 76%|███████▌  | 2727/3600 [00:34<00:10, 82.77it/s] 76%|███████▌  | 2736/3600 [00:34<00:10, 83.83it/s] 76%|███████▋  | 2746/3600 [00:34<00:09, 86.50it/s] 77%|███████▋  | 2755/3600 [00:34<00:10, 80.90it/s] 77%|███████▋  | 2766/3600 [00:34<00:09, 85.04it/s] 77%|███████▋  | 2776/3600 [00:34<00:09, 87.18it/s] 77%|███████▋  | 2785/3600 [00:35<00:09, 84.04it/s] 78%|███████▊  | 2794/3600 [00:35<00:09, 80.69it/s] 78%|███████▊  | 2803/3600 [00:35<00:10, 77.31it/s] 78%|███████▊  | 2811/3600 [00:35<00:10, 77.05it/s] 78%|███████▊  | 2821/3600 [00:35<00:09, 78.23it/s] 79%|███████▊  | 2830/3600 [00:35<00:09, 77.98it/s] 79%|███████▉  | 2841/3600 [00:35<00:09, 83.01it/s] 79%|███████▉  | 2850/3600 [00:35<00:09, 82.68it/s] 79%|███████▉  | 2859/3600 [00:35<00:08, 83.06it/s] 80%|███████▉  | 2869/3600 [00:36<00:08, 86.28it/s] 80%|███████▉  | 2878/3600 [00:36<00:08, 84.72it/s] 80%|████████  | 2887/3600 [00:36<00:08, 85.89it/s] 80%|████████  | 2896/3600 [00:36<00:08, 84.81it/s] 81%|████████  | 2905/3600 [00:36<00:08, 82.19it/s] 81%|████████  | 2914/3600 [00:36<00:08, 83.02it/s] 81%|████████  | 2923/3600 [00:36<00:08, 84.44it/s] 81%|████████▏ | 2932/3600 [00:36<00:07, 85.01it/s] 82%|████████▏ | 2941/3600 [00:36<00:07, 84.81it/s] 82%|████████▏ | 2950/3600 [00:37<00:08, 81.10it/s] 82%|████████▏ | 2960/3600 [00:37<00:07, 84.03it/s] 82%|████████▏ | 2969/3600 [00:37<00:07, 84.46it/s] 83%|████████▎ | 2979/3600 [00:37<00:07, 84.40it/s] 83%|████████▎ | 2988/3600 [00:37<00:07, 85.58it/s] 83%|████████▎ | 2998/3600 [00:37<00:07, 84.09it/s] 84%|████████▎ | 3008/3600 [00:37<00:06, 87.61it/s] 84%|████████▍ | 3017/3600 [00:37<00:06, 87.96it/s] 84%|████████▍ | 3026/3600 [00:37<00:06, 82.36it/s] 84%|████████▍ | 3035/3600 [00:38<00:06, 81.30it/s] 85%|████████▍ | 3046/3600 [00:38<00:06, 86.60it/s] 85%|████████▍ | 3055/3600 [00:38<00:06, 83.23it/s] 85%|████████▌ | 3064/3600 [00:38<00:06, 84.35it/s] 85%|████████▌ | 3073/3600 [00:38<00:06, 83.07it/s] 86%|████████▌ | 3082/3600 [00:38<00:06, 83.89it/s] 86%|████████▌ | 3091/3600 [00:38<00:06, 78.39it/s] 86%|████████▌ | 3100/3600 [00:38<00:06, 79.77it/s] 86%|████████▋ | 3109/3600 [00:38<00:06, 78.05it/s] 87%|████████▋ | 3117/3600 [00:39<00:06, 75.64it/s] 87%|████████▋ | 3125/3600 [00:39<00:06, 72.18it/s] 87%|████████▋ | 3133/3600 [00:39<00:06, 74.22it/s] 87%|████████▋ | 3142/3600 [00:39<00:05, 76.55it/s] 88%|████████▊ | 3150/3600 [00:39<00:05, 77.28it/s] 88%|████████▊ | 3159/3600 [00:39<00:05, 74.73it/s] 88%|████████▊ | 3168/3600 [00:39<00:05, 76.74it/s] 88%|████████▊ | 3177/3600 [00:39<00:05, 76.22it/s] 88%|████████▊ | 3186/3600 [00:39<00:05, 78.91it/s] 89%|████████▉ | 3197/3600 [00:40<00:04, 83.51it/s] 89%|████████▉ | 3206/3600 [00:40<00:04, 82.43it/s] 89%|████████▉ | 3215/3600 [00:40<00:04, 83.48it/s] 90%|████████▉ | 3224/3600 [00:40<00:05, 73.11it/s] 90%|████████▉ | 3233/3600 [00:40<00:04, 76.58it/s] 90%|█████████ | 3244/3600 [00:40<00:04, 83.30it/s] 90%|█████████ | 3253/3600 [00:40<00:04, 82.04it/s] 91%|█████████ | 3263/3600 [00:40<00:03, 85.21it/s] 91%|█████████ | 3272/3600 [00:41<00:03, 86.03it/s] 91%|█████████ | 3281/3600 [00:41<00:03, 82.89it/s] 91%|█████████▏| 3290/3600 [00:41<00:03, 81.08it/s] 92%|█████████▏| 3299/3600 [00:41<00:03, 76.83it/s] 92%|█████████▏| 3307/3600 [00:41<00:03, 76.94it/s] 92%|█████████▏| 3316/3600 [00:41<00:03, 79.78it/s] 92%|█████████▏| 3325/3600 [00:41<00:03, 78.68it/s] 93%|█████████▎| 3333/3600 [00:41<00:03, 75.10it/s] 93%|█████████▎| 3341/3600 [00:41<00:03, 75.73it/s] 93%|█████████▎| 3350/3600 [00:42<00:03, 78.22it/s] 93%|█████████▎| 3358/3600 [00:42<00:03, 75.23it/s] 94%|█████████▎| 3366/3600 [00:42<00:03, 76.10it/s] 94%|█████████▍| 3375/3600 [00:42<00:02, 78.81it/s] 94%|█████████▍| 3383/3600 [00:42<00:02, 78.12it/s] 94%|█████████▍| 3391/3600 [00:42<00:02, 74.94it/s] 94%|█████████▍| 3400/3600 [00:42<00:02, 77.71it/s] 95%|█████████▍| 3408/3600 [00:42<00:02, 77.48it/s] 95%|█████████▍| 3416/3600 [00:42<00:02, 75.31it/s] 95%|█████████▌| 3424/3600 [00:43<00:02, 69.04it/s] 95%|█████████▌| 3432/3600 [00:43<00:02, 70.00it/s] 96%|█████████▌| 3440/3600 [00:43<00:02, 71.34it/s] 96%|█████████▌| 3450/3600 [00:43<00:01, 77.76it/s] 96%|█████████▌| 3458/3600 [00:43<00:01, 77.77it/s] 96%|█████████▋| 3468/3600 [00:43<00:01, 83.48it/s] 97%|█████████▋| 3477/3600 [00:43<00:01, 81.31it/s] 97%|█████████▋| 3487/3600 [00:43<00:01, 82.03it/s] 97%|█████████▋| 3498/3600 [00:43<00:01, 88.04it/s] 97%|█████████▋| 3507/3600 [00:44<00:01, 85.08it/s] 98%|█████████▊| 3517/3600 [00:44<00:00, 86.30it/s] 98%|█████████▊| 3527/3600 [00:44<00:00, 87.87it/s] 98%|█████████▊| 3536/3600 [00:44<00:00, 84.28it/s] 99%|█████████▊| 3547/3600 [00:44<00:00, 87.55it/s] 99%|█████████▉| 3556/3600 [00:44<00:00, 87.98it/s] 99%|█████████▉| 3566/3600 [00:44<00:00, 89.38it/s] 99%|█████████▉| 3575/3600 [00:44<00:00, 88.16it/s]100%|█████████▉| 3585/3600 [00:44<00:00, 89.51it/s]100%|█████████▉| 3595/3600 [00:45<00:00, 92.19it/s]100%|██████████| 3600/3600 [00:45<00:00, 79.90it/s]
Start Training...
Epoch 1 Step 1 Train Loss: 1.1773
Epoch 1 Step 51 Train Loss: 0.5959
Epoch 1 Step 101 Train Loss: 0.5748
Epoch 1 Step 151 Train Loss: 0.5676
Epoch 1 Step 201 Train Loss: 0.6389
Epoch 1 Step 251 Train Loss: 0.6484
Epoch 1 Step 301 Train Loss: 0.5496
Epoch 1 Step 351 Train Loss: 0.5684
Epoch 1 Step 401 Train Loss: 0.6882
Epoch 1 Step 451 Train Loss: 0.6173
Epoch 1 Step 501 Train Loss: 0.6614
Epoch 1: Train Overall MSE: 0.0024 Validation Overall MSE: 0.0040. 
Train Top 20 DE MSE: 0.0407 Validation Top 20 DE MSE: 0.2072. 
Epoch 2 Step 1 Train Loss: 0.5431
Epoch 2 Step 51 Train Loss: 0.6163
Epoch 2 Step 101 Train Loss: 0.4553
Epoch 2 Step 151 Train Loss: 0.6501
Epoch 2 Step 201 Train Loss: 0.5117
Epoch 2 Step 251 Train Loss: 0.6077
Epoch 2 Step 301 Train Loss: 0.5835
Epoch 2 Step 351 Train Loss: 0.5968
Epoch 2 Step 401 Train Loss: 0.4909
Epoch 2 Step 451 Train Loss: 0.6676
Epoch 2 Step 501 Train Loss: 0.5867
Epoch 2: Train Overall MSE: 0.0015 Validation Overall MSE: 0.0033. 
Train Top 20 DE MSE: 0.0274 Validation Top 20 DE MSE: 0.1728. 
Epoch 3 Step 1 Train Loss: 0.5593
Epoch 3 Step 51 Train Loss: 0.5878
Epoch 3 Step 101 Train Loss: 0.4955
Epoch 3 Step 151 Train Loss: 0.5970
Epoch 3 Step 201 Train Loss: 0.6395
Epoch 3 Step 251 Train Loss: 0.5599
Epoch 3 Step 301 Train Loss: 0.6144
Epoch 3 Step 351 Train Loss: 0.5861
Epoch 3 Step 401 Train Loss: 0.5588
Epoch 3 Step 451 Train Loss: 0.6219
Epoch 3 Step 501 Train Loss: 0.5731
Epoch 3: Train Overall MSE: 0.0011 Validation Overall MSE: 0.0028. 
Train Top 20 DE MSE: 0.0187 Validation Top 20 DE MSE: 0.1529. 
Epoch 4 Step 1 Train Loss: 0.6027
Epoch 4 Step 51 Train Loss: 0.5255
Epoch 4 Step 101 Train Loss: 0.5141
Epoch 4 Step 151 Train Loss: 0.6014
Epoch 4 Step 201 Train Loss: 0.6295
Epoch 4 Step 251 Train Loss: 0.5103
Epoch 4 Step 301 Train Loss: 0.5921
Epoch 4 Step 351 Train Loss: 0.5539
Epoch 4 Step 401 Train Loss: 0.5510
Epoch 4 Step 451 Train Loss: 0.5477
Epoch 4 Step 501 Train Loss: 0.5221
Epoch 4: Train Overall MSE: 0.0010 Validation Overall MSE: 0.0014. 
Train Top 20 DE MSE: 0.0107 Validation Top 20 DE MSE: 0.0667. 
Epoch 5 Step 1 Train Loss: 0.6021
Epoch 5 Step 51 Train Loss: 0.6189
Epoch 5 Step 101 Train Loss: 0.5209
Epoch 5 Step 151 Train Loss: 0.4798
Epoch 5 Step 201 Train Loss: 0.6261
Epoch 5 Step 251 Train Loss: 0.5174
Epoch 5 Step 301 Train Loss: 0.6734
Epoch 5 Step 351 Train Loss: 0.5953
Epoch 5 Step 401 Train Loss: 0.5970
Epoch 5 Step 451 Train Loss: 0.5792
Epoch 5 Step 501 Train Loss: 0.5426
Epoch 5: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0021. 
Train Top 20 DE MSE: 0.0092 Validation Top 20 DE MSE: 0.1136. 
Epoch 6 Step 1 Train Loss: 0.5497
Epoch 6 Step 51 Train Loss: 0.5589
Epoch 6 Step 101 Train Loss: 0.5502
Epoch 6 Step 151 Train Loss: 0.6642
Epoch 6 Step 201 Train Loss: 0.5797
Epoch 6 Step 251 Train Loss: 0.5233
Epoch 6 Step 301 Train Loss: 0.4981
Epoch 6 Step 351 Train Loss: 0.5568
Epoch 6 Step 401 Train Loss: 0.6629
Epoch 6 Step 451 Train Loss: 0.4591
Epoch 6 Step 501 Train Loss: 0.4889
Epoch 6: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0021. 
Train Top 20 DE MSE: 0.0076 Validation Top 20 DE MSE: 0.1119. 
Epoch 7 Step 1 Train Loss: 0.6679
Epoch 7 Step 51 Train Loss: 0.5407
Epoch 7 Step 101 Train Loss: 0.5144
Epoch 7 Step 151 Train Loss: 0.5098
Epoch 7 Step 201 Train Loss: 0.4854
Epoch 7 Step 251 Train Loss: 0.5660
Epoch 7 Step 301 Train Loss: 0.5367
Epoch 7 Step 351 Train Loss: 0.5084
Epoch 7 Step 401 Train Loss: 0.5369
Epoch 7 Step 451 Train Loss: 0.6973
Epoch 7 Step 501 Train Loss: 0.6127
Epoch 7: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0019. 
Train Top 20 DE MSE: 0.0073 Validation Top 20 DE MSE: 0.0979. 
Epoch 8 Step 1 Train Loss: 0.5457
Epoch 8 Step 51 Train Loss: 0.5766
Epoch 8 Step 101 Train Loss: 0.5654
Epoch 8 Step 151 Train Loss: 0.5487
Epoch 8 Step 201 Train Loss: 0.5081
Epoch 8 Step 251 Train Loss: 0.5743
Epoch 8 Step 301 Train Loss: 0.4924
Epoch 8 Step 351 Train Loss: 0.5284
Epoch 8 Step 401 Train Loss: 0.6167
Epoch 8 Step 451 Train Loss: 0.5527
Epoch 8 Step 501 Train Loss: 0.6169
Epoch 8: Train Overall MSE: 0.0010 Validation Overall MSE: 0.0017. 
Train Top 20 DE MSE: 0.0071 Validation Top 20 DE MSE: 0.0893. 
Epoch 9 Step 1 Train Loss: 0.5181
Epoch 9 Step 51 Train Loss: 0.5324
Epoch 9 Step 101 Train Loss: 0.5899
Epoch 9 Step 151 Train Loss: 0.6576
Epoch 9 Step 201 Train Loss: 0.6729
Epoch 9 Step 251 Train Loss: 0.6894
Epoch 9 Step 301 Train Loss: 0.5556
Epoch 9 Step 351 Train Loss: 0.5874
Epoch 9 Step 401 Train Loss: 0.6154
Epoch 9 Step 451 Train Loss: 0.5641
Epoch 9 Step 501 Train Loss: 0.5776
Epoch 9: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0016. 
Train Top 20 DE MSE: 0.0074 Validation Top 20 DE MSE: 0.0826. 
Epoch 10 Step 1 Train Loss: 0.6108
Epoch 10 Step 51 Train Loss: 0.5853
Epoch 10 Step 101 Train Loss: 0.5047
Epoch 10 Step 151 Train Loss: 0.5341
Epoch 10 Step 201 Train Loss: 0.5372
Epoch 10 Step 251 Train Loss: 0.5608
Epoch 10 Step 301 Train Loss: 0.5014
Epoch 10 Step 351 Train Loss: 0.6774
Epoch 10 Step 401 Train Loss: 0.5222
Epoch 10 Step 451 Train Loss: 0.7844
Epoch 10 Step 501 Train Loss: 0.5486
Epoch 10: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0021. 
Train Top 20 DE MSE: 0.0078 Validation Top 20 DE MSE: 0.1097. 
Epoch 11 Step 1 Train Loss: 0.5142
Epoch 11 Step 51 Train Loss: 0.5425
Epoch 11 Step 101 Train Loss: 0.5303
Epoch 11 Step 151 Train Loss: 0.5392
Epoch 11 Step 201 Train Loss: 0.4776
Epoch 11 Step 251 Train Loss: 0.7135
Epoch 11 Step 301 Train Loss: 0.5358
Epoch 11 Step 351 Train Loss: 0.5060
Epoch 11 Step 401 Train Loss: 0.6096
Epoch 11 Step 451 Train Loss: 0.6145
Epoch 11 Step 501 Train Loss: 0.5272
Epoch 11: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0017. 
Train Top 20 DE MSE: 0.0072 Validation Top 20 DE MSE: 0.0903. 
Epoch 12 Step 1 Train Loss: 0.5195
Epoch 12 Step 51 Train Loss: 0.5830
Epoch 12 Step 101 Train Loss: 0.4847
Epoch 12 Step 151 Train Loss: 0.5710
Epoch 12 Step 201 Train Loss: 0.5124
Epoch 12 Step 251 Train Loss: 0.5517
Epoch 12 Step 301 Train Loss: 0.5449
Epoch 12 Step 351 Train Loss: 0.5966
Epoch 12 Step 401 Train Loss: 0.5591
Epoch 12 Step 451 Train Loss: 0.5839
Epoch 12 Step 501 Train Loss: 0.5938
Epoch 12: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0019. 
Train Top 20 DE MSE: 0.0077 Validation Top 20 DE MSE: 0.1004. 
Epoch 13 Step 1 Train Loss: 0.4916
Epoch 13 Step 51 Train Loss: 0.5778
Epoch 13 Step 101 Train Loss: 0.5527
Epoch 13 Step 151 Train Loss: 0.5087
Epoch 13 Step 201 Train Loss: 0.5940
Epoch 13 Step 251 Train Loss: 0.5906
Epoch 13 Step 301 Train Loss: 0.5691
Epoch 13 Step 351 Train Loss: 0.6366
Epoch 13 Step 401 Train Loss: 0.5266
Epoch 13 Step 451 Train Loss: 0.5322
Epoch 13 Step 501 Train Loss: 0.6092
Epoch 13: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0024. 
Train Top 20 DE MSE: 0.0080 Validation Top 20 DE MSE: 0.1296. 
Epoch 14 Step 1 Train Loss: 0.5440
Epoch 14 Step 51 Train Loss: 0.4691
Epoch 14 Step 101 Train Loss: 0.5964
Epoch 14 Step 151 Train Loss: 0.5075
Epoch 14 Step 201 Train Loss: 0.6504
Epoch 14 Step 251 Train Loss: 0.5543
Epoch 14 Step 301 Train Loss: 0.5076
Epoch 14 Step 351 Train Loss: 0.5760
Epoch 14 Step 401 Train Loss: 0.5341
Epoch 14 Step 451 Train Loss: 0.5633
Epoch 14 Step 501 Train Loss: 0.6164
Epoch 14: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0020. 
Train Top 20 DE MSE: 0.0077 Validation Top 20 DE MSE: 0.1052. 
Epoch 15 Step 1 Train Loss: 0.7267
Epoch 15 Step 51 Train Loss: 0.5623
Epoch 15 Step 101 Train Loss: 0.5383
Epoch 15 Step 151 Train Loss: 0.6089
Epoch 15 Step 201 Train Loss: 0.5780
Epoch 15 Step 251 Train Loss: 0.5566
Epoch 15 Step 301 Train Loss: 0.5898
Epoch 15 Step 351 Train Loss: 0.6566
Epoch 15 Step 401 Train Loss: 0.6430
Epoch 15 Step 451 Train Loss: 0.5137
Epoch 15 Step 501 Train Loss: 0.5195
Epoch 15: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0018. 
Train Top 20 DE MSE: 0.0073 Validation Top 20 DE MSE: 0.0932. 
Done!
Start Testing...
Best performing model: Test Top 20 DE MSE: 0.0439
Start doing subgroup analysis for simulation split...
test_combo_seen0_mse: nan
test_combo_seen0_pearson: nan
test_combo_seen0_mse_de: nan
test_combo_seen0_pearson_de: nan
test_combo_seen1_mse: nan
test_combo_seen1_pearson: nan
test_combo_seen1_mse_de: nan
test_combo_seen1_pearson_de: nan
test_combo_seen2_mse: nan
test_combo_seen2_pearson: nan
test_combo_seen2_mse_de: nan
test_combo_seen2_pearson_de: nan
test_unseen_single_mse: 0.0010486147
test_unseen_single_pearson: 0.9981319966528548
test_unseen_single_mse_de: 0.043930456
test_unseen_single_pearson_de: 0.9887298700321424
test_combo_seen0_pearson_delta: nan
test_combo_seen0_frac_opposite_direction_top20_non_dropout: nan
test_combo_seen0_frac_sigma_below_1_non_dropout: nan
test_combo_seen0_mse_top20_de_non_dropout: nan
test_combo_seen1_pearson_delta: nan
test_combo_seen1_frac_opposite_direction_top20_non_dropout: nan
test_combo_seen1_frac_sigma_below_1_non_dropout: nan
test_combo_seen1_mse_top20_de_non_dropout: nan
test_combo_seen2_pearson_delta: nan
test_combo_seen2_frac_opposite_direction_top20_non_dropout: nan
test_combo_seen2_frac_sigma_below_1_non_dropout: nan
test_combo_seen2_mse_top20_de_non_dropout: nan
test_unseen_single_pearson_delta: 0.8476233733538886
test_unseen_single_frac_opposite_direction_top20_non_dropout: 0.0
test_unseen_single_frac_sigma_below_1_non_dropout: 0.9583333333333334
test_unseen_single_mse_top20_de_non_dropout: 0.04454330974671544
Done!
Creating new splits....
Saving new splits at /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03final/dixit_combined/splits/dixit_combined_simulation_2_0.75.pkl
Simulation split test composition:
combo_seen0:0
combo_seen1:0
combo_seen2:0
unseen_single:6
Done!
Creating dataloaders....
Done!
Start Training...
Epoch 1 Step 1 Train Loss: 1.0983
Epoch 1 Step 51 Train Loss: 0.7550
Epoch 1 Step 101 Train Loss: 0.5590
Epoch 1 Step 151 Train Loss: 0.7706
Epoch 1 Step 201 Train Loss: 0.5652
Epoch 1 Step 251 Train Loss: 0.6083
Epoch 1 Step 301 Train Loss: 0.5305
Epoch 1 Step 351 Train Loss: 0.6331
Epoch 1 Step 401 Train Loss: 0.6374
Epoch 1 Step 451 Train Loss: 0.5892
Epoch 1: Train Overall MSE: 0.0038 Validation Overall MSE: 0.0033. 
Train Top 20 DE MSE: 0.0152 Validation Top 20 DE MSE: 0.1103. 
Epoch 2 Step 1 Train Loss: 0.6193
Epoch 2 Step 51 Train Loss: 0.6199
Epoch 2 Step 101 Train Loss: 0.5207
Epoch 2 Step 151 Train Loss: 0.5249
Epoch 2 Step 201 Train Loss: 0.6330
Epoch 2 Step 251 Train Loss: 0.6271
Epoch 2 Step 301 Train Loss: 0.6882
Epoch 2 Step 351 Train Loss: 0.6172
Epoch 2 Step 401 Train Loss: 0.5381
Epoch 2 Step 451 Train Loss: 0.4979
Epoch 2: Train Overall MSE: 0.0023 Validation Overall MSE: 0.0015. 
Train Top 20 DE MSE: 0.0209 Validation Top 20 DE MSE: 0.0442. 
Epoch 3 Step 1 Train Loss: 0.6557
Epoch 3 Step 51 Train Loss: 0.5689
Epoch 3 Step 101 Train Loss: 0.5692
Epoch 3 Step 151 Train Loss: 0.6209
Epoch 3 Step 201 Train Loss: 0.4805
Epoch 3 Step 251 Train Loss: 0.5622
Epoch 3 Step 301 Train Loss: 0.5752
Epoch 3 Step 351 Train Loss: 0.5507
Epoch 3 Step 401 Train Loss: 0.5678
Epoch 3 Step 451 Train Loss: 0.5871
Epoch 3: Train Overall MSE: 0.0016 Validation Overall MSE: 0.0012. 
Train Top 20 DE MSE: 0.0128 Validation Top 20 DE MSE: 0.0466. 
Epoch 4 Step 1 Train Loss: 0.5346
Epoch 4 Step 51 Train Loss: 0.5678
Epoch 4 Step 101 Train Loss: 0.5601
Epoch 4 Step 151 Train Loss: 0.5180
Epoch 4 Step 201 Train Loss: 0.5619
Epoch 4 Step 251 Train Loss: 0.6573
Epoch 4 Step 301 Train Loss: 0.5753
Epoch 4 Step 351 Train Loss: 0.5180
Epoch 4 Step 401 Train Loss: 0.5960
Epoch 4 Step 451 Train Loss: 0.5768
Epoch 4: Train Overall MSE: 0.0012 Validation Overall MSE: 0.0009. 
Train Top 20 DE MSE: 0.0118 Validation Top 20 DE MSE: 0.0254. 
Epoch 5 Step 1 Train Loss: 0.5557
Epoch 5 Step 51 Train Loss: 0.5228
Epoch 5 Step 101 Train Loss: 0.5285
Epoch 5 Step 151 Train Loss: 0.5111
Epoch 5 Step 201 Train Loss: 0.6437
Epoch 5 Step 251 Train Loss: 0.6473
Epoch 5 Step 301 Train Loss: 0.5304
Epoch 5 Step 351 Train Loss: 0.4994
Epoch 5 Step 401 Train Loss: 0.5295
Epoch 5 Step 451 Train Loss: 0.4977
Epoch 5: Train Overall MSE: 0.0012 Validation Overall MSE: 0.0013. 
Train Top 20 DE MSE: 0.0113 Validation Top 20 DE MSE: 0.0488. 
Epoch 6 Step 1 Train Loss: 0.5549
Epoch 6 Step 51 Train Loss: 0.4704
Epoch 6 Step 101 Train Loss: 0.5249
Epoch 6 Step 151 Train Loss: 0.5568
Epoch 6 Step 201 Train Loss: 0.5218
Epoch 6 Step 251 Train Loss: 0.5584
Epoch 6 Step 301 Train Loss: 0.5716
Epoch 6 Step 351 Train Loss: 0.5842
Epoch 6 Step 401 Train Loss: 0.5847
Epoch 6 Step 451 Train Loss: 0.5766
Epoch 6: Train Overall MSE: 0.0011 Validation Overall MSE: 0.0008. 
Train Top 20 DE MSE: 0.0085 Validation Top 20 DE MSE: 0.0166. 
Epoch 7 Step 1 Train Loss: 0.5387
Epoch 7 Step 51 Train Loss: 0.5579
Epoch 7 Step 101 Train Loss: 0.5402
Epoch 7 Step 151 Train Loss: 0.4635
Epoch 7 Step 201 Train Loss: 0.5975
Epoch 7 Step 251 Train Loss: 0.5629
Epoch 7 Step 301 Train Loss: 0.6213
Epoch 7 Step 351 Train Loss: 0.5093
Epoch 7 Step 401 Train Loss: 0.5750
Epoch 7 Step 451 Train Loss: 0.5679
Epoch 7: Train Overall MSE: 0.0011 Validation Overall MSE: 0.0009. 
Train Top 20 DE MSE: 0.0098 Validation Top 20 DE MSE: 0.0210. 
Epoch 8 Step 1 Train Loss: 0.5750
Epoch 8 Step 51 Train Loss: 0.5837
Epoch 8 Step 101 Train Loss: 0.5407
Epoch 8 Step 151 Train Loss: 0.5409
Epoch 8 Step 201 Train Loss: 0.5431
Epoch 8 Step 251 Train Loss: 0.5286
Epoch 8 Step 301 Train Loss: 0.5542
Epoch 8 Step 351 Train Loss: 0.5571
Epoch 8 Step 401 Train Loss: 0.5011
Epoch 8 Step 451 Train Loss: 0.5222
Epoch 8: Train Overall MSE: 0.0011 Validation Overall MSE: 0.0008. 
Train Top 20 DE MSE: 0.0091 Validation Top 20 DE MSE: 0.0139. 
Epoch 9 Step 1 Train Loss: 0.6244
Epoch 9 Step 51 Train Loss: 0.5936
Epoch 9 Step 101 Train Loss: 0.5451
Epoch 9 Step 151 Train Loss: 0.5760
Epoch 9 Step 201 Train Loss: 0.6040
Epoch 9 Step 251 Train Loss: 0.5213
Epoch 9 Step 301 Train Loss: 0.5861
Epoch 9 Step 351 Train Loss: 0.8222
Epoch 9 Step 401 Train Loss: 0.5153
Epoch 9 Step 451 Train Loss: 0.4859
Epoch 9: Train Overall MSE: 0.0011 Validation Overall MSE: 0.0009. 
Train Top 20 DE MSE: 0.0091 Validation Top 20 DE MSE: 0.0233. 
Epoch 10 Step 1 Train Loss: 0.5543
Epoch 10 Step 51 Train Loss: 0.5101
Epoch 10 Step 101 Train Loss: 0.6207
Epoch 10 Step 151 Train Loss: 0.5638
Epoch 10 Step 201 Train Loss: 0.5309
Epoch 10 Step 251 Train Loss: 0.6608
Epoch 10 Step 301 Train Loss: 0.6278
Epoch 10 Step 351 Train Loss: 0.4862
Epoch 10 Step 401 Train Loss: 0.6209
Epoch 10 Step 451 Train Loss: 0.6093
Epoch 10: Train Overall MSE: 0.0011 Validation Overall MSE: 0.0008. 
Train Top 20 DE MSE: 0.0102 Validation Top 20 DE MSE: 0.0200. 
Epoch 11 Step 1 Train Loss: 0.5253
Epoch 11 Step 51 Train Loss: 0.6388
Epoch 11 Step 101 Train Loss: 0.6037
Epoch 11 Step 151 Train Loss: 0.5331
Epoch 11 Step 201 Train Loss: 0.6025
Epoch 11 Step 251 Train Loss: 0.5566
Epoch 11 Step 301 Train Loss: 0.5473
Epoch 11 Step 351 Train Loss: 0.4617
Epoch 11 Step 401 Train Loss: 0.5629
Epoch 11 Step 451 Train Loss: 0.5701
Epoch 11: Train Overall MSE: 0.0011 Validation Overall MSE: 0.0013. 
Train Top 20 DE MSE: 0.0116 Validation Top 20 DE MSE: 0.0458. 
Epoch 12 Step 1 Train Loss: 0.4883
Epoch 12 Step 51 Train Loss: 0.6186
Epoch 12 Step 101 Train Loss: 0.5406
Epoch 12 Step 151 Train Loss: 0.6248
Epoch 12 Step 201 Train Loss: 0.5593
Epoch 12 Step 251 Train Loss: 0.5323
Epoch 12 Step 301 Train Loss: 0.5817
Epoch 12 Step 351 Train Loss: 0.6113
Epoch 12 Step 401 Train Loss: 0.4813
Epoch 12 Step 451 Train Loss: 0.5068
Epoch 12: Train Overall MSE: 0.0011 Validation Overall MSE: 0.0008. 
Train Top 20 DE MSE: 0.0094 Validation Top 20 DE MSE: 0.0140. 
Epoch 13 Step 1 Train Loss: 0.5716
Epoch 13 Step 51 Train Loss: 0.6004
Epoch 13 Step 101 Train Loss: 0.5030
Epoch 13 Step 151 Train Loss: 0.6189
Epoch 13 Step 201 Train Loss: 0.4726
Epoch 13 Step 251 Train Loss: 0.5435
Epoch 13 Step 301 Train Loss: 0.6010
Epoch 13 Step 351 Train Loss: 0.6527
Epoch 13 Step 401 Train Loss: 0.6136
Epoch 13 Step 451 Train Loss: 0.6317
Epoch 13: Train Overall MSE: 0.0011 Validation Overall MSE: 0.0008. 
Train Top 20 DE MSE: 0.0092 Validation Top 20 DE MSE: 0.0178. 
Epoch 14 Step 1 Train Loss: 0.5207
Epoch 14 Step 51 Train Loss: 0.5508
Epoch 14 Step 101 Train Loss: 0.5574
Epoch 14 Step 151 Train Loss: 0.5807
Epoch 14 Step 201 Train Loss: 0.5345
Epoch 14 Step 251 Train Loss: 0.5211
Epoch 14 Step 301 Train Loss: 0.5660
Epoch 14 Step 351 Train Loss: 0.5308
Epoch 14 Step 401 Train Loss: 0.6308
Epoch 14 Step 451 Train Loss: 0.5623
Epoch 14: Train Overall MSE: 0.0011 Validation Overall MSE: 0.0009. 
Train Top 20 DE MSE: 0.0088 Validation Top 20 DE MSE: 0.0255. 
Epoch 15 Step 1 Train Loss: 0.7504
Epoch 15 Step 51 Train Loss: 0.5500
Epoch 15 Step 101 Train Loss: 0.5136
Epoch 15 Step 151 Train Loss: 0.5278
Epoch 15 Step 201 Train Loss: 0.5066
Epoch 15 Step 251 Train Loss: 0.5843
Epoch 15 Step 301 Train Loss: 0.6186
Epoch 15 Step 351 Train Loss: 0.5166
Epoch 15 Step 401 Train Loss: 0.5907
Epoch 15 Step 451 Train Loss: 0.5634
Epoch 15: Train Overall MSE: 0.0011 Validation Overall MSE: 0.0008. 
Train Top 20 DE MSE: 0.0093 Validation Top 20 DE MSE: 0.0158. 
Done!
Start Testing...
Best performing model: Test Top 20 DE MSE: 0.0231
Start doing subgroup analysis for simulation split...
test_combo_seen0_mse: nan
test_combo_seen0_pearson: nan
test_combo_seen0_mse_de: nan
test_combo_seen0_pearson_de: nan
test_combo_seen1_mse: nan
test_combo_seen1_pearson: nan
test_combo_seen1_mse_de: nan
test_combo_seen1_pearson_de: nan
test_combo_seen2_mse: nan
test_combo_seen2_pearson: nan
test_combo_seen2_mse_de: nan
test_combo_seen2_pearson_de: nan
test_unseen_single_mse: 0.0008390372
test_unseen_single_pearson: 0.998484648589301
test_unseen_single_mse_de: 0.023102412
test_unseen_single_pearson_de: 0.9930979642060246
test_combo_seen0_pearson_delta: nan
test_combo_seen0_frac_opposite_direction_top20_non_dropout: nan
test_combo_seen0_frac_sigma_below_1_non_dropout: nan
test_combo_seen0_mse_top20_de_non_dropout: nan
test_combo_seen1_pearson_delta: nan
test_combo_seen1_frac_opposite_direction_top20_non_dropout: nan
test_combo_seen1_frac_sigma_below_1_non_dropout: nan
test_combo_seen1_mse_top20_de_non_dropout: nan
test_combo_seen2_pearson_delta: nan
test_combo_seen2_frac_opposite_direction_top20_non_dropout: nan
test_combo_seen2_frac_sigma_below_1_non_dropout: nan
test_combo_seen2_mse_top20_de_non_dropout: nan
test_unseen_single_pearson_delta: 0.7869769235279677
test_unseen_single_frac_opposite_direction_top20_non_dropout: 0.008333333333333333
test_unseen_single_frac_sigma_below_1_non_dropout: 0.9916666666666667
test_unseen_single_mse_top20_de_non_dropout: 0.023102411752461572
Done!
Creating new splits....
Saving new splits at /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03final/dixit_combined/splits/dixit_combined_simulation_3_0.75.pkl
Simulation split test composition:
combo_seen0:0
combo_seen1:0
combo_seen2:0
unseen_single:6
Done!
Creating dataloaders....
Done!
Start Training...
Epoch 1 Step 1 Train Loss: 1.9001
Epoch 1 Step 51 Train Loss: 0.7029
Epoch 1 Step 101 Train Loss: 0.7602
Epoch 1 Step 151 Train Loss: 0.5603
Epoch 1 Step 201 Train Loss: 0.6522
Epoch 1 Step 251 Train Loss: 0.7077
Epoch 1 Step 301 Train Loss: 0.6193
Epoch 1 Step 351 Train Loss: 0.4978
Epoch 1 Step 401 Train Loss: 0.6525
Epoch 1 Step 451 Train Loss: 0.5628
Epoch 1: Train Overall MSE: 0.0033 Validation Overall MSE: 0.0024. 
Train Top 20 DE MSE: 0.0475 Validation Top 20 DE MSE: 0.0328. 
Epoch 2 Step 1 Train Loss: 0.6980
Epoch 2 Step 51 Train Loss: 0.6186
Epoch 2 Step 101 Train Loss: 0.5993
Epoch 2 Step 151 Train Loss: 0.5084
Epoch 2 Step 201 Train Loss: 0.5652
Epoch 2 Step 251 Train Loss: 0.5071
Epoch 2 Step 301 Train Loss: 0.7005
Epoch 2 Step 351 Train Loss: 0.5130
Epoch 2 Step 401 Train Loss: 0.4893
Epoch 2 Step 451 Train Loss: 0.5220
Epoch 2: Train Overall MSE: 0.0019 Validation Overall MSE: 0.0010. 
Train Top 20 DE MSE: 0.0112 Validation Top 20 DE MSE: 0.0116. 
Epoch 3 Step 1 Train Loss: 0.5685
Epoch 3 Step 51 Train Loss: 0.7046
Epoch 3 Step 101 Train Loss: 0.5543
Epoch 3 Step 151 Train Loss: 0.6861
Epoch 3 Step 201 Train Loss: 0.5466
Epoch 3 Step 251 Train Loss: 0.5524
Epoch 3 Step 301 Train Loss: 0.5961
Epoch 3 Step 351 Train Loss: 0.5497
Epoch 3 Step 401 Train Loss: 0.5425
Epoch 3 Step 451 Train Loss: 0.5782
Epoch 3: Train Overall MSE: 0.0013 Validation Overall MSE: 0.0007. 
Train Top 20 DE MSE: 0.0162 Validation Top 20 DE MSE: 0.0098. 
Epoch 4 Step 1 Train Loss: 0.5581
Epoch 4 Step 51 Train Loss: 0.5956
Epoch 4 Step 101 Train Loss: 0.5544
Epoch 4 Step 151 Train Loss: 0.5669
Epoch 4 Step 201 Train Loss: 0.5225
Epoch 4 Step 251 Train Loss: 0.5422
Epoch 4 Step 301 Train Loss: 0.4120
Epoch 4 Step 351 Train Loss: 0.5601
Epoch 4 Step 401 Train Loss: 0.5000
Epoch 4 Step 451 Train Loss: 0.6368
Epoch 4: Train Overall MSE: 0.0011 Validation Overall MSE: 0.0006. 
Train Top 20 DE MSE: 0.0096 Validation Top 20 DE MSE: 0.0120. 
Epoch 5 Step 1 Train Loss: 0.7413
Epoch 5 Step 51 Train Loss: 0.4820
Epoch 5 Step 101 Train Loss: 0.6551
Epoch 5 Step 151 Train Loss: 0.4689
Epoch 5 Step 201 Train Loss: 0.5885
Epoch 5 Step 251 Train Loss: 0.5408
Epoch 5 Step 301 Train Loss: 0.4865
Epoch 5 Step 351 Train Loss: 0.5274
Epoch 5 Step 401 Train Loss: 0.5245
Epoch 5 Step 451 Train Loss: 0.4881
Epoch 5: Train Overall MSE: 0.0010 Validation Overall MSE: 0.0006. 
Train Top 20 DE MSE: 0.0080 Validation Top 20 DE MSE: 0.0120. 
Epoch 6 Step 1 Train Loss: 0.5388
Epoch 6 Step 51 Train Loss: 0.5362
Epoch 6 Step 101 Train Loss: 0.6058
Epoch 6 Step 151 Train Loss: 0.5517
Epoch 6 Step 201 Train Loss: 0.5130
Epoch 6 Step 251 Train Loss: 0.5653
Epoch 6 Step 301 Train Loss: 0.5660
Epoch 6 Step 351 Train Loss: 0.5695
Epoch 6 Step 401 Train Loss: 0.5621
Epoch 6 Step 451 Train Loss: 0.6205
Epoch 6: Train Overall MSE: 0.0010 Validation Overall MSE: 0.0006. 
Train Top 20 DE MSE: 0.0114 Validation Top 20 DE MSE: 0.0115. 
Epoch 7 Step 1 Train Loss: 0.6113
Epoch 7 Step 51 Train Loss: 0.5193
Epoch 7 Step 101 Train Loss: 0.5207
Epoch 7 Step 151 Train Loss: 0.6690
Epoch 7 Step 201 Train Loss: 0.5486
Epoch 7 Step 251 Train Loss: 0.6200
Epoch 7 Step 301 Train Loss: 0.4726
Epoch 7 Step 351 Train Loss: 0.5599
Epoch 7 Step 401 Train Loss: 0.4873
Epoch 7 Step 451 Train Loss: 0.5180
Epoch 7: Train Overall MSE: 0.0010 Validation Overall MSE: 0.0006. 
Train Top 20 DE MSE: 0.0076 Validation Top 20 DE MSE: 0.0114. 
Epoch 8 Step 1 Train Loss: 0.6532
Epoch 8 Step 51 Train Loss: 0.5045
Epoch 8 Step 101 Train Loss: 0.5382
Epoch 8 Step 151 Train Loss: 0.5352
Epoch 8 Step 201 Train Loss: 0.5249
Epoch 8 Step 251 Train Loss: 0.5654
Epoch 8 Step 301 Train Loss: 0.5011
Epoch 8 Step 351 Train Loss: 0.5340
Epoch 8 Step 401 Train Loss: 0.5285
Epoch 8 Step 451 Train Loss: 0.4852
Epoch 8: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0006. 
Train Top 20 DE MSE: 0.0092 Validation Top 20 DE MSE: 0.0133. 
Epoch 9 Step 1 Train Loss: 0.5956
Epoch 9 Step 51 Train Loss: 0.5846
Epoch 9 Step 101 Train Loss: 0.6026
Epoch 9 Step 151 Train Loss: 0.7195
Epoch 9 Step 201 Train Loss: 0.6342
Epoch 9 Step 251 Train Loss: 0.6853
Epoch 9 Step 301 Train Loss: 0.5758
Epoch 9 Step 351 Train Loss: 0.5565
Epoch 9 Step 401 Train Loss: 0.5207
Epoch 9 Step 451 Train Loss: 0.6324
Epoch 9: Train Overall MSE: 0.0010 Validation Overall MSE: 0.0006. 
Train Top 20 DE MSE: 0.0075 Validation Top 20 DE MSE: 0.0123. 
Epoch 10 Step 1 Train Loss: 0.5426
Epoch 10 Step 51 Train Loss: 0.6232
Epoch 10 Step 101 Train Loss: 0.6209
Epoch 10 Step 151 Train Loss: 0.6164
Epoch 10 Step 201 Train Loss: 0.5243
Epoch 10 Step 251 Train Loss: 0.5346
Epoch 10 Step 301 Train Loss: 0.5047
Epoch 10 Step 351 Train Loss: 0.5343
Epoch 10 Step 401 Train Loss: 0.4906
Epoch 10 Step 451 Train Loss: 0.5942
Epoch 10: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0006. 
Train Top 20 DE MSE: 0.0083 Validation Top 20 DE MSE: 0.0118. 
Epoch 11 Step 1 Train Loss: 0.5105
Epoch 11 Step 51 Train Loss: 0.6306
Epoch 11 Step 101 Train Loss: 0.5851
Epoch 11 Step 151 Train Loss: 0.5914
Epoch 11 Step 201 Train Loss: 0.5047
Epoch 11 Step 251 Train Loss: 0.6181
Epoch 11 Step 301 Train Loss: 0.5767
Epoch 11 Step 351 Train Loss: 0.6462
Epoch 11 Step 401 Train Loss: 0.6850
Epoch 11 Step 451 Train Loss: 0.6341
Epoch 11: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0006. 
Train Top 20 DE MSE: 0.0082 Validation Top 20 DE MSE: 0.0123. 
Epoch 12 Step 1 Train Loss: 0.5232
Epoch 12 Step 51 Train Loss: 0.6023
Epoch 12 Step 101 Train Loss: 0.6212
Epoch 12 Step 151 Train Loss: 0.6143
Epoch 12 Step 201 Train Loss: 0.5596
Epoch 12 Step 251 Train Loss: 0.4900
Epoch 12 Step 301 Train Loss: 0.6148
Epoch 12 Step 351 Train Loss: 0.4706
Epoch 12 Step 401 Train Loss: 0.5115
Epoch 12 Step 451 Train Loss: 0.5520
Epoch 12: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0006. 
Train Top 20 DE MSE: 0.0090 Validation Top 20 DE MSE: 0.0116. 
Epoch 13 Step 1 Train Loss: 0.5535
Epoch 13 Step 51 Train Loss: 0.4675
Epoch 13 Step 101 Train Loss: 0.5041
Epoch 13 Step 151 Train Loss: 0.5693
Epoch 13 Step 201 Train Loss: 0.5334
Epoch 13 Step 251 Train Loss: 0.5718
Epoch 13 Step 301 Train Loss: 0.6332
Epoch 13 Step 351 Train Loss: 0.5121
Epoch 13 Step 401 Train Loss: 0.5790
Epoch 13 Step 451 Train Loss: 0.5266
Epoch 13: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0006. 
Train Top 20 DE MSE: 0.0102 Validation Top 20 DE MSE: 0.0136. 
Epoch 14 Step 1 Train Loss: 0.5159
Epoch 14 Step 51 Train Loss: 0.6443
Epoch 14 Step 101 Train Loss: 0.6086
Epoch 14 Step 151 Train Loss: 0.5216
Epoch 14 Step 201 Train Loss: 0.5767
Epoch 14 Step 251 Train Loss: 0.6027
Epoch 14 Step 301 Train Loss: 0.6155
Epoch 14 Step 351 Train Loss: 0.5573
Epoch 14 Step 401 Train Loss: 0.5768
Epoch 14 Step 451 Train Loss: 0.5761
Epoch 14: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0006. 
Train Top 20 DE MSE: 0.0085 Validation Top 20 DE MSE: 0.0109. 
Epoch 15 Step 1 Train Loss: 0.6722
Epoch 15 Step 51 Train Loss: 0.6187
Epoch 15 Step 101 Train Loss: 0.4789
Epoch 15 Step 151 Train Loss: 0.6084
Epoch 15 Step 201 Train Loss: 0.5227
Epoch 15 Step 251 Train Loss: 0.7500
Epoch 15 Step 301 Train Loss: 0.5648
Epoch 15 Step 351 Train Loss: 0.5639
Epoch 15 Step 401 Train Loss: 0.5970
Epoch 15 Step 451 Train Loss: 0.6535
Epoch 15: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0006. 
Train Top 20 DE MSE: 0.0089 Validation Top 20 DE MSE: 0.0128. 
Done!
Start Testing...
Best performing model: Test Top 20 DE MSE: 0.0452
Start doing subgroup analysis for simulation split...
test_combo_seen0_mse: nan
test_combo_seen0_pearson: nan
test_combo_seen0_mse_de: nan
test_combo_seen0_pearson_de: nan
test_combo_seen1_mse: nan
test_combo_seen1_pearson: nan
test_combo_seen1_mse_de: nan
test_combo_seen1_pearson_de: nan
test_combo_seen2_mse: nan
test_combo_seen2_pearson: nan
test_combo_seen2_mse_de: nan
test_combo_seen2_pearson_de: nan
test_unseen_single_mse: 0.0013459381
test_unseen_single_pearson: 0.9976646096584965
test_unseen_single_mse_de: 0.045156013
test_unseen_single_pearson_de: 0.9877066432482858
test_combo_seen0_pearson_delta: nan
test_combo_seen0_frac_opposite_direction_top20_non_dropout: nan
test_combo_seen0_frac_sigma_below_1_non_dropout: nan
test_combo_seen0_mse_top20_de_non_dropout: nan
test_combo_seen1_pearson_delta: nan
test_combo_seen1_frac_opposite_direction_top20_non_dropout: nan
test_combo_seen1_frac_sigma_below_1_non_dropout: nan
test_combo_seen1_mse_top20_de_non_dropout: nan
test_combo_seen2_pearson_delta: nan
test_combo_seen2_frac_opposite_direction_top20_non_dropout: nan
test_combo_seen2_frac_sigma_below_1_non_dropout: nan
test_combo_seen2_mse_top20_de_non_dropout: nan
test_unseen_single_pearson_delta: 0.8138697648791265
test_unseen_single_frac_opposite_direction_top20_non_dropout: 0.0
test_unseen_single_frac_sigma_below_1_non_dropout: 0.9500000000000001
test_unseen_single_mse_top20_de_non_dropout: 0.04515600961039574
Done!
Creating new splits....
Saving new splits at /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03final/dixit_combined/splits/dixit_combined_simulation_4_0.75.pkl
Simulation split test composition:
combo_seen0:0
combo_seen1:0
combo_seen2:0
unseen_single:6
Done!
Creating dataloaders....
Done!
Start Training...
Epoch 1 Step 1 Train Loss: 1.6557
Epoch 1 Step 51 Train Loss: 0.7262
Epoch 1 Step 101 Train Loss: 0.5757
Epoch 1 Step 151 Train Loss: 0.5676
Epoch 1 Step 201 Train Loss: 0.6569
Epoch 1 Step 251 Train Loss: 0.6116
Epoch 1 Step 301 Train Loss: 0.5637
Epoch 1 Step 351 Train Loss: 0.5641
Epoch 1 Step 401 Train Loss: 0.6137
Epoch 1 Step 451 Train Loss: 0.5819
Epoch 1 Step 501 Train Loss: 0.6279
Epoch 1 Step 551 Train Loss: 0.5686
Epoch 1: Train Overall MSE: 0.0018 Validation Overall MSE: 0.0035. 
Train Top 20 DE MSE: 0.0254 Validation Top 20 DE MSE: 0.1638. 
Epoch 2 Step 1 Train Loss: 0.5376
Epoch 2 Step 51 Train Loss: 0.5631
Epoch 2 Step 101 Train Loss: 0.7595
Epoch 2 Step 151 Train Loss: 0.4902
Epoch 2 Step 201 Train Loss: 0.5604
Epoch 2 Step 251 Train Loss: 0.5731
Epoch 2 Step 301 Train Loss: 0.5361
Epoch 2 Step 351 Train Loss: 0.5633
Epoch 2 Step 401 Train Loss: 0.5840
Epoch 2 Step 451 Train Loss: 0.5720
Epoch 2 Step 501 Train Loss: 0.6553
Epoch 2 Step 551 Train Loss: 0.5278
Epoch 2: Train Overall MSE: 0.0013 Validation Overall MSE: 0.0041. 
Train Top 20 DE MSE: 0.0147 Validation Top 20 DE MSE: 0.1869. 
Epoch 3 Step 1 Train Loss: 0.6630
Epoch 3 Step 51 Train Loss: 0.5710
Epoch 3 Step 101 Train Loss: 0.5511
Epoch 3 Step 151 Train Loss: 0.4648
Epoch 3 Step 201 Train Loss: 0.6652
Epoch 3 Step 251 Train Loss: 0.5744
Epoch 3 Step 301 Train Loss: 0.5222
Epoch 3 Step 351 Train Loss: 0.6239
Epoch 3 Step 401 Train Loss: 0.5414
Epoch 3 Step 451 Train Loss: 0.4838
Epoch 3 Step 501 Train Loss: 0.5369
Epoch 3 Step 551 Train Loss: 0.5300
Epoch 3: Train Overall MSE: 0.0011 Validation Overall MSE: 0.0025. 
Train Top 20 DE MSE: 0.0148 Validation Top 20 DE MSE: 0.1279. 
Epoch 4 Step 1 Train Loss: 0.5727
Epoch 4 Step 51 Train Loss: 0.6082
Epoch 4 Step 101 Train Loss: 0.6399
Epoch 4 Step 151 Train Loss: 0.5847
Epoch 4 Step 201 Train Loss: 0.5880
Epoch 4 Step 251 Train Loss: 0.6062
Epoch 4 Step 301 Train Loss: 0.6903
Epoch 4 Step 351 Train Loss: 0.5424
Epoch 4 Step 401 Train Loss: 0.5676
Epoch 4 Step 451 Train Loss: 0.5420
Epoch 4 Step 501 Train Loss: 0.5146
Epoch 4 Step 551 Train Loss: 0.6002
Epoch 4: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0035. 
Train Top 20 DE MSE: 0.0116 Validation Top 20 DE MSE: 0.1820. 
Epoch 5 Step 1 Train Loss: 0.5348
Epoch 5 Step 51 Train Loss: 0.6046
Epoch 5 Step 101 Train Loss: 0.4945
Epoch 5 Step 151 Train Loss: 0.5054
Epoch 5 Step 201 Train Loss: 0.5639
Epoch 5 Step 251 Train Loss: 0.5131
Epoch 5 Step 301 Train Loss: 0.5189
Epoch 5 Step 351 Train Loss: 0.5169
Epoch 5 Step 401 Train Loss: 0.5104
Epoch 5 Step 451 Train Loss: 0.5758
Epoch 5 Step 501 Train Loss: 0.5534
Epoch 5 Step 551 Train Loss: 0.4792
Epoch 5: Train Overall MSE: 0.0008 Validation Overall MSE: 0.0033. 
Train Top 20 DE MSE: 0.0067 Validation Top 20 DE MSE: 0.1649. 
Epoch 6 Step 1 Train Loss: 0.5247
Epoch 6 Step 51 Train Loss: 0.7064
Epoch 6 Step 101 Train Loss: 0.5981
Epoch 6 Step 151 Train Loss: 0.5768
Epoch 6 Step 201 Train Loss: 0.5649
Epoch 6 Step 251 Train Loss: 0.5862
Epoch 6 Step 301 Train Loss: 0.5279
Epoch 6 Step 351 Train Loss: 0.5921
Epoch 6 Step 401 Train Loss: 0.6242
Epoch 6 Step 451 Train Loss: 0.5262
Epoch 6 Step 501 Train Loss: 0.5485
Epoch 6 Step 551 Train Loss: 0.5515
Epoch 6: Train Overall MSE: 0.0007 Validation Overall MSE: 0.0048. 
Train Top 20 DE MSE: 0.0117 Validation Top 20 DE MSE: 0.2553. 
Epoch 7 Step 1 Train Loss: 0.5547
Epoch 7 Step 51 Train Loss: 0.5371
Epoch 7 Step 101 Train Loss: 0.6147
Epoch 7 Step 151 Train Loss: 0.5190
Epoch 7 Step 201 Train Loss: 0.5396
Epoch 7 Step 251 Train Loss: 0.4920
Epoch 7 Step 301 Train Loss: 0.5379
Epoch 7 Step 351 Train Loss: 0.5770
Epoch 7 Step 401 Train Loss: 0.5238
Epoch 7 Step 451 Train Loss: 0.5167
Epoch 7 Step 501 Train Loss: 0.5562
Epoch 7 Step 551 Train Loss: 0.5616
Epoch 7: Train Overall MSE: 0.0007 Validation Overall MSE: 0.0032. 
Train Top 20 DE MSE: 0.0082 Validation Top 20 DE MSE: 0.1621. 
Epoch 8 Step 1 Train Loss: 0.5118
Epoch 8 Step 51 Train Loss: 0.5202
Epoch 8 Step 101 Train Loss: 0.5662
Epoch 8 Step 151 Train Loss: 0.6757
Epoch 8 Step 201 Train Loss: 0.5438
Epoch 8 Step 251 Train Loss: 0.5388
Epoch 8 Step 301 Train Loss: 0.6170
Epoch 8 Step 351 Train Loss: 0.5438
Epoch 8 Step 401 Train Loss: 0.5351
Epoch 8 Step 451 Train Loss: 0.5158
Epoch 8 Step 501 Train Loss: 0.5740
Epoch 8 Step 551 Train Loss: 0.4861
Epoch 8: Train Overall MSE: 0.0007 Validation Overall MSE: 0.0039. 
Train Top 20 DE MSE: 0.0079 Validation Top 20 DE MSE: 0.2011. 
Epoch 9 Step 1 Train Loss: 0.6045
Epoch 9 Step 51 Train Loss: 0.5764
Epoch 9 Step 101 Train Loss: 0.5535
Epoch 9 Step 151 Train Loss: 0.5516
Epoch 9 Step 201 Train Loss: 0.5775
Epoch 9 Step 251 Train Loss: 0.4724
Epoch 9 Step 301 Train Loss: 0.5069
Epoch 9 Step 351 Train Loss: 0.4773
Epoch 9 Step 401 Train Loss: 0.5352
Epoch 9 Step 451 Train Loss: 0.5940
Epoch 9 Step 501 Train Loss: 0.5671
Epoch 9 Step 551 Train Loss: 0.6657
Epoch 9: Train Overall MSE: 0.0007 Validation Overall MSE: 0.0040. 
Train Top 20 DE MSE: 0.0073 Validation Top 20 DE MSE: 0.2061. 
Epoch 10 Step 1 Train Loss: 0.5454
Epoch 10 Step 51 Train Loss: 0.4858
Epoch 10 Step 101 Train Loss: 0.4888
Epoch 10 Step 151 Train Loss: 0.5227
Epoch 10 Step 201 Train Loss: 0.6603
Epoch 10 Step 251 Train Loss: 0.5456
Epoch 10 Step 301 Train Loss: 0.5439
Epoch 10 Step 351 Train Loss: 0.5876
Epoch 10 Step 401 Train Loss: 0.5399
Epoch 10 Step 451 Train Loss: 0.6543
Epoch 10 Step 501 Train Loss: 0.6054
Epoch 10 Step 551 Train Loss: 0.5310
Epoch 10: Train Overall MSE: 0.0007 Validation Overall MSE: 0.0038. 
Train Top 20 DE MSE: 0.0073 Validation Top 20 DE MSE: 0.1956. 
Epoch 11 Step 1 Train Loss: 0.5763
Epoch 11 Step 51 Train Loss: 0.5673
Epoch 11 Step 101 Train Loss: 0.5653
Epoch 11 Step 151 Train Loss: 0.5470
Epoch 11 Step 201 Train Loss: 0.4987
Epoch 11 Step 251 Train Loss: 0.5266
Epoch 11 Step 301 Train Loss: 0.5745
Epoch 11 Step 351 Train Loss: 0.6058
Epoch 11 Step 401 Train Loss: 0.6190
Epoch 11 Step 451 Train Loss: 0.5418
Epoch 11 Step 501 Train Loss: 0.6526
Epoch 11 Step 551 Train Loss: 0.7139
Epoch 11: Train Overall MSE: 0.0007 Validation Overall MSE: 0.0043. 
Train Top 20 DE MSE: 0.0073 Validation Top 20 DE MSE: 0.2258. 
Epoch 12 Step 1 Train Loss: 0.5231
Epoch 12 Step 51 Train Loss: 0.5380
Epoch 12 Step 101 Train Loss: 0.5374
Epoch 12 Step 151 Train Loss: 0.6702
Epoch 12 Step 201 Train Loss: 0.5276
Epoch 12 Step 251 Train Loss: 0.6510
Epoch 12 Step 301 Train Loss: 0.4725
Epoch 12 Step 351 Train Loss: 0.5907
Epoch 12 Step 401 Train Loss: 0.5372
Epoch 12 Step 451 Train Loss: 0.7278
Epoch 12 Step 501 Train Loss: 0.5267
Epoch 12 Step 551 Train Loss: 0.5768
Epoch 12: Train Overall MSE: 0.0007 Validation Overall MSE: 0.0046. 
Train Top 20 DE MSE: 0.0078 Validation Top 20 DE MSE: 0.2437. 
Epoch 13 Step 1 Train Loss: 0.5722
Epoch 13 Step 51 Train Loss: 0.5962
Epoch 13 Step 101 Train Loss: 0.5355
Epoch 13 Step 151 Train Loss: 0.5731
Epoch 13 Step 201 Train Loss: 0.6162
Epoch 13 Step 251 Train Loss: 0.7116
Epoch 13 Step 301 Train Loss: 0.5343
Epoch 13 Step 351 Train Loss: 0.4827
Epoch 13 Step 401 Train Loss: 0.5591
Epoch 13 Step 451 Train Loss: 0.5773
Epoch 13 Step 501 Train Loss: 0.5194
Epoch 13 Step 551 Train Loss: 0.6450
Epoch 13: Train Overall MSE: 0.0007 Validation Overall MSE: 0.0030. 
Train Top 20 DE MSE: 0.0074 Validation Top 20 DE MSE: 0.1501. 
Epoch 14 Step 1 Train Loss: 0.5413
Epoch 14 Step 51 Train Loss: 0.5761
Epoch 14 Step 101 Train Loss: 0.5666
Epoch 14 Step 151 Train Loss: 0.5920
Epoch 14 Step 201 Train Loss: 0.5898
Epoch 14 Step 251 Train Loss: 0.5502
Epoch 14 Step 301 Train Loss: 0.5554
Epoch 14 Step 351 Train Loss: 0.4858
Epoch 14 Step 401 Train Loss: 0.5104
Epoch 14 Step 451 Train Loss: 0.5958
Epoch 14 Step 501 Train Loss: 0.5548
Epoch 14 Step 551 Train Loss: 0.5702
Epoch 14: Train Overall MSE: 0.0007 Validation Overall MSE: 0.0042. 
Train Top 20 DE MSE: 0.0075 Validation Top 20 DE MSE: 0.2217. 
Epoch 15 Step 1 Train Loss: 0.5653
Epoch 15 Step 51 Train Loss: 0.6345
Epoch 15 Step 101 Train Loss: 0.5403
Epoch 15 Step 151 Train Loss: 0.5129
Epoch 15 Step 201 Train Loss: 0.4598
Epoch 15 Step 251 Train Loss: 0.5096
Epoch 15 Step 301 Train Loss: 0.5239
Epoch 15 Step 351 Train Loss: 0.5376
Epoch 15 Step 401 Train Loss: 0.4890
Epoch 15 Step 451 Train Loss: 0.5199
Epoch 15 Step 501 Train Loss: 0.5649
Epoch 15 Step 551 Train Loss: 0.5811
Epoch 15: Train Overall MSE: 0.0007 Validation Overall MSE: 0.0048. 
Train Top 20 DE MSE: 0.0077 Validation Top 20 DE MSE: 0.2550. 
Done!
Start Testing...
Best performing model: Test Top 20 DE MSE: 0.0969
Start doing subgroup analysis for simulation split...
test_combo_seen0_mse: nan
test_combo_seen0_pearson: nan
test_combo_seen0_mse_de: nan
test_combo_seen0_pearson_de: nan
test_combo_seen1_mse: nan
test_combo_seen1_pearson: nan
test_combo_seen1_mse_de: nan
test_combo_seen1_pearson_de: nan
test_combo_seen2_mse: nan
test_combo_seen2_pearson: nan
test_combo_seen2_mse_de: nan
test_combo_seen2_pearson_de: nan
test_unseen_single_mse: 0.0018630889
test_unseen_single_pearson: 0.9967230243822849
test_unseen_single_mse_de: 0.09688437
test_unseen_single_pearson_de: 0.9774011656481956
test_combo_seen0_pearson_delta: nan
test_combo_seen0_frac_opposite_direction_top20_non_dropout: nan
test_combo_seen0_frac_sigma_below_1_non_dropout: nan
test_combo_seen0_mse_top20_de_non_dropout: nan
test_combo_seen1_pearson_delta: nan
test_combo_seen1_frac_opposite_direction_top20_non_dropout: nan
test_combo_seen1_frac_sigma_below_1_non_dropout: nan
test_combo_seen1_mse_top20_de_non_dropout: nan
test_combo_seen2_pearson_delta: nan
test_combo_seen2_frac_opposite_direction_top20_non_dropout: nan
test_combo_seen2_frac_sigma_below_1_non_dropout: nan
test_combo_seen2_mse_top20_de_non_dropout: nan
test_unseen_single_pearson_delta: 0.8485347043056106
test_unseen_single_frac_opposite_direction_top20_non_dropout: 0.0
test_unseen_single_frac_sigma_below_1_non_dropout: 0.8583333333333334
test_unseen_single_mse_top20_de_non_dropout: 0.09727075257944318
Done!
Creating new splits....
Saving new splits at /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03final/dixit_combined/splits/dixit_combined_simulation_5_0.75.pkl
Simulation split test composition:
combo_seen0:0
combo_seen1:0
combo_seen2:0
unseen_single:6
Done!
Creating dataloaders....
Done!
Start Training...
Epoch 1 Step 1 Train Loss: 1.0418
Epoch 1 Step 51 Train Loss: 0.6680
Epoch 1 Step 101 Train Loss: 0.5456
Epoch 1 Step 151 Train Loss: 0.5663
Epoch 1 Step 201 Train Loss: 0.5958
Epoch 1 Step 251 Train Loss: 0.8586
Epoch 1 Step 301 Train Loss: 0.7307
Epoch 1 Step 351 Train Loss: 0.6021
Epoch 1 Step 401 Train Loss: 0.5342
Epoch 1 Step 451 Train Loss: 0.5826
Epoch 1 Step 501 Train Loss: 0.5287
Epoch 1 Step 551 Train Loss: 0.5769
Epoch 1: Train Overall MSE: 0.0018 Validation Overall MSE: 0.0039. 
Train Top 20 DE MSE: 0.0202 Validation Top 20 DE MSE: 0.2034. 
Epoch 2 Step 1 Train Loss: 0.6690
Epoch 2 Step 51 Train Loss: 0.5035
Epoch 2 Step 101 Train Loss: 0.6154
Epoch 2 Step 151 Train Loss: 0.5231
Epoch 2 Step 201 Train Loss: 0.5856
Epoch 2 Step 251 Train Loss: 0.5980
Epoch 2 Step 301 Train Loss: 0.5524
Epoch 2 Step 351 Train Loss: 0.5244
Epoch 2 Step 401 Train Loss: 0.4842
Epoch 2 Step 451 Train Loss: 0.5802
Epoch 2 Step 501 Train Loss: 0.5261
Epoch 2 Step 551 Train Loss: 0.5866
Epoch 2: Train Overall MSE: 0.0017 Validation Overall MSE: 0.0156. 
Train Top 20 DE MSE: 0.0293 Validation Top 20 DE MSE: 0.9064. 
Epoch 3 Step 1 Train Loss: 0.7119
Epoch 3 Step 51 Train Loss: 0.6294
Epoch 3 Step 101 Train Loss: 0.5367
Epoch 3 Step 151 Train Loss: 0.5364
Epoch 3 Step 201 Train Loss: 0.5614
Epoch 3 Step 251 Train Loss: 0.5199
Epoch 3 Step 301 Train Loss: 0.4829
Epoch 3 Step 351 Train Loss: 0.5820
Epoch 3 Step 401 Train Loss: 0.5387
Epoch 3 Step 451 Train Loss: 0.5827
Epoch 3 Step 501 Train Loss: 0.5385
Epoch 3 Step 551 Train Loss: 0.5404
Epoch 3: Train Overall MSE: 0.0010 Validation Overall MSE: 0.0051. 
Train Top 20 DE MSE: 0.0154 Validation Top 20 DE MSE: 0.2897. 
Epoch 4 Step 1 Train Loss: 0.5492
Epoch 4 Step 51 Train Loss: 0.5794
Epoch 4 Step 101 Train Loss: 0.4726
Epoch 4 Step 151 Train Loss: 0.5845
Epoch 4 Step 201 Train Loss: 0.5670
Epoch 4 Step 251 Train Loss: 0.5733
Epoch 4 Step 301 Train Loss: 0.5564
Epoch 4 Step 351 Train Loss: 0.5524
Epoch 4 Step 401 Train Loss: 0.5537
Epoch 4 Step 451 Train Loss: 0.7025
Epoch 4 Step 501 Train Loss: 0.5038
Epoch 4 Step 551 Train Loss: 0.5750
Epoch 4: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0066. 
Train Top 20 DE MSE: 0.0114 Validation Top 20 DE MSE: 0.3750. 
Epoch 5 Step 1 Train Loss: 0.5515
Epoch 5 Step 51 Train Loss: 0.6195
Epoch 5 Step 101 Train Loss: 0.5387
Epoch 5 Step 151 Train Loss: 0.5257
Epoch 5 Step 201 Train Loss: 0.6293
Epoch 5 Step 251 Train Loss: 0.5156
Epoch 5 Step 301 Train Loss: 0.6057
Epoch 5 Step 351 Train Loss: 0.5186
Epoch 5 Step 401 Train Loss: 0.5489
Epoch 5 Step 451 Train Loss: 0.5756
Epoch 5 Step 501 Train Loss: 0.6340
Epoch 5 Step 551 Train Loss: 0.6182
Epoch 5: Train Overall MSE: 0.0008 Validation Overall MSE: 0.0081. 
Train Top 20 DE MSE: 0.0088 Validation Top 20 DE MSE: 0.4664. 
Epoch 6 Step 1 Train Loss: 0.6414
Epoch 6 Step 51 Train Loss: 0.5228
Epoch 6 Step 101 Train Loss: 0.5845
Epoch 6 Step 151 Train Loss: 0.5969
Epoch 6 Step 201 Train Loss: 0.5295
Epoch 6 Step 251 Train Loss: 0.5380
Epoch 6 Step 301 Train Loss: 0.7066
Epoch 6 Step 351 Train Loss: 0.5191
Epoch 6 Step 401 Train Loss: 0.5252
Epoch 6 Step 451 Train Loss: 0.5207
Epoch 6 Step 501 Train Loss: 0.5466
Epoch 6 Step 551 Train Loss: 0.6613
Epoch 6: Train Overall MSE: 0.0007 Validation Overall MSE: 0.0074. 
Train Top 20 DE MSE: 0.0074 Validation Top 20 DE MSE: 0.4252. 
Epoch 7 Step 1 Train Loss: 0.5744
Epoch 7 Step 51 Train Loss: 0.5530
Epoch 7 Step 101 Train Loss: 0.4779
Epoch 7 Step 151 Train Loss: 0.5198
Epoch 7 Step 201 Train Loss: 0.4390
Epoch 7 Step 251 Train Loss: 0.5424
Epoch 7 Step 301 Train Loss: 0.4360
Epoch 7 Step 351 Train Loss: 0.5148
Epoch 7 Step 401 Train Loss: 0.6276
Epoch 7 Step 451 Train Loss: 0.5671
Epoch 7 Step 501 Train Loss: 0.6764
Epoch 7 Step 551 Train Loss: 0.6085
Epoch 7: Train Overall MSE: 0.0008 Validation Overall MSE: 0.0046. 
Train Top 20 DE MSE: 0.0078 Validation Top 20 DE MSE: 0.2491. 
Epoch 8 Step 1 Train Loss: 0.5273
Epoch 8 Step 51 Train Loss: 0.5915
Epoch 8 Step 101 Train Loss: 0.5521
Epoch 8 Step 151 Train Loss: 0.5430
Epoch 8 Step 201 Train Loss: 0.5394
Epoch 8 Step 251 Train Loss: 0.4753
Epoch 8 Step 301 Train Loss: 0.5995
Epoch 8 Step 351 Train Loss: 0.5679
Epoch 8 Step 401 Train Loss: 0.5137
Epoch 8 Step 451 Train Loss: 0.5344
Epoch 8 Step 501 Train Loss: 0.4932
Epoch 8 Step 551 Train Loss: 0.5192
Epoch 8: Train Overall MSE: 0.0007 Validation Overall MSE: 0.0048. 
Train Top 20 DE MSE: 0.0076 Validation Top 20 DE MSE: 0.2632. 
Epoch 9 Step 1 Train Loss: 0.5868
Epoch 9 Step 51 Train Loss: 0.6077
Epoch 9 Step 101 Train Loss: 0.6042
Epoch 9 Step 151 Train Loss: 0.4496
Epoch 9 Step 201 Train Loss: 0.4924
Epoch 9 Step 251 Train Loss: 0.5119
Epoch 9 Step 301 Train Loss: 0.5843
Epoch 9 Step 351 Train Loss: 0.6404
Epoch 9 Step 401 Train Loss: 0.5428
Epoch 9 Step 451 Train Loss: 0.6269
Epoch 9 Step 501 Train Loss: 0.4715
Epoch 9 Step 551 Train Loss: 0.4790
Epoch 9: Train Overall MSE: 0.0007 Validation Overall MSE: 0.0075. 
Train Top 20 DE MSE: 0.0084 Validation Top 20 DE MSE: 0.4282. 
Epoch 10 Step 1 Train Loss: 0.6169
Epoch 10 Step 51 Train Loss: 0.5662
Epoch 10 Step 101 Train Loss: 0.5123
Epoch 10 Step 151 Train Loss: 0.5650
Epoch 10 Step 201 Train Loss: 0.6089
Epoch 10 Step 251 Train Loss: 0.4995
Epoch 10 Step 301 Train Loss: 0.6098
Epoch 10 Step 351 Train Loss: 0.5229
Epoch 10 Step 401 Train Loss: 0.5516
Epoch 10 Step 451 Train Loss: 0.5509
Epoch 10 Step 501 Train Loss: 0.5350
Epoch 10 Step 551 Train Loss: 0.6135
Epoch 10: Train Overall MSE: 0.0008 Validation Overall MSE: 0.0063. 
Train Top 20 DE MSE: 0.0069 Validation Top 20 DE MSE: 0.3599. 
Epoch 11 Step 1 Train Loss: 0.5420
Epoch 11 Step 51 Train Loss: 0.4956
Epoch 11 Step 101 Train Loss: 0.5409
Epoch 11 Step 151 Train Loss: 0.5518
Epoch 11 Step 201 Train Loss: 0.5549
Epoch 11 Step 251 Train Loss: 0.5465
Epoch 11 Step 301 Train Loss: 0.6586
Epoch 11 Step 351 Train Loss: 0.5122
Epoch 11 Step 401 Train Loss: 0.6231
Epoch 11 Step 451 Train Loss: 0.4698
Epoch 11 Step 501 Train Loss: 0.4698
Epoch 11 Step 551 Train Loss: 0.5630
Epoch 11: Train Overall MSE: 0.0007 Validation Overall MSE: 0.0073. 
Train Top 20 DE MSE: 0.0075 Validation Top 20 DE MSE: 0.4169. 
Epoch 12 Step 1 Train Loss: 0.5578
Epoch 12 Step 51 Train Loss: 0.5166
Epoch 12 Step 101 Train Loss: 0.5306
Epoch 12 Step 151 Train Loss: 0.4947
Epoch 12 Step 201 Train Loss: 0.5594
Epoch 12 Step 251 Train Loss: 0.5926
Epoch 12 Step 301 Train Loss: 0.5169
Epoch 12 Step 351 Train Loss: 0.5693
Epoch 12 Step 401 Train Loss: 0.5971
Epoch 12 Step 451 Train Loss: 0.4970
Epoch 12 Step 501 Train Loss: 0.5736
Epoch 12 Step 551 Train Loss: 0.7038
Epoch 12: Train Overall MSE: 0.0008 Validation Overall MSE: 0.0056. 
Train Top 20 DE MSE: 0.0064 Validation Top 20 DE MSE: 0.3157. 
Epoch 13 Step 1 Train Loss: 0.5882
Epoch 13 Step 51 Train Loss: 0.5904
Epoch 13 Step 101 Train Loss: 0.5679
Epoch 13 Step 151 Train Loss: 0.5812
Epoch 13 Step 201 Train Loss: 0.5235
Epoch 13 Step 251 Train Loss: 0.5804
Epoch 13 Step 301 Train Loss: 0.4369
Epoch 13 Step 351 Train Loss: 0.5715
Epoch 13 Step 401 Train Loss: 0.5507
Epoch 13 Step 451 Train Loss: 0.5412
Epoch 13 Step 501 Train Loss: 0.6859
Epoch 13 Step 551 Train Loss: 0.7105
Epoch 13: Train Overall MSE: 0.0007 Validation Overall MSE: 0.0076. 
Train Top 20 DE MSE: 0.0072 Validation Top 20 DE MSE: 0.4373. 
Epoch 14 Step 1 Train Loss: 0.5849
Epoch 14 Step 51 Train Loss: 0.5966
Epoch 14 Step 101 Train Loss: 0.5307
Epoch 14 Step 151 Train Loss: 0.6357
Epoch 14 Step 201 Train Loss: 0.6155
Epoch 14 Step 251 Train Loss: 0.5027
Epoch 14 Step 301 Train Loss: 0.5105
Epoch 14 Step 351 Train Loss: 0.5428
Epoch 14 Step 401 Train Loss: 0.5769
Epoch 14 Step 451 Train Loss: 0.6546
Epoch 14 Step 501 Train Loss: 0.5003
Epoch 14 Step 551 Train Loss: 0.5493
Epoch 14: Train Overall MSE: 0.0007 Validation Overall MSE: 0.0047. 
Train Top 20 DE MSE: 0.0073 Validation Top 20 DE MSE: 0.2603. 
Epoch 15 Step 1 Train Loss: 0.5005
Epoch 15 Step 51 Train Loss: 0.5765
Epoch 15 Step 101 Train Loss: 0.4755
Epoch 15 Step 151 Train Loss: 0.4690
Epoch 15 Step 201 Train Loss: 0.5652
Epoch 15 Step 251 Train Loss: 0.5900
Epoch 15 Step 301 Train Loss: 0.5303
Epoch 15 Step 351 Train Loss: 0.6979
Epoch 15 Step 401 Train Loss: 0.6265
Epoch 15 Step 451 Train Loss: 0.5578
Epoch 15 Step 501 Train Loss: 0.5099
Epoch 15 Step 551 Train Loss: 0.5711
Epoch 15: Train Overall MSE: 0.0007 Validation Overall MSE: 0.0078. 
Train Top 20 DE MSE: 0.0072 Validation Top 20 DE MSE: 0.4466. 
Done!
Start Testing...
Best performing model: Test Top 20 DE MSE: 0.0422
Start doing subgroup analysis for simulation split...
test_combo_seen0_mse: nan
test_combo_seen0_pearson: nan
test_combo_seen0_mse_de: nan
test_combo_seen0_pearson_de: nan
test_combo_seen1_mse: nan
test_combo_seen1_pearson: nan
test_combo_seen1_mse_de: nan
test_combo_seen1_pearson_de: nan
test_combo_seen2_mse: nan
test_combo_seen2_pearson: nan
test_combo_seen2_mse_de: nan
test_combo_seen2_pearson_de: nan
test_unseen_single_mse: 0.0014657462
test_unseen_single_pearson: 0.9974045356943543
test_unseen_single_mse_de: 0.042244572
test_unseen_single_pearson_de: 0.9910333435939455
test_combo_seen0_pearson_delta: nan
test_combo_seen0_frac_opposite_direction_top20_non_dropout: nan
test_combo_seen0_frac_sigma_below_1_non_dropout: nan
test_combo_seen0_mse_top20_de_non_dropout: nan
test_combo_seen1_pearson_delta: nan
test_combo_seen1_frac_opposite_direction_top20_non_dropout: nan
test_combo_seen1_frac_sigma_below_1_non_dropout: nan
test_combo_seen1_mse_top20_de_non_dropout: nan
test_combo_seen2_pearson_delta: nan
test_combo_seen2_frac_opposite_direction_top20_non_dropout: nan
test_combo_seen2_frac_sigma_below_1_non_dropout: nan
test_combo_seen2_mse_top20_de_non_dropout: nan
test_unseen_single_pearson_delta: 0.7513155860470732
test_unseen_single_frac_opposite_direction_top20_non_dropout: 0.0
test_unseen_single_frac_sigma_below_1_non_dropout: 0.9666666666666668
test_unseen_single_mse_top20_de_non_dropout: 0.04224457042824892
Done!
Found local copy...
Creating pyg object for each cell in the data...
Creating dataset file...
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [04:35<45:56, 275.64s/it] 18%|█▊        | 2/11 [08:30<37:42, 251.40s/it] 27%|██▋       | 3/11 [09:52<23:12, 174.11s/it] 36%|███▋      | 4/11 [11:33<16:58, 145.51s/it] 45%|████▌     | 5/11 [13:49<14:10, 141.80s/it] 55%|█████▍    | 6/11 [13:50<07:50, 94.07s/it]  64%|██████▎   | 7/11 [15:24<06:15, 93.90s/it] 73%|███████▎  | 8/11 [17:20<05:03, 101.05s/it] 82%|████████▏ | 9/11 [19:02<03:22, 101.42s/it] 91%|█████████ | 10/11 [20:47<01:42, 102.63s/it]100%|██████████| 11/11 [23:20<00:00, 117.83s/it]100%|██████████| 11/11 [23:20<00:00, 127.30s/it]
Done!
Saving new dataset pyg object at /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03final/dixit_gsm2396858/data_pyg/cell_graphs.pkl
Done!
Local copy of split is detected. Loading...
Simulation split test composition:
combo_seen0:0
combo_seen1:0
combo_seen2:0
unseen_single:3
Done!
Creating dataloaders....
Done!
Start Training...
Epoch 1 Step 1 Train Loss: 1.5234
Epoch 1 Step 51 Train Loss: 0.5849
Epoch 1 Step 101 Train Loss: 0.5182
Epoch 1 Step 151 Train Loss: 0.5596
Epoch 1 Step 201 Train Loss: 0.4711
Epoch 1 Step 251 Train Loss: 0.5313
Epoch 1 Step 301 Train Loss: 0.5370
Epoch 1: Train Overall MSE: 0.0022 Validation Overall MSE: 0.0011. 
Train Top 20 DE MSE: 0.0047 Validation Top 20 DE MSE: 0.0109. 
Epoch 2 Step 1 Train Loss: 0.4496
Epoch 2 Step 51 Train Loss: 0.5720
Epoch 2 Step 101 Train Loss: 0.4415
Epoch 2 Step 151 Train Loss: 0.6012
Epoch 2 Step 201 Train Loss: 0.4542
Epoch 2 Step 251 Train Loss: 0.5031
Epoch 2 Step 301 Train Loss: 0.5165
Epoch 2: Train Overall MSE: 0.0015 Validation Overall MSE: 0.0005. 
Train Top 20 DE MSE: 0.0048 Validation Top 20 DE MSE: 0.0050. 
Epoch 3 Step 1 Train Loss: 0.5157
Epoch 3 Step 51 Train Loss: 0.4183
Epoch 3 Step 101 Train Loss: 0.4563
Epoch 3 Step 151 Train Loss: 0.4077
Epoch 3 Step 201 Train Loss: 0.4704
Epoch 3 Step 251 Train Loss: 0.4656
Epoch 3 Step 301 Train Loss: 0.4793
Epoch 3: Train Overall MSE: 0.0007 Validation Overall MSE: 0.0003. 
Train Top 20 DE MSE: 0.0049 Validation Top 20 DE MSE: 0.0029. 
Epoch 4 Step 1 Train Loss: 0.4825
Epoch 4 Step 51 Train Loss: 0.4305
Epoch 4 Step 101 Train Loss: 0.4625
Epoch 4 Step 151 Train Loss: 0.5114
Epoch 4 Step 201 Train Loss: 0.5139
Epoch 4 Step 251 Train Loss: 0.5901
Epoch 4 Step 301 Train Loss: 0.4414
Epoch 4: Train Overall MSE: 0.0005 Validation Overall MSE: 0.0004. 
Train Top 20 DE MSE: 0.0020 Validation Top 20 DE MSE: 0.0037. 
Epoch 5 Step 1 Train Loss: 0.4574
Epoch 5 Step 51 Train Loss: 0.5160
Epoch 5 Step 101 Train Loss: 0.4852
Epoch 5 Step 151 Train Loss: 0.4328
Epoch 5 Step 201 Train Loss: 0.4218
Epoch 5 Step 251 Train Loss: 0.4158
Epoch 5 Step 301 Train Loss: 0.4282
Epoch 5: Train Overall MSE: 0.0004 Validation Overall MSE: 0.0003. 
Train Top 20 DE MSE: 0.0023 Validation Top 20 DE MSE: 0.0030. 
Epoch 6 Step 1 Train Loss: 0.3938
Epoch 6 Step 51 Train Loss: 0.5802
Epoch 6 Step 101 Train Loss: 0.4541
Epoch 6 Step 151 Train Loss: 0.4355
Epoch 6 Step 201 Train Loss: 0.3973
Epoch 6 Step 251 Train Loss: 0.5032
Epoch 6 Step 301 Train Loss: 0.4088
Epoch 6: Train Overall MSE: 0.0004 Validation Overall MSE: 0.0003. 
Train Top 20 DE MSE: 0.0029 Validation Top 20 DE MSE: 0.0029. 
Epoch 7 Step 1 Train Loss: 0.5221
Epoch 7 Step 51 Train Loss: 0.4682
Epoch 7 Step 101 Train Loss: 0.4546
Epoch 7 Step 151 Train Loss: 0.4027
Epoch 7 Step 201 Train Loss: 0.4316
Epoch 7 Step 251 Train Loss: 0.5077
Epoch 7 Step 301 Train Loss: 0.4738
Epoch 7: Train Overall MSE: 0.0004 Validation Overall MSE: 0.0003. 
Train Top 20 DE MSE: 0.0020 Validation Top 20 DE MSE: 0.0028. 
Epoch 8 Step 1 Train Loss: 0.4227
Epoch 8 Step 51 Train Loss: 0.4100
Epoch 8 Step 101 Train Loss: 0.4978
Epoch 8 Step 151 Train Loss: 0.5032
Epoch 8 Step 201 Train Loss: 0.4801
Epoch 8 Step 251 Train Loss: 0.4876
Epoch 8 Step 301 Train Loss: 0.4957
Epoch 8: Train Overall MSE: 0.0004 Validation Overall MSE: 0.0004. 
Train Top 20 DE MSE: 0.0018 Validation Top 20 DE MSE: 0.0026. 
Epoch 9 Step 1 Train Loss: 0.4646
Epoch 9 Step 51 Train Loss: 0.5056
Epoch 9 Step 101 Train Loss: 0.4474
Epoch 9 Step 151 Train Loss: 0.4914
Epoch 9 Step 201 Train Loss: 0.5313
Epoch 9 Step 251 Train Loss: 0.4270
Epoch 9 Step 301 Train Loss: 0.5188
Epoch 9: Train Overall MSE: 0.0004 Validation Overall MSE: 0.0004. 
Train Top 20 DE MSE: 0.0018 Validation Top 20 DE MSE: 0.0025. 
Epoch 10 Step 1 Train Loss: 0.4006
Epoch 10 Step 51 Train Loss: 0.4500
Epoch 10 Step 101 Train Loss: 0.4539
Epoch 10 Step 151 Train Loss: 0.5623
Epoch 10 Step 201 Train Loss: 0.4585
Epoch 10 Step 251 Train Loss: 0.4576
Epoch 10 Step 301 Train Loss: 0.5683
Epoch 10: Train Overall MSE: 0.0004 Validation Overall MSE: 0.0004. 
Train Top 20 DE MSE: 0.0019 Validation Top 20 DE MSE: 0.0024. 
Epoch 11 Step 1 Train Loss: 0.4567
Epoch 11 Step 51 Train Loss: 0.4689
Epoch 11 Step 101 Train Loss: 0.4805
Epoch 11 Step 151 Train Loss: 0.5010
Epoch 11 Step 201 Train Loss: 0.5402
Epoch 11 Step 251 Train Loss: 0.5213
Epoch 11 Step 301 Train Loss: 0.4733
Epoch 11: Train Overall MSE: 0.0004 Validation Overall MSE: 0.0004. 
Train Top 20 DE MSE: 0.0019 Validation Top 20 DE MSE: 0.0024. 
Epoch 12 Step 1 Train Loss: 0.4480
Epoch 12 Step 51 Train Loss: 0.4860
Epoch 12 Step 101 Train Loss: 0.5005
Epoch 12 Step 151 Train Loss: 0.4415
Epoch 12 Step 201 Train Loss: 0.4018
Epoch 12 Step 251 Train Loss: 0.4532
Epoch 12 Step 301 Train Loss: 0.4264
Epoch 12: Train Overall MSE: 0.0004 Validation Overall MSE: 0.0004. 
Train Top 20 DE MSE: 0.0018 Validation Top 20 DE MSE: 0.0024. 
Epoch 13 Step 1 Train Loss: 0.5333
Epoch 13 Step 51 Train Loss: 0.5031
Epoch 13 Step 101 Train Loss: 0.4922
Epoch 13 Step 151 Train Loss: 0.3995
Epoch 13 Step 201 Train Loss: 0.4663
Epoch 13 Step 251 Train Loss: 0.5324
Epoch 13 Step 301 Train Loss: 0.5091
Epoch 13: Train Overall MSE: 0.0004 Validation Overall MSE: 0.0003. 
Train Top 20 DE MSE: 0.0019 Validation Top 20 DE MSE: 0.0028. 
Epoch 14 Step 1 Train Loss: 0.4731
Epoch 14 Step 51 Train Loss: 0.4702
Epoch 14 Step 101 Train Loss: 0.4708
Epoch 14 Step 151 Train Loss: 0.4033
Epoch 14 Step 201 Train Loss: 0.5430
Epoch 14 Step 251 Train Loss: 0.4047
Epoch 14 Step 301 Train Loss: 0.4980
Epoch 14: Train Overall MSE: 0.0004 Validation Overall MSE: 0.0004. 
Train Top 20 DE MSE: 0.0019 Validation Top 20 DE MSE: 0.0024. 
Epoch 15 Step 1 Train Loss: 0.5059
Epoch 15 Step 51 Train Loss: 0.4136
Epoch 15 Step 101 Train Loss: 0.4985
Epoch 15 Step 151 Train Loss: 0.3974
Epoch 15 Step 201 Train Loss: 0.5240
Epoch 15 Step 251 Train Loss: 0.4358
Epoch 15 Step 301 Train Loss: 0.4292
Epoch 15: Train Overall MSE: 0.0004 Validation Overall MSE: 0.0004. 
Train Top 20 DE MSE: 0.0019 Validation Top 20 DE MSE: 0.0024. 
Done!
Start Testing...
Best performing model: Test Top 20 DE MSE: 0.0019
Start doing subgroup analysis for simulation split...
test_combo_seen0_mse: nan
test_combo_seen0_pearson: nan
test_combo_seen0_mse_de: nan
test_combo_seen0_pearson_de: nan
test_combo_seen1_mse: nan
test_combo_seen1_pearson: nan
test_combo_seen1_mse_de: nan
test_combo_seen1_pearson_de: nan
test_combo_seen2_mse: nan
test_combo_seen2_pearson: nan
test_combo_seen2_mse_de: nan
test_combo_seen2_pearson_de: nan
test_unseen_single_mse: 0.00035928664
test_unseen_single_pearson: 0.9993471782948209
test_unseen_single_mse_de: 0.0018832112
test_unseen_single_pearson_de: 0.999729058663204
test_combo_seen0_pearson_delta: nan
test_combo_seen0_frac_opposite_direction_top20_non_dropout: nan
test_combo_seen0_frac_sigma_below_1_non_dropout: nan
test_combo_seen0_mse_top20_de_non_dropout: nan
test_combo_seen1_pearson_delta: nan
test_combo_seen1_frac_opposite_direction_top20_non_dropout: nan
test_combo_seen1_frac_sigma_below_1_non_dropout: nan
test_combo_seen1_mse_top20_de_non_dropout: nan
test_combo_seen2_pearson_delta: nan
test_combo_seen2_frac_opposite_direction_top20_non_dropout: nan
test_combo_seen2_frac_sigma_below_1_non_dropout: nan
test_combo_seen2_mse_top20_de_non_dropout: nan
test_unseen_single_pearson_delta: 0.4159611906610776
test_unseen_single_frac_opposite_direction_top20_non_dropout: 0.016666666666666666
test_unseen_single_frac_sigma_below_1_non_dropout: 1.0
test_unseen_single_mse_top20_de_non_dropout: 0.002080599027705159
Done!
Creating new splits....
Saving new splits at /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03final/dixit_gsm2396858/splits/dixit_gsm2396858_simulation_2_0.75.pkl
Simulation split test composition:
combo_seen0:0
combo_seen1:0
combo_seen2:0
unseen_single:3
Done!
Creating dataloaders....
Done!
Start Training...
Epoch 1 Step 1 Train Loss: 2.3031
Epoch 1 Step 51 Train Loss: 0.6480
Epoch 1 Step 101 Train Loss: 0.5766
Epoch 1 Step 151 Train Loss: 0.5199
Epoch 1 Step 201 Train Loss: 0.5671
Epoch 1 Step 251 Train Loss: 0.4814
Epoch 1 Step 301 Train Loss: 0.4763
Epoch 1: Train Overall MSE: 0.0017 Validation Overall MSE: 0.0020. 
Train Top 20 DE MSE: 0.0024 Validation Top 20 DE MSE: 0.0144. 
Epoch 2 Step 1 Train Loss: 0.4360
Epoch 2 Step 51 Train Loss: 0.4482
Epoch 2 Step 101 Train Loss: 0.4930
Epoch 2 Step 151 Train Loss: 0.5208
Epoch 2 Step 201 Train Loss: 0.5117
Epoch 2 Step 251 Train Loss: 0.3980
Epoch 2 Step 301 Train Loss: 0.5057
Epoch 2: Train Overall MSE: 0.0008 Validation Overall MSE: 0.0004. 
Train Top 20 DE MSE: 0.0014 Validation Top 20 DE MSE: 0.0055. 
Epoch 3 Step 1 Train Loss: 0.4876
Epoch 3 Step 51 Train Loss: 0.4971
Epoch 3 Step 101 Train Loss: 0.4503
Epoch 3 Step 151 Train Loss: 0.4703
Epoch 3 Step 201 Train Loss: 0.4860
Epoch 3 Step 251 Train Loss: 0.5071
Epoch 3 Step 301 Train Loss: 0.4983
Epoch 3: Train Overall MSE: 0.0007 Validation Overall MSE: 0.0003. 
Train Top 20 DE MSE: 0.0017 Validation Top 20 DE MSE: 0.0061. 
Epoch 4 Step 1 Train Loss: 0.4406
Epoch 4 Step 51 Train Loss: 0.5027
Epoch 4 Step 101 Train Loss: 0.4427
Epoch 4 Step 151 Train Loss: 0.4237
Epoch 4 Step 201 Train Loss: 0.4470
Epoch 4 Step 251 Train Loss: 0.5068
Epoch 4 Step 301 Train Loss: 0.4179
Epoch 4: Train Overall MSE: 0.0005 Validation Overall MSE: 0.0002. 
Train Top 20 DE MSE: 0.0013 Validation Top 20 DE MSE: 0.0047. 
Epoch 5 Step 1 Train Loss: 0.5068
Epoch 5 Step 51 Train Loss: 0.4581
Epoch 5 Step 101 Train Loss: 0.4371
Epoch 5 Step 151 Train Loss: 0.5144
Epoch 5 Step 201 Train Loss: 0.4465
Epoch 5 Step 251 Train Loss: 0.4777
Epoch 5 Step 301 Train Loss: 0.4326
Epoch 5: Train Overall MSE: 0.0004 Validation Overall MSE: 0.0002. 
Train Top 20 DE MSE: 0.0015 Validation Top 20 DE MSE: 0.0051. 
Epoch 6 Step 1 Train Loss: 0.4618
Epoch 6 Step 51 Train Loss: 0.5409
Epoch 6 Step 101 Train Loss: 0.4545
Epoch 6 Step 151 Train Loss: 0.4470
Epoch 6 Step 201 Train Loss: 0.4126
Epoch 6 Step 251 Train Loss: 0.3953
Epoch 6 Step 301 Train Loss: 0.4415
Epoch 6: Train Overall MSE: 0.0004 Validation Overall MSE: 0.0002. 
Train Top 20 DE MSE: 0.0016 Validation Top 20 DE MSE: 0.0043. 
Epoch 7 Step 1 Train Loss: 0.5614
Epoch 7 Step 51 Train Loss: 0.5229
Epoch 7 Step 101 Train Loss: 0.4495
Epoch 7 Step 151 Train Loss: 0.4227
Epoch 7 Step 201 Train Loss: 0.4067
Epoch 7 Step 251 Train Loss: 0.5035
Epoch 7 Step 301 Train Loss: 0.4714
Epoch 7: Train Overall MSE: 0.0004 Validation Overall MSE: 0.0002. 
Train Top 20 DE MSE: 0.0016 Validation Top 20 DE MSE: 0.0045. 
Epoch 8 Step 1 Train Loss: 0.4346
Epoch 8 Step 51 Train Loss: 0.4675
Epoch 8 Step 101 Train Loss: 0.4692
Epoch 8 Step 151 Train Loss: 0.4437
Epoch 8 Step 201 Train Loss: 0.4519
Epoch 8 Step 251 Train Loss: 0.4843
Epoch 8 Step 301 Train Loss: 0.4933
Epoch 8: Train Overall MSE: 0.0004 Validation Overall MSE: 0.0002. 
Train Top 20 DE MSE: 0.0016 Validation Top 20 DE MSE: 0.0042. 
Epoch 9 Step 1 Train Loss: 0.4601
Epoch 9 Step 51 Train Loss: 0.4940
Epoch 9 Step 101 Train Loss: 0.4377
Epoch 9 Step 151 Train Loss: 0.4731
Epoch 9 Step 201 Train Loss: 0.4985
Epoch 9 Step 251 Train Loss: 0.4316
Epoch 9 Step 301 Train Loss: 0.4224
Epoch 9: Train Overall MSE: 0.0004 Validation Overall MSE: 0.0002. 
Train Top 20 DE MSE: 0.0016 Validation Top 20 DE MSE: 0.0040. 
Epoch 10 Step 1 Train Loss: 0.4436
Epoch 10 Step 51 Train Loss: 0.4860
Epoch 10 Step 101 Train Loss: 0.4077
Epoch 10 Step 151 Train Loss: 0.5195
Epoch 10 Step 201 Train Loss: 0.5156
Epoch 10 Step 251 Train Loss: 0.5202
Epoch 10 Step 301 Train Loss: 0.5030
Epoch 10: Train Overall MSE: 0.0004 Validation Overall MSE: 0.0002. 
Train Top 20 DE MSE: 0.0018 Validation Top 20 DE MSE: 0.0040. 
Epoch 11 Step 1 Train Loss: 0.4348
Epoch 11 Step 51 Train Loss: 0.5057
Epoch 11 Step 101 Train Loss: 0.4218
Epoch 11 Step 151 Train Loss: 0.4923
Epoch 11 Step 201 Train Loss: 0.3805
Epoch 11 Step 251 Train Loss: 0.4547
Epoch 11 Step 301 Train Loss: 0.4527
Epoch 11: Train Overall MSE: 0.0004 Validation Overall MSE: 0.0002. 
Train Top 20 DE MSE: 0.0017 Validation Top 20 DE MSE: 0.0048. 
Epoch 12 Step 1 Train Loss: 0.4121
Epoch 12 Step 51 Train Loss: 0.4441
Epoch 12 Step 101 Train Loss: 0.5292
Epoch 12 Step 151 Train Loss: 0.5363
Epoch 12 Step 201 Train Loss: 0.4118
Epoch 12 Step 251 Train Loss: 0.4560
Epoch 12 Step 301 Train Loss: 0.3920
Epoch 12: Train Overall MSE: 0.0004 Validation Overall MSE: 0.0002. 
Train Top 20 DE MSE: 0.0016 Validation Top 20 DE MSE: 0.0045. 
Epoch 13 Step 1 Train Loss: 0.4492
Epoch 13 Step 51 Train Loss: 0.4583
Epoch 13 Step 101 Train Loss: 0.4051
Epoch 13 Step 151 Train Loss: 0.4767
Epoch 13 Step 201 Train Loss: 0.4689
Epoch 13 Step 251 Train Loss: 0.4523
Epoch 13 Step 301 Train Loss: 0.4406
Epoch 13: Train Overall MSE: 0.0004 Validation Overall MSE: 0.0002. 
Train Top 20 DE MSE: 0.0016 Validation Top 20 DE MSE: 0.0041. 
Epoch 14 Step 1 Train Loss: 0.4789
Epoch 14 Step 51 Train Loss: 0.4052
Epoch 14 Step 101 Train Loss: 0.4304
Epoch 14 Step 151 Train Loss: 0.5007
Epoch 14 Step 201 Train Loss: 0.4434
Epoch 14 Step 251 Train Loss: 0.4419
Epoch 14 Step 301 Train Loss: 0.5054
Epoch 14: Train Overall MSE: 0.0004 Validation Overall MSE: 0.0002. 
Train Top 20 DE MSE: 0.0017 Validation Top 20 DE MSE: 0.0040. 
Epoch 15 Step 1 Train Loss: 0.5024
Epoch 15 Step 51 Train Loss: 0.4068
Epoch 15 Step 101 Train Loss: 0.4547
Epoch 15 Step 151 Train Loss: 0.4483
Epoch 15 Step 201 Train Loss: 0.5380
Epoch 15 Step 251 Train Loss: 0.4287
Epoch 15 Step 301 Train Loss: 0.4357
Epoch 15: Train Overall MSE: 0.0004 Validation Overall MSE: 0.0002. 
Train Top 20 DE MSE: 0.0017 Validation Top 20 DE MSE: 0.0044. 
Done!
Start Testing...
Best performing model: Test Top 20 DE MSE: 0.0102
Start doing subgroup analysis for simulation split...
test_combo_seen0_mse: nan
test_combo_seen0_pearson: nan
test_combo_seen0_mse_de: nan
test_combo_seen0_pearson_de: nan
test_combo_seen1_mse: nan
test_combo_seen1_pearson: nan
test_combo_seen1_mse_de: nan
test_combo_seen1_pearson_de: nan
test_combo_seen2_mse: nan
test_combo_seen2_pearson: nan
test_combo_seen2_mse_de: nan
test_combo_seen2_pearson_de: nan
test_unseen_single_mse: 0.00047723716
test_unseen_single_pearson: 0.9991420131258874
test_unseen_single_mse_de: 0.010151151
test_unseen_single_pearson_de: 0.9985856926068295
test_combo_seen0_pearson_delta: nan
test_combo_seen0_frac_opposite_direction_top20_non_dropout: nan
test_combo_seen0_frac_sigma_below_1_non_dropout: nan
test_combo_seen0_mse_top20_de_non_dropout: nan
test_combo_seen1_pearson_delta: nan
test_combo_seen1_frac_opposite_direction_top20_non_dropout: nan
test_combo_seen1_frac_sigma_below_1_non_dropout: nan
test_combo_seen1_mse_top20_de_non_dropout: nan
test_combo_seen2_pearson_delta: nan
test_combo_seen2_frac_opposite_direction_top20_non_dropout: nan
test_combo_seen2_frac_sigma_below_1_non_dropout: nan
test_combo_seen2_mse_top20_de_non_dropout: nan
test_unseen_single_pearson_delta: 0.34791076105054247
test_unseen_single_frac_opposite_direction_top20_non_dropout: 0.11666666666666665
test_unseen_single_frac_sigma_below_1_non_dropout: 1.0
test_unseen_single_mse_top20_de_non_dropout: 0.010278830205442164
Done!
Creating new splits....
Saving new splits at /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03final/dixit_gsm2396858/splits/dixit_gsm2396858_simulation_3_0.75.pkl
Simulation split test composition:
combo_seen0:0
combo_seen1:0
combo_seen2:0
unseen_single:3
Done!
Creating dataloaders....
Done!
Start Training...
Epoch 1 Step 1 Train Loss: 0.9634
Epoch 1 Step 51 Train Loss: 0.5098
Epoch 1 Step 101 Train Loss: 0.5282
Epoch 1 Step 151 Train Loss: 0.6029
Epoch 1 Step 201 Train Loss: 0.4787
Epoch 1 Step 251 Train Loss: 0.4580
Epoch 1: Train Overall MSE: 0.0033 Validation Overall MSE: 0.0010. 
Train Top 20 DE MSE: 0.0085 Validation Top 20 DE MSE: 0.0042. 
Epoch 2 Step 1 Train Loss: 0.5308
Epoch 2 Step 51 Train Loss: 0.5593
Epoch 2 Step 101 Train Loss: 0.4462
Epoch 2 Step 151 Train Loss: 0.4916
Epoch 2 Step 201 Train Loss: 0.5033
Epoch 2 Step 251 Train Loss: 0.5371
Epoch 2: Train Overall MSE: 0.0018 Validation Overall MSE: 0.0012. 
Train Top 20 DE MSE: 0.0046 Validation Top 20 DE MSE: 0.0026. 
Epoch 3 Step 1 Train Loss: 0.4830
Epoch 3 Step 51 Train Loss: 0.4408
Epoch 3 Step 101 Train Loss: 0.5152
Epoch 3 Step 151 Train Loss: 0.4630
Epoch 3 Step 201 Train Loss: 0.4998
Epoch 3 Step 251 Train Loss: 0.4877
Epoch 3: Train Overall MSE: 0.0012 Validation Overall MSE: 0.0008. 
Train Top 20 DE MSE: 0.0040 Validation Top 20 DE MSE: 0.0030. 
Epoch 4 Step 1 Train Loss: 0.5121
Epoch 4 Step 51 Train Loss: 0.4907
Epoch 4 Step 101 Train Loss: 0.5265
Epoch 4 Step 151 Train Loss: 0.4869
Epoch 4 Step 201 Train Loss: 0.5193
Epoch 4 Step 251 Train Loss: 0.4413
Epoch 4: Train Overall MSE: 0.0006 Validation Overall MSE: 0.0005. 
Train Top 20 DE MSE: 0.0029 Validation Top 20 DE MSE: 0.0034. 
Epoch 5 Step 1 Train Loss: 0.4724
Epoch 5 Step 51 Train Loss: 0.5385
Epoch 5 Step 101 Train Loss: 0.5058
Epoch 5 Step 151 Train Loss: 0.4252
Epoch 5 Step 201 Train Loss: 0.5801
Epoch 5 Step 251 Train Loss: 0.5550
Epoch 5: Train Overall MSE: 0.0006 Validation Overall MSE: 0.0006. 
Train Top 20 DE MSE: 0.0028 Validation Top 20 DE MSE: 0.0026. 
Epoch 6 Step 1 Train Loss: 0.5491
Epoch 6 Step 51 Train Loss: 0.5028
Epoch 6 Step 101 Train Loss: 0.5391
Epoch 6 Step 151 Train Loss: 0.4802
Epoch 6 Step 201 Train Loss: 0.4385
Epoch 6 Step 251 Train Loss: 0.3970
Epoch 6: Train Overall MSE: 0.0006 Validation Overall MSE: 0.0006. 
Train Top 20 DE MSE: 0.0030 Validation Top 20 DE MSE: 0.0024. 
Epoch 7 Step 1 Train Loss: 0.3967
Epoch 7 Step 51 Train Loss: 0.4386
Epoch 7 Step 101 Train Loss: 0.4961
Epoch 7 Step 151 Train Loss: 0.4582
Epoch 7 Step 201 Train Loss: 0.4531
Epoch 7 Step 251 Train Loss: 0.5622
Epoch 7: Train Overall MSE: 0.0006 Validation Overall MSE: 0.0004. 
Train Top 20 DE MSE: 0.0029 Validation Top 20 DE MSE: 0.0027. 
Epoch 8 Step 1 Train Loss: 0.5537
Epoch 8 Step 51 Train Loss: 0.4285
Epoch 8 Step 101 Train Loss: 0.4867
Epoch 8 Step 151 Train Loss: 0.5144
Epoch 8 Step 201 Train Loss: 0.4435
Epoch 8 Step 251 Train Loss: 0.5012
Epoch 8: Train Overall MSE: 0.0006 Validation Overall MSE: 0.0005. 
Train Top 20 DE MSE: 0.0028 Validation Top 20 DE MSE: 0.0023. 
Epoch 9 Step 1 Train Loss: 0.5027
Epoch 9 Step 51 Train Loss: 0.4722
Epoch 9 Step 101 Train Loss: 0.4769
Epoch 9 Step 151 Train Loss: 0.4462
Epoch 9 Step 201 Train Loss: 0.4910
Epoch 9 Step 251 Train Loss: 0.5184
Epoch 9: Train Overall MSE: 0.0006 Validation Overall MSE: 0.0005. 
Train Top 20 DE MSE: 0.0028 Validation Top 20 DE MSE: 0.0026. 
Epoch 10 Step 1 Train Loss: 0.4785
Epoch 10 Step 51 Train Loss: 0.4585
Epoch 10 Step 101 Train Loss: 0.4576
Epoch 10 Step 151 Train Loss: 0.4800
Epoch 10 Step 201 Train Loss: 0.5073
Epoch 10 Step 251 Train Loss: 0.4851
Epoch 10: Train Overall MSE: 0.0006 Validation Overall MSE: 0.0005. 
Train Top 20 DE MSE: 0.0028 Validation Top 20 DE MSE: 0.0024. 
Epoch 11 Step 1 Train Loss: 0.4953
Epoch 11 Step 51 Train Loss: 0.4785
Epoch 11 Step 101 Train Loss: 0.4985
Epoch 11 Step 151 Train Loss: 0.5054
Epoch 11 Step 201 Train Loss: 0.5474
Epoch 11 Step 251 Train Loss: 0.4298
Epoch 11: Train Overall MSE: 0.0006 Validation Overall MSE: 0.0004. 
Train Top 20 DE MSE: 0.0027 Validation Top 20 DE MSE: 0.0027. 
Epoch 12 Step 1 Train Loss: 0.4516
Epoch 12 Step 51 Train Loss: 0.4842
Epoch 12 Step 101 Train Loss: 0.4058
Epoch 12 Step 151 Train Loss: 0.4799
Epoch 12 Step 201 Train Loss: 0.4180
Epoch 12 Step 251 Train Loss: 0.4934
Epoch 12: Train Overall MSE: 0.0005 Validation Overall MSE: 0.0004. 
Train Top 20 DE MSE: 0.0028 Validation Top 20 DE MSE: 0.0026. 
Epoch 13 Step 1 Train Loss: 0.5023
Epoch 13 Step 51 Train Loss: 0.4604
Epoch 13 Step 101 Train Loss: 0.3959
Epoch 13 Step 151 Train Loss: 0.5379
Epoch 13 Step 201 Train Loss: 0.4834
Epoch 13 Step 251 Train Loss: 0.4521
Epoch 13: Train Overall MSE: 0.0005 Validation Overall MSE: 0.0004. 
Train Top 20 DE MSE: 0.0028 Validation Top 20 DE MSE: 0.0027. 
Epoch 14 Step 1 Train Loss: 0.4620
Epoch 14 Step 51 Train Loss: 0.5075
Epoch 14 Step 101 Train Loss: 0.5545
Epoch 14 Step 151 Train Loss: 0.3875
Epoch 14 Step 201 Train Loss: 0.5244
Epoch 14 Step 251 Train Loss: 0.5581
Epoch 14: Train Overall MSE: 0.0006 Validation Overall MSE: 0.0005. 
Train Top 20 DE MSE: 0.0028 Validation Top 20 DE MSE: 0.0027. 
Epoch 15 Step 1 Train Loss: 0.4290
Epoch 15 Step 51 Train Loss: 0.4846
Epoch 15 Step 101 Train Loss: 0.5438
Epoch 15 Step 151 Train Loss: 0.5365
Epoch 15 Step 201 Train Loss: 0.5701
Epoch 15 Step 251 Train Loss: 0.4569
Epoch 15: Train Overall MSE: 0.0006 Validation Overall MSE: 0.0005. 
Train Top 20 DE MSE: 0.0028 Validation Top 20 DE MSE: 0.0026. 
Done!
Start Testing...
Best performing model: Test Top 20 DE MSE: 0.0031
Start doing subgroup analysis for simulation split...
test_combo_seen0_mse: nan
test_combo_seen0_pearson: nan
test_combo_seen0_mse_de: nan
test_combo_seen0_pearson_de: nan
test_combo_seen1_mse: nan
test_combo_seen1_pearson: nan
test_combo_seen1_mse_de: nan
test_combo_seen1_pearson_de: nan
test_combo_seen2_mse: nan
test_combo_seen2_pearson: nan
test_combo_seen2_mse_de: nan
test_combo_seen2_pearson_de: nan
test_unseen_single_mse: 0.0005897083
test_unseen_single_pearson: 0.9989159454068112
test_unseen_single_mse_de: 0.0030675624
test_unseen_single_pearson_de: 0.9994214727541758
test_combo_seen0_pearson_delta: nan
test_combo_seen0_frac_opposite_direction_top20_non_dropout: nan
test_combo_seen0_frac_sigma_below_1_non_dropout: nan
test_combo_seen0_mse_top20_de_non_dropout: nan
test_combo_seen1_pearson_delta: nan
test_combo_seen1_frac_opposite_direction_top20_non_dropout: nan
test_combo_seen1_frac_sigma_below_1_non_dropout: nan
test_combo_seen1_mse_top20_de_non_dropout: nan
test_combo_seen2_pearson_delta: nan
test_combo_seen2_frac_opposite_direction_top20_non_dropout: nan
test_combo_seen2_frac_sigma_below_1_non_dropout: nan
test_combo_seen2_mse_top20_de_non_dropout: nan
test_unseen_single_pearson_delta: 0.39734618246986847
test_unseen_single_frac_opposite_direction_top20_non_dropout: 0.08333333333333333
test_unseen_single_frac_sigma_below_1_non_dropout: 1.0
test_unseen_single_mse_top20_de_non_dropout: 0.0030675622952603173
Done!
Creating new splits....
Saving new splits at /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03final/dixit_gsm2396858/splits/dixit_gsm2396858_simulation_4_0.75.pkl
Simulation split test composition:
combo_seen0:0
combo_seen1:0
combo_seen2:0
unseen_single:3
Done!
Creating dataloaders....
Done!
Start Training...
Epoch 1 Step 1 Train Loss: 1.0701
Epoch 1 Step 51 Train Loss: 0.5721
Epoch 1 Step 101 Train Loss: 0.5320
Epoch 1 Step 151 Train Loss: 0.5298
Epoch 1 Step 201 Train Loss: 0.5125
Epoch 1 Step 251 Train Loss: 0.4528
Epoch 1 Step 301 Train Loss: 0.4377
Epoch 1: Train Overall MSE: 0.0018 Validation Overall MSE: 0.0007. 
Train Top 20 DE MSE: 0.0069 Validation Top 20 DE MSE: 0.0019. 
Epoch 2 Step 1 Train Loss: 0.4767
Epoch 2 Step 51 Train Loss: 0.4129
Epoch 2 Step 101 Train Loss: 0.4954
Epoch 2 Step 151 Train Loss: 0.4441
Epoch 2 Step 201 Train Loss: 0.4299
Epoch 2 Step 251 Train Loss: 0.4595
Epoch 2 Step 301 Train Loss: 0.4912
Epoch 2: Train Overall MSE: 0.0007 Validation Overall MSE: 0.0003. 
Train Top 20 DE MSE: 0.0038 Validation Top 20 DE MSE: 0.0017. 
Epoch 3 Step 1 Train Loss: 0.4474
Epoch 3 Step 51 Train Loss: 0.4684
Epoch 3 Step 101 Train Loss: 0.4488
Epoch 3 Step 151 Train Loss: 0.5024
Epoch 3 Step 201 Train Loss: 0.4334
Epoch 3 Step 251 Train Loss: 0.4275
Epoch 3 Step 301 Train Loss: 0.4194
Epoch 3: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0006. 
Train Top 20 DE MSE: 0.0026 Validation Top 20 DE MSE: 0.0021. 
Epoch 4 Step 1 Train Loss: 0.4176
Epoch 4 Step 51 Train Loss: 0.5177
Epoch 4 Step 101 Train Loss: 0.5145
Epoch 4 Step 151 Train Loss: 0.4096
Epoch 4 Step 201 Train Loss: 0.4581
Epoch 4 Step 251 Train Loss: 0.4371
Epoch 4 Step 301 Train Loss: 0.5171
Epoch 4: Train Overall MSE: 0.0005 Validation Overall MSE: 0.0004. 
Train Top 20 DE MSE: 0.0028 Validation Top 20 DE MSE: 0.0018. 
Epoch 5 Step 1 Train Loss: 0.4201
Epoch 5 Step 51 Train Loss: 0.4962
Epoch 5 Step 101 Train Loss: 0.3836
Epoch 5 Step 151 Train Loss: 0.4253
Epoch 5 Step 201 Train Loss: 0.4789
Epoch 5 Step 251 Train Loss: 0.4125
Epoch 5 Step 301 Train Loss: 0.4635
Epoch 5: Train Overall MSE: 0.0004 Validation Overall MSE: 0.0004. 
Train Top 20 DE MSE: 0.0019 Validation Top 20 DE MSE: 0.0014. 
Epoch 6 Step 1 Train Loss: 0.4693
Epoch 6 Step 51 Train Loss: 0.4695
Epoch 6 Step 101 Train Loss: 0.4137
Epoch 6 Step 151 Train Loss: 0.5556
Epoch 6 Step 201 Train Loss: 0.4645
Epoch 6 Step 251 Train Loss: 0.5307
Epoch 6 Step 301 Train Loss: 0.4791
Epoch 6: Train Overall MSE: 0.0004 Validation Overall MSE: 0.0004. 
Train Top 20 DE MSE: 0.0018 Validation Top 20 DE MSE: 0.0018. 
Epoch 7 Step 1 Train Loss: 0.5176
Epoch 7 Step 51 Train Loss: 0.4337
Epoch 7 Step 101 Train Loss: 0.5020
Epoch 7 Step 151 Train Loss: 0.4368
Epoch 7 Step 201 Train Loss: 0.4980
Epoch 7 Step 251 Train Loss: 0.4511
Epoch 7 Step 301 Train Loss: 0.4496
Epoch 7: Train Overall MSE: 0.0004 Validation Overall MSE: 0.0004. 
Train Top 20 DE MSE: 0.0017 Validation Top 20 DE MSE: 0.0015. 
Epoch 8 Step 1 Train Loss: 0.4993
Epoch 8 Step 51 Train Loss: 0.5070
Epoch 8 Step 101 Train Loss: 0.4305
Epoch 8 Step 151 Train Loss: 0.4943
Epoch 8 Step 201 Train Loss: 0.4426
Epoch 8 Step 251 Train Loss: 0.4527
Epoch 8 Step 301 Train Loss: 0.4979
Epoch 8: Train Overall MSE: 0.0004 Validation Overall MSE: 0.0004. 
Train Top 20 DE MSE: 0.0017 Validation Top 20 DE MSE: 0.0017. 
Epoch 9 Step 1 Train Loss: 0.4270
Epoch 9 Step 51 Train Loss: 0.3879
Epoch 9 Step 101 Train Loss: 0.4895
Epoch 9 Step 151 Train Loss: 0.4325
Epoch 9 Step 201 Train Loss: 0.4816
Epoch 9 Step 251 Train Loss: 0.4075
Epoch 9 Step 301 Train Loss: 0.4899
Epoch 9: Train Overall MSE: 0.0004 Validation Overall MSE: 0.0004. 
Train Top 20 DE MSE: 0.0017 Validation Top 20 DE MSE: 0.0018. 
Epoch 10 Step 1 Train Loss: 0.5798
Epoch 10 Step 51 Train Loss: 0.4671
Epoch 10 Step 101 Train Loss: 0.4436
Epoch 10 Step 151 Train Loss: 0.4293
Epoch 10 Step 201 Train Loss: 0.4273
Epoch 10 Step 251 Train Loss: 0.4899
Epoch 10 Step 301 Train Loss: 0.5147
Epoch 10: Train Overall MSE: 0.0004 Validation Overall MSE: 0.0004. 
Train Top 20 DE MSE: 0.0017 Validation Top 20 DE MSE: 0.0017. 
Epoch 11 Step 1 Train Loss: 0.4647
Epoch 11 Step 51 Train Loss: 0.4468
Epoch 11 Step 101 Train Loss: 0.4946
Epoch 11 Step 151 Train Loss: 0.4623
Epoch 11 Step 201 Train Loss: 0.4393
Epoch 11 Step 251 Train Loss: 0.4886
Epoch 11 Step 301 Train Loss: 0.5425
Epoch 11: Train Overall MSE: 0.0004 Validation Overall MSE: 0.0004. 
Train Top 20 DE MSE: 0.0017 Validation Top 20 DE MSE: 0.0018. 
Epoch 12 Step 1 Train Loss: 0.4320
Epoch 12 Step 51 Train Loss: 0.4099
Epoch 12 Step 101 Train Loss: 0.4669
Epoch 12 Step 151 Train Loss: 0.4776
Epoch 12 Step 201 Train Loss: 0.5672
Epoch 12 Step 251 Train Loss: 0.4381
Epoch 12 Step 301 Train Loss: 0.4990
Epoch 12: Train Overall MSE: 0.0004 Validation Overall MSE: 0.0004. 
Train Top 20 DE MSE: 0.0018 Validation Top 20 DE MSE: 0.0017. 
Epoch 13 Step 1 Train Loss: 0.4890
Epoch 13 Step 51 Train Loss: 0.4186
Epoch 13 Step 101 Train Loss: 0.4415
Epoch 13 Step 151 Train Loss: 0.4535
Epoch 13 Step 201 Train Loss: 0.4995
Epoch 13 Step 251 Train Loss: 0.4782
Epoch 13 Step 301 Train Loss: 0.4638
Epoch 13: Train Overall MSE: 0.0004 Validation Overall MSE: 0.0004. 
Train Top 20 DE MSE: 0.0017 Validation Top 20 DE MSE: 0.0017. 
Epoch 14 Step 1 Train Loss: 0.4920
Epoch 14 Step 51 Train Loss: 0.4299
Epoch 14 Step 101 Train Loss: 0.4796
Epoch 14 Step 151 Train Loss: 0.5122
Epoch 14 Step 201 Train Loss: 0.5105
Epoch 14 Step 251 Train Loss: 0.4822
Epoch 14 Step 301 Train Loss: 0.5080
Epoch 14: Train Overall MSE: 0.0004 Validation Overall MSE: 0.0004. 
Train Top 20 DE MSE: 0.0017 Validation Top 20 DE MSE: 0.0018. 
Epoch 15 Step 1 Train Loss: 0.5802
Epoch 15 Step 51 Train Loss: 0.4817
Epoch 15 Step 101 Train Loss: 0.6473
Epoch 15 Step 151 Train Loss: 0.4725
Epoch 15 Step 201 Train Loss: 0.5153
Epoch 15 Step 251 Train Loss: 0.4392
Epoch 15 Step 301 Train Loss: 0.4419
Epoch 15: Train Overall MSE: 0.0004 Validation Overall MSE: 0.0004. 
Train Top 20 DE MSE: 0.0017 Validation Top 20 DE MSE: 0.0018. 
Done!
Start Testing...
Best performing model: Test Top 20 DE MSE: 0.0010
Start doing subgroup analysis for simulation split...
test_combo_seen0_mse: nan
test_combo_seen0_pearson: nan
test_combo_seen0_mse_de: nan
test_combo_seen0_pearson_de: nan
test_combo_seen1_mse: nan
test_combo_seen1_pearson: nan
test_combo_seen1_mse_de: nan
test_combo_seen1_pearson_de: nan
test_combo_seen2_mse: nan
test_combo_seen2_pearson: nan
test_combo_seen2_mse_de: nan
test_combo_seen2_pearson_de: nan
test_unseen_single_mse: 0.00044756057
test_unseen_single_pearson: 0.9991993285682331
test_unseen_single_mse_de: 0.0009868086
test_unseen_single_pearson_de: 0.9998918943670215
test_combo_seen0_pearson_delta: nan
test_combo_seen0_frac_opposite_direction_top20_non_dropout: nan
test_combo_seen0_frac_sigma_below_1_non_dropout: nan
test_combo_seen0_mse_top20_de_non_dropout: nan
test_combo_seen1_pearson_delta: nan
test_combo_seen1_frac_opposite_direction_top20_non_dropout: nan
test_combo_seen1_frac_sigma_below_1_non_dropout: nan
test_combo_seen1_mse_top20_de_non_dropout: nan
test_combo_seen2_pearson_delta: nan
test_combo_seen2_frac_opposite_direction_top20_non_dropout: nan
test_combo_seen2_frac_sigma_below_1_non_dropout: nan
test_combo_seen2_mse_top20_de_non_dropout: nan
test_unseen_single_pearson_delta: 0.4299061200828172
test_unseen_single_frac_opposite_direction_top20_non_dropout: 0.05000000000000001
test_unseen_single_frac_sigma_below_1_non_dropout: 1.0
test_unseen_single_mse_top20_de_non_dropout: 0.0010920281536707687
Done!
Creating new splits....
Saving new splits at /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03final/dixit_gsm2396858/splits/dixit_gsm2396858_simulation_5_0.75.pkl
Simulation split test composition:
combo_seen0:0
combo_seen1:0
combo_seen2:0
unseen_single:3
Done!
Creating dataloaders....
Done!
Start Training...
Epoch 1 Step 1 Train Loss: 1.7566
Epoch 1 Step 51 Train Loss: 0.7300
Epoch 1 Step 101 Train Loss: 0.6257
Epoch 1 Step 151 Train Loss: 0.5744
Epoch 1 Step 201 Train Loss: 0.6107
Epoch 1 Step 251 Train Loss: 0.5741
Epoch 1: Train Overall MSE: 0.0021 Validation Overall MSE: 0.0015. 
Train Top 20 DE MSE: 0.0054 Validation Top 20 DE MSE: 0.0038. 
Epoch 2 Step 1 Train Loss: 0.5565
Epoch 2 Step 51 Train Loss: 0.5339
Epoch 2 Step 101 Train Loss: 0.4528
Epoch 2 Step 151 Train Loss: 0.5118
Epoch 2 Step 201 Train Loss: 0.4910
Epoch 2 Step 251 Train Loss: 0.5745
Epoch 2: Train Overall MSE: 0.0013 Validation Overall MSE: 0.0010. 
Train Top 20 DE MSE: 0.0030 Validation Top 20 DE MSE: 0.0029. 
Epoch 3 Step 1 Train Loss: 0.5124
Epoch 3 Step 51 Train Loss: 0.4749
Epoch 3 Step 101 Train Loss: 0.5041
Epoch 3 Step 151 Train Loss: 0.5260
Epoch 3 Step 201 Train Loss: 0.4492
Epoch 3 Step 251 Train Loss: 0.4277
Epoch 3: Train Overall MSE: 0.0010 Validation Overall MSE: 0.0007. 
Train Top 20 DE MSE: 0.0028 Validation Top 20 DE MSE: 0.0029. 
Epoch 4 Step 1 Train Loss: 0.5145
Epoch 4 Step 51 Train Loss: 0.5311
Epoch 4 Step 101 Train Loss: 0.4956
Epoch 4 Step 151 Train Loss: 0.4285
Epoch 4 Step 201 Train Loss: 0.4301
Epoch 4 Step 251 Train Loss: 0.4403
Epoch 4: Train Overall MSE: 0.0008 Validation Overall MSE: 0.0005. 
Train Top 20 DE MSE: 0.0023 Validation Top 20 DE MSE: 0.0023. 
Epoch 5 Step 1 Train Loss: 0.4941
Epoch 5 Step 51 Train Loss: 0.4419
Epoch 5 Step 101 Train Loss: 0.4629
Epoch 5 Step 151 Train Loss: 0.4972
Epoch 5 Step 201 Train Loss: 0.4713
Epoch 5 Step 251 Train Loss: 0.4733
Epoch 5: Train Overall MSE: 0.0007 Validation Overall MSE: 0.0004. 
Train Top 20 DE MSE: 0.0022 Validation Top 20 DE MSE: 0.0027. 
Epoch 6 Step 1 Train Loss: 0.4621
Epoch 6 Step 51 Train Loss: 0.5023
Epoch 6 Step 101 Train Loss: 0.4836
Epoch 6 Step 151 Train Loss: 0.5060
Epoch 6 Step 201 Train Loss: 0.4471
Epoch 6 Step 251 Train Loss: 0.4886
Epoch 6: Train Overall MSE: 0.0007 Validation Overall MSE: 0.0004. 
Train Top 20 DE MSE: 0.0020 Validation Top 20 DE MSE: 0.0030. 
Epoch 7 Step 1 Train Loss: 0.4749
Epoch 7 Step 51 Train Loss: 0.4568
Epoch 7 Step 101 Train Loss: 0.5980
Epoch 7 Step 151 Train Loss: 0.4473
Epoch 7 Step 201 Train Loss: 0.5962
Epoch 7 Step 251 Train Loss: 0.4860
Epoch 7: Train Overall MSE: 0.0007 Validation Overall MSE: 0.0004. 
Train Top 20 DE MSE: 0.0022 Validation Top 20 DE MSE: 0.0028. 
Epoch 8 Step 1 Train Loss: 0.5247
Epoch 8 Step 51 Train Loss: 0.4790
Epoch 8 Step 101 Train Loss: 0.4277
Epoch 8 Step 151 Train Loss: 0.4329
Epoch 8 Step 201 Train Loss: 0.4518
Epoch 8 Step 251 Train Loss: 0.5216
Epoch 8: Train Overall MSE: 0.0007 Validation Overall MSE: 0.0005. 
Train Top 20 DE MSE: 0.0020 Validation Top 20 DE MSE: 0.0027. 
Epoch 9 Step 1 Train Loss: 0.5203
Epoch 9 Step 51 Train Loss: 0.5332
Epoch 9 Step 101 Train Loss: 0.4778
Epoch 9 Step 151 Train Loss: 0.4697
Epoch 9 Step 201 Train Loss: 0.4945
Epoch 9 Step 251 Train Loss: 0.4930
Epoch 9: Train Overall MSE: 0.0007 Validation Overall MSE: 0.0004. 
Train Top 20 DE MSE: 0.0021 Validation Top 20 DE MSE: 0.0028. 
Epoch 10 Step 1 Train Loss: 0.5147
Epoch 10 Step 51 Train Loss: 0.4722
Epoch 10 Step 101 Train Loss: 0.4790
Epoch 10 Step 151 Train Loss: 0.5335
Epoch 10 Step 201 Train Loss: 0.4638
Epoch 10 Step 251 Train Loss: 0.5049
Epoch 10: Train Overall MSE: 0.0007 Validation Overall MSE: 0.0004. 
Train Top 20 DE MSE: 0.0021 Validation Top 20 DE MSE: 0.0027. 
Epoch 11 Step 1 Train Loss: 0.4719
Epoch 11 Step 51 Train Loss: 0.4651
Epoch 11 Step 101 Train Loss: 0.5733
Epoch 11 Step 151 Train Loss: 0.5005
Epoch 11 Step 201 Train Loss: 0.5001
Epoch 11 Step 251 Train Loss: 0.5135
Epoch 11: Train Overall MSE: 0.0007 Validation Overall MSE: 0.0004. 
Train Top 20 DE MSE: 0.0021 Validation Top 20 DE MSE: 0.0028. 
Epoch 12 Step 1 Train Loss: 0.4770
Epoch 12 Step 51 Train Loss: 0.5762
Epoch 12 Step 101 Train Loss: 0.5064
Epoch 12 Step 151 Train Loss: 0.4313
Epoch 12 Step 201 Train Loss: 0.5150
Epoch 12 Step 251 Train Loss: 0.5711
Epoch 12: Train Overall MSE: 0.0007 Validation Overall MSE: 0.0004. 
Train Top 20 DE MSE: 0.0020 Validation Top 20 DE MSE: 0.0029. 
Epoch 13 Step 1 Train Loss: 0.4259
Epoch 13 Step 51 Train Loss: 0.4320
Epoch 13 Step 101 Train Loss: 0.4673
Epoch 13 Step 151 Train Loss: 0.5031
Epoch 13 Step 201 Train Loss: 0.4849
Epoch 13 Step 251 Train Loss: 0.4350
Epoch 13: Train Overall MSE: 0.0007 Validation Overall MSE: 0.0004. 
Train Top 20 DE MSE: 0.0021 Validation Top 20 DE MSE: 0.0029. 
Epoch 14 Step 1 Train Loss: 0.4444
Epoch 14 Step 51 Train Loss: 0.5778
Epoch 14 Step 101 Train Loss: 0.4693
Epoch 14 Step 151 Train Loss: 0.4342
Epoch 14 Step 201 Train Loss: 0.5245
Epoch 14 Step 251 Train Loss: 0.5121
Epoch 14: Train Overall MSE: 0.0007 Validation Overall MSE: 0.0004. 
Train Top 20 DE MSE: 0.0020 Validation Top 20 DE MSE: 0.0028. 
Epoch 15 Step 1 Train Loss: 0.4795
Epoch 15 Step 51 Train Loss: 0.4557
Epoch 15 Step 101 Train Loss: 0.6212
Epoch 15 Step 151 Train Loss: 0.4610
Epoch 15 Step 201 Train Loss: 0.4658
Epoch 15 Step 251 Train Loss: 0.5284
Epoch 15: Train Overall MSE: 0.0007 Validation Overall MSE: 0.0004. 
Train Top 20 DE MSE: 0.0021 Validation Top 20 DE MSE: 0.0027. 
Done!
Start Testing...
Best performing model: Test Top 20 DE MSE: 0.0020
Start doing subgroup analysis for simulation split...
test_combo_seen0_mse: nan
test_combo_seen0_pearson: nan
test_combo_seen0_mse_de: nan
test_combo_seen0_pearson_de: nan
test_combo_seen1_mse: nan
test_combo_seen1_pearson: nan
test_combo_seen1_mse_de: nan
test_combo_seen1_pearson_de: nan
test_combo_seen2_mse: nan
test_combo_seen2_pearson: nan
test_combo_seen2_mse_de: nan
test_combo_seen2_pearson_de: nan
test_unseen_single_mse: 0.0005514698
test_unseen_single_pearson: 0.9989890858115983
test_unseen_single_mse_de: 0.001992263
test_unseen_single_pearson_de: 0.9996537698848086
test_combo_seen0_pearson_delta: nan
test_combo_seen0_frac_opposite_direction_top20_non_dropout: nan
test_combo_seen0_frac_sigma_below_1_non_dropout: nan
test_combo_seen0_mse_top20_de_non_dropout: nan
test_combo_seen1_pearson_delta: nan
test_combo_seen1_frac_opposite_direction_top20_non_dropout: nan
test_combo_seen1_frac_sigma_below_1_non_dropout: nan
test_combo_seen1_mse_top20_de_non_dropout: nan
test_combo_seen2_pearson_delta: nan
test_combo_seen2_frac_opposite_direction_top20_non_dropout: nan
test_combo_seen2_frac_sigma_below_1_non_dropout: nan
test_combo_seen2_mse_top20_de_non_dropout: nan
test_unseen_single_pearson_delta: 0.3613314209026241
test_unseen_single_frac_opposite_direction_top20_non_dropout: 0.016666666666666666
test_unseen_single_frac_sigma_below_1_non_dropout: 1.0
test_unseen_single_mse_top20_de_non_dropout: 0.0020789382442862733
Done!
Found local copy...
Creating pyg object for each cell in the data...
Creating dataset file...
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [02:40<34:48, 160.66s/it] 14%|█▍        | 2/14 [04:31<26:17, 131.44s/it] 21%|██▏       | 3/14 [04:52<14:51, 81.06s/it]  29%|██▊       | 4/14 [05:39<11:14, 67.44s/it] 36%|███▌      | 5/14 [06:18<08:35, 57.27s/it] 43%|████▎     | 6/14 [07:40<08:44, 65.55s/it] 50%|█████     | 7/14 [09:04<08:21, 71.60s/it] 57%|█████▋    | 8/14 [09:05<04:54, 49.06s/it] 64%|██████▍   | 9/14 [11:00<05:48, 69.67s/it] 71%|███████▏  | 10/14 [12:05<04:33, 68.33s/it] 79%|███████▊  | 11/14 [14:55<04:58, 99.44s/it] 86%|████████▌ | 12/14 [16:30<03:16, 98.04s/it] 93%|█████████▎| 13/14 [16:58<01:16, 76.95s/it]100%|██████████| 14/14 [17:36<00:00, 65.04s/it]100%|██████████| 14/14 [17:36<00:00, 75.44s/it]
Done!
Saving new dataset pyg object at /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03final/dixit_gsm2396861/data_pyg/cell_graphs.pkl
Done!
Local copy of split is detected. Loading...
Simulation split test composition:
combo_seen0:0
combo_seen1:0
combo_seen2:0
unseen_single:4
Done!
Creating dataloaders....
Done!
Start Training...
Epoch 1 Step 1 Train Loss: 1.1449
Epoch 1 Step 51 Train Loss: 0.7641
Epoch 1 Step 101 Train Loss: 0.5858
Epoch 1 Step 151 Train Loss: 0.6252
Epoch 1 Step 201 Train Loss: 0.5999
Epoch 1: Train Overall MSE: 0.0025 Validation Overall MSE: 0.0007. 
Train Top 20 DE MSE: 0.0036 Validation Top 20 DE MSE: 0.0050. 
Epoch 2 Step 1 Train Loss: 0.6147
Epoch 2 Step 51 Train Loss: 0.6501
Epoch 2 Step 101 Train Loss: 0.5481
Epoch 2 Step 151 Train Loss: 0.5095
Epoch 2 Step 201 Train Loss: 0.5015
Epoch 2: Train Overall MSE: 0.0011 Validation Overall MSE: 0.0005. 
Train Top 20 DE MSE: 0.0025 Validation Top 20 DE MSE: 0.0044. 
Epoch 3 Step 1 Train Loss: 0.4902
Epoch 3 Step 51 Train Loss: 0.6148
Epoch 3 Step 101 Train Loss: 0.5972
Epoch 3 Step 151 Train Loss: 0.6100
Epoch 3 Step 201 Train Loss: 0.5584
Epoch 3: Train Overall MSE: 0.0013 Validation Overall MSE: 0.0007. 
Train Top 20 DE MSE: 0.0028 Validation Top 20 DE MSE: 0.0034. 
Epoch 4 Step 1 Train Loss: 0.5864
Epoch 4 Step 51 Train Loss: 0.5045
Epoch 4 Step 101 Train Loss: 0.5203
Epoch 4 Step 151 Train Loss: 0.6903
Epoch 4 Step 201 Train Loss: 0.5813
Epoch 4: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0006. 
Train Top 20 DE MSE: 0.0020 Validation Top 20 DE MSE: 0.0031. 
Epoch 5 Step 1 Train Loss: 0.6293
Epoch 5 Step 51 Train Loss: 0.5369
Epoch 5 Step 101 Train Loss: 0.6023
Epoch 5 Step 151 Train Loss: 0.7184
Epoch 5 Step 201 Train Loss: 0.6088
Epoch 5: Train Overall MSE: 0.0008 Validation Overall MSE: 0.0006. 
Train Top 20 DE MSE: 0.0023 Validation Top 20 DE MSE: 0.0035. 
Epoch 6 Step 1 Train Loss: 0.6106
Epoch 6 Step 51 Train Loss: 0.5990
Epoch 6 Step 101 Train Loss: 0.5401
Epoch 6 Step 151 Train Loss: 0.6445
Epoch 6 Step 201 Train Loss: 0.6587
Epoch 6: Train Overall MSE: 0.0008 Validation Overall MSE: 0.0006. 
Train Top 20 DE MSE: 0.0019 Validation Top 20 DE MSE: 0.0037. 
Epoch 7 Step 1 Train Loss: 0.7936
Epoch 7 Step 51 Train Loss: 0.6989
Epoch 7 Step 101 Train Loss: 0.5373
Epoch 7 Step 151 Train Loss: 0.5023
Epoch 7 Step 201 Train Loss: 0.5583
Epoch 7: Train Overall MSE: 0.0008 Validation Overall MSE: 0.0007. 
Train Top 20 DE MSE: 0.0020 Validation Top 20 DE MSE: 0.0031. 
Epoch 8 Step 1 Train Loss: 0.6723
Epoch 8 Step 51 Train Loss: 0.5727
Epoch 8 Step 101 Train Loss: 0.5487
Epoch 8 Step 151 Train Loss: 0.5844
Epoch 8 Step 201 Train Loss: 0.5473
Epoch 8: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0007. 
Train Top 20 DE MSE: 0.0021 Validation Top 20 DE MSE: 0.0033. 
Epoch 9 Step 1 Train Loss: 0.5730
Epoch 9 Step 51 Train Loss: 0.7251
Epoch 9 Step 101 Train Loss: 0.5722
Epoch 9 Step 151 Train Loss: 0.5265
Epoch 9 Step 201 Train Loss: 0.6484
Epoch 9: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0007. 
Train Top 20 DE MSE: 0.0020 Validation Top 20 DE MSE: 0.0033. 
Epoch 10 Step 1 Train Loss: 0.5832
Epoch 10 Step 51 Train Loss: 0.4814
Epoch 10 Step 101 Train Loss: 0.5439
Epoch 10 Step 151 Train Loss: 0.6458
Epoch 10 Step 201 Train Loss: 0.5484
Epoch 10: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0007. 
Train Top 20 DE MSE: 0.0019 Validation Top 20 DE MSE: 0.0030. 
Epoch 11 Step 1 Train Loss: 0.5424
Epoch 11 Step 51 Train Loss: 0.6307
Epoch 11 Step 101 Train Loss: 0.5290
Epoch 11 Step 151 Train Loss: 0.5397
Epoch 11 Step 201 Train Loss: 0.6021
Epoch 11: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0007. 
Train Top 20 DE MSE: 0.0019 Validation Top 20 DE MSE: 0.0031. 
Epoch 12 Step 1 Train Loss: 0.5110
Epoch 12 Step 51 Train Loss: 0.6726
Epoch 12 Step 101 Train Loss: 0.6154
Epoch 12 Step 151 Train Loss: 0.4670
Epoch 12 Step 201 Train Loss: 0.6902
Epoch 12: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0007. 
Train Top 20 DE MSE: 0.0019 Validation Top 20 DE MSE: 0.0030. 
Epoch 13 Step 1 Train Loss: 0.5244
Epoch 13 Step 51 Train Loss: 0.6800
Epoch 13 Step 101 Train Loss: 0.6879
Epoch 13 Step 151 Train Loss: 0.6771
Epoch 13 Step 201 Train Loss: 0.4847
Epoch 13: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0007. 
Train Top 20 DE MSE: 0.0020 Validation Top 20 DE MSE: 0.0032. 
Epoch 14 Step 1 Train Loss: 0.6041
Epoch 14 Step 51 Train Loss: 0.4803
Epoch 14 Step 101 Train Loss: 0.5445
Epoch 14 Step 151 Train Loss: 0.5632
Epoch 14 Step 201 Train Loss: 0.4770
Epoch 14: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0007. 
Train Top 20 DE MSE: 0.0019 Validation Top 20 DE MSE: 0.0034. 
Epoch 15 Step 1 Train Loss: 0.5869
Epoch 15 Step 51 Train Loss: 0.4694
Epoch 15 Step 101 Train Loss: 0.6625
Epoch 15 Step 151 Train Loss: 0.6384
Epoch 15 Step 201 Train Loss: 0.4507
Epoch 15: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0007. 
Train Top 20 DE MSE: 0.0020 Validation Top 20 DE MSE: 0.0033. 
Done!
Start Testing...
Best performing model: Test Top 20 DE MSE: 0.0028
Start doing subgroup analysis for simulation split...
test_combo_seen0_mse: nan
test_combo_seen0_pearson: nan
test_combo_seen0_mse_de: nan
test_combo_seen0_pearson_de: nan
test_combo_seen1_mse: nan
test_combo_seen1_pearson: nan
test_combo_seen1_mse_de: nan
test_combo_seen1_pearson_de: nan
test_combo_seen2_mse: nan
test_combo_seen2_pearson: nan
test_combo_seen2_mse_de: nan
test_combo_seen2_pearson_de: nan
test_unseen_single_mse: 0.0008774031
test_unseen_single_pearson: 0.9985558562190981
test_unseen_single_mse_de: 0.0028019133
test_unseen_single_pearson_de: 0.9992349866988606
test_combo_seen0_pearson_delta: nan
test_combo_seen0_frac_opposite_direction_top20_non_dropout: nan
test_combo_seen0_frac_sigma_below_1_non_dropout: nan
test_combo_seen0_mse_top20_de_non_dropout: nan
test_combo_seen1_pearson_delta: nan
test_combo_seen1_frac_opposite_direction_top20_non_dropout: nan
test_combo_seen1_frac_sigma_below_1_non_dropout: nan
test_combo_seen1_mse_top20_de_non_dropout: nan
test_combo_seen2_pearson_delta: nan
test_combo_seen2_frac_opposite_direction_top20_non_dropout: nan
test_combo_seen2_frac_sigma_below_1_non_dropout: nan
test_combo_seen2_mse_top20_de_non_dropout: nan
test_unseen_single_pearson_delta: 0.4066335897449376
test_unseen_single_frac_opposite_direction_top20_non_dropout: 0.075
test_unseen_single_frac_sigma_below_1_non_dropout: 1.0
test_unseen_single_mse_top20_de_non_dropout: 0.0032109403622749416
Done!
Creating new splits....
Saving new splits at /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03final/dixit_gsm2396861/splits/dixit_gsm2396861_simulation_2_0.75.pkl
Simulation split test composition:
combo_seen0:0
combo_seen1:0
combo_seen2:0
unseen_single:4
Done!
Creating dataloaders....
Done!
Start Training...
Epoch 1 Step 1 Train Loss: 1.1521
Epoch 1 Step 51 Train Loss: 0.6534
Epoch 1 Step 101 Train Loss: 0.6382
Epoch 1 Step 151 Train Loss: 0.6475
Epoch 1 Step 201 Train Loss: 0.5557
Epoch 1: Train Overall MSE: 0.0022 Validation Overall MSE: 0.0007. 
Train Top 20 DE MSE: 0.0019 Validation Top 20 DE MSE: 0.0026. 
Epoch 2 Step 1 Train Loss: 0.6047
Epoch 2 Step 51 Train Loss: 0.5690
Epoch 2 Step 101 Train Loss: 0.5532
Epoch 2 Step 151 Train Loss: 0.5572
Epoch 2 Step 201 Train Loss: 0.5440
Epoch 2: Train Overall MSE: 0.0021 Validation Overall MSE: 0.0005. 
Train Top 20 DE MSE: 0.0035 Validation Top 20 DE MSE: 0.0010. 
Epoch 3 Step 1 Train Loss: 0.4739
Epoch 3 Step 51 Train Loss: 0.5838
Epoch 3 Step 101 Train Loss: 0.5534
Epoch 3 Step 151 Train Loss: 0.5296
Epoch 3 Step 201 Train Loss: 0.5707
Epoch 3: Train Overall MSE: 0.0007 Validation Overall MSE: 0.0007. 
Train Top 20 DE MSE: 0.0027 Validation Top 20 DE MSE: 0.0009. 
Epoch 4 Step 1 Train Loss: 0.5220
Epoch 4 Step 51 Train Loss: 0.4916
Epoch 4 Step 101 Train Loss: 0.5189
Epoch 4 Step 151 Train Loss: 0.5673
Epoch 4 Step 201 Train Loss: 0.5553
Epoch 4: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0007. 
Train Top 20 DE MSE: 0.0021 Validation Top 20 DE MSE: 0.0014. 
Epoch 5 Step 1 Train Loss: 0.5739
Epoch 5 Step 51 Train Loss: 0.5310
Epoch 5 Step 101 Train Loss: 0.5668
Epoch 5 Step 151 Train Loss: 0.5101
Epoch 5 Step 201 Train Loss: 0.5455
Epoch 5: Train Overall MSE: 0.0010 Validation Overall MSE: 0.0005. 
Train Top 20 DE MSE: 0.0020 Validation Top 20 DE MSE: 0.0020. 
Epoch 6 Step 1 Train Loss: 0.6080
Epoch 6 Step 51 Train Loss: 0.5797
Epoch 6 Step 101 Train Loss: 0.5611
Epoch 6 Step 151 Train Loss: 0.4942
Epoch 6 Step 201 Train Loss: 0.8186
Epoch 6: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0006. 
Train Top 20 DE MSE: 0.0022 Validation Top 20 DE MSE: 0.0015. 
Epoch 7 Step 1 Train Loss: 0.5265
Epoch 7 Step 51 Train Loss: 0.4919
Epoch 7 Step 101 Train Loss: 0.5361
Epoch 7 Step 151 Train Loss: 0.5908
Epoch 7 Step 201 Train Loss: 0.5600
Epoch 7: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0008. 
Train Top 20 DE MSE: 0.0021 Validation Top 20 DE MSE: 0.0013. 
Epoch 8 Step 1 Train Loss: 0.6304
Epoch 8 Step 51 Train Loss: 0.5893
Epoch 8 Step 101 Train Loss: 0.5933
Epoch 8 Step 151 Train Loss: 0.4933
Epoch 8 Step 201 Train Loss: 0.5437
Epoch 8: Train Overall MSE: 0.0010 Validation Overall MSE: 0.0007. 
Train Top 20 DE MSE: 0.0025 Validation Top 20 DE MSE: 0.0012. 
Epoch 9 Step 1 Train Loss: 0.6456
Epoch 9 Step 51 Train Loss: 0.4958
Epoch 9 Step 101 Train Loss: 0.6314
Epoch 9 Step 151 Train Loss: 0.5185
Epoch 9 Step 201 Train Loss: 0.5588
Epoch 9: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0008. 
Train Top 20 DE MSE: 0.0022 Validation Top 20 DE MSE: 0.0014. 
Epoch 10 Step 1 Train Loss: 0.6522
Epoch 10 Step 51 Train Loss: 0.6122
Epoch 10 Step 101 Train Loss: 0.6232
Epoch 10 Step 151 Train Loss: 0.4985
Epoch 10 Step 201 Train Loss: 0.5813
Epoch 10: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0008. 
Train Top 20 DE MSE: 0.0023 Validation Top 20 DE MSE: 0.0013. 
Epoch 11 Step 1 Train Loss: 0.5352
Epoch 11 Step 51 Train Loss: 0.4872
Epoch 11 Step 101 Train Loss: 0.5764
Epoch 11 Step 151 Train Loss: 0.5981
Epoch 11 Step 201 Train Loss: 0.5946
Epoch 11: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0006. 
Train Top 20 DE MSE: 0.0024 Validation Top 20 DE MSE: 0.0010. 
Epoch 12 Step 1 Train Loss: 0.5341
Epoch 12 Step 51 Train Loss: 0.5787
Epoch 12 Step 101 Train Loss: 0.5509
Epoch 12 Step 151 Train Loss: 0.8053
Epoch 12 Step 201 Train Loss: 0.5224
Epoch 12: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0007. 
Train Top 20 DE MSE: 0.0023 Validation Top 20 DE MSE: 0.0012. 
Epoch 13 Step 1 Train Loss: 0.5399
Epoch 13 Step 51 Train Loss: 0.6849
Epoch 13 Step 101 Train Loss: 0.5691
Epoch 13 Step 151 Train Loss: 0.5907
Epoch 13 Step 201 Train Loss: 0.5722
Epoch 13: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0006. 
Train Top 20 DE MSE: 0.0023 Validation Top 20 DE MSE: 0.0010. 
Epoch 14 Step 1 Train Loss: 0.6340
Epoch 14 Step 51 Train Loss: 0.6805
Epoch 14 Step 101 Train Loss: 0.5869
Epoch 14 Step 151 Train Loss: 0.5006
Epoch 14 Step 201 Train Loss: 0.5219
Epoch 14: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0006. 
Train Top 20 DE MSE: 0.0023 Validation Top 20 DE MSE: 0.0010. 
Epoch 15 Step 1 Train Loss: 0.6087
Epoch 15 Step 51 Train Loss: 0.5957
Epoch 15 Step 101 Train Loss: 0.5578
Epoch 15 Step 151 Train Loss: 0.6995
Epoch 15 Step 201 Train Loss: 0.6911
Epoch 15: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0007. 
Train Top 20 DE MSE: 0.0023 Validation Top 20 DE MSE: 0.0011. 
Done!
Start Testing...
Best performing model: Test Top 20 DE MSE: 0.0024
Start doing subgroup analysis for simulation split...
test_combo_seen0_mse: nan
test_combo_seen0_pearson: nan
test_combo_seen0_mse_de: nan
test_combo_seen0_pearson_de: nan
test_combo_seen1_mse: nan
test_combo_seen1_pearson: nan
test_combo_seen1_mse_de: nan
test_combo_seen1_pearson_de: nan
test_combo_seen2_mse: nan
test_combo_seen2_pearson: nan
test_combo_seen2_mse_de: nan
test_combo_seen2_pearson_de: nan
test_unseen_single_mse: 0.00075659953
test_unseen_single_pearson: 0.9987851501447503
test_unseen_single_mse_de: 0.0024491013
test_unseen_single_pearson_de: 0.9994723718543101
test_combo_seen0_pearson_delta: nan
test_combo_seen0_frac_opposite_direction_top20_non_dropout: nan
test_combo_seen0_frac_sigma_below_1_non_dropout: nan
test_combo_seen0_mse_top20_de_non_dropout: nan
test_combo_seen1_pearson_delta: nan
test_combo_seen1_frac_opposite_direction_top20_non_dropout: nan
test_combo_seen1_frac_sigma_below_1_non_dropout: nan
test_combo_seen1_mse_top20_de_non_dropout: nan
test_combo_seen2_pearson_delta: nan
test_combo_seen2_frac_opposite_direction_top20_non_dropout: nan
test_combo_seen2_frac_sigma_below_1_non_dropout: nan
test_combo_seen2_mse_top20_de_non_dropout: nan
test_unseen_single_pearson_delta: 0.4716365051806135
test_unseen_single_frac_opposite_direction_top20_non_dropout: 0.07500000000000001
test_unseen_single_frac_sigma_below_1_non_dropout: 0.9875
test_unseen_single_mse_top20_de_non_dropout: 0.003097599845690904
Done!
Creating new splits....
Saving new splits at /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03final/dixit_gsm2396861/splits/dixit_gsm2396861_simulation_3_0.75.pkl
Simulation split test composition:
combo_seen0:0
combo_seen1:0
combo_seen2:0
unseen_single:4
Done!
Creating dataloaders....
Done!
Start Training...
Epoch 1 Step 1 Train Loss: 0.9020
Epoch 1 Step 51 Train Loss: 0.8815
Epoch 1 Step 101 Train Loss: 0.5697
Epoch 1 Step 151 Train Loss: 0.8402
Epoch 1 Step 201 Train Loss: 0.6325
Epoch 1: Train Overall MSE: 0.0052 Validation Overall MSE: 0.0020. 
Train Top 20 DE MSE: 0.0037 Validation Top 20 DE MSE: 0.0117. 
Epoch 2 Step 1 Train Loss: 0.6623
Epoch 2 Step 51 Train Loss: 0.5507
Epoch 2 Step 101 Train Loss: 0.5013
Epoch 2 Step 151 Train Loss: 0.6469
Epoch 2 Step 201 Train Loss: 0.6005
Epoch 2: Train Overall MSE: 0.0016 Validation Overall MSE: 0.0009. 
Train Top 20 DE MSE: 0.0033 Validation Top 20 DE MSE: 0.0039. 
Epoch 3 Step 1 Train Loss: 0.5851
Epoch 3 Step 51 Train Loss: 0.5703
Epoch 3 Step 101 Train Loss: 0.5876
Epoch 3 Step 151 Train Loss: 0.5131
Epoch 3 Step 201 Train Loss: 0.5482
Epoch 3: Train Overall MSE: 0.0011 Validation Overall MSE: 0.0008. 
Train Top 20 DE MSE: 0.0019 Validation Top 20 DE MSE: 0.0021. 
Epoch 4 Step 1 Train Loss: 0.5101
Epoch 4 Step 51 Train Loss: 0.5441
Epoch 4 Step 101 Train Loss: 0.6147
Epoch 4 Step 151 Train Loss: 0.5144
Epoch 4 Step 201 Train Loss: 0.5756
Epoch 4: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0008. 
Train Top 20 DE MSE: 0.0018 Validation Top 20 DE MSE: 0.0019. 
Epoch 5 Step 1 Train Loss: 0.5260
Epoch 5 Step 51 Train Loss: 0.5443
Epoch 5 Step 101 Train Loss: 0.6968
Epoch 5 Step 151 Train Loss: 0.5634
Epoch 5 Step 201 Train Loss: 0.5100
Epoch 5: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0011. 
Train Top 20 DE MSE: 0.0016 Validation Top 20 DE MSE: 0.0010. 
Epoch 6 Step 1 Train Loss: 0.5516
Epoch 6 Step 51 Train Loss: 0.5505
Epoch 6 Step 101 Train Loss: 0.4865
Epoch 6 Step 151 Train Loss: 0.5174
Epoch 6 Step 201 Train Loss: 0.5036
Epoch 6: Train Overall MSE: 0.0008 Validation Overall MSE: 0.0010. 
Train Top 20 DE MSE: 0.0014 Validation Top 20 DE MSE: 0.0011. 
Epoch 7 Step 1 Train Loss: 0.5337
Epoch 7 Step 51 Train Loss: 0.5797
Epoch 7 Step 101 Train Loss: 0.6171
Epoch 7 Step 151 Train Loss: 0.5570
Epoch 7 Step 201 Train Loss: 0.6154
Epoch 7: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0010. 
Train Top 20 DE MSE: 0.0015 Validation Top 20 DE MSE: 0.0009. 
Epoch 8 Step 1 Train Loss: 0.4941
Epoch 8 Step 51 Train Loss: 0.5992
Epoch 8 Step 101 Train Loss: 0.5713
Epoch 8 Step 151 Train Loss: 0.5641
Epoch 8 Step 201 Train Loss: 0.5175
Epoch 8: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0009. 
Train Top 20 DE MSE: 0.0017 Validation Top 20 DE MSE: 0.0011. 
Epoch 9 Step 1 Train Loss: 0.5929
Epoch 9 Step 51 Train Loss: 0.5276
Epoch 9 Step 101 Train Loss: 0.5284
Epoch 9 Step 151 Train Loss: 0.5560
Epoch 9 Step 201 Train Loss: 0.5528
Epoch 9: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0008. 
Train Top 20 DE MSE: 0.0017 Validation Top 20 DE MSE: 0.0015. 
Epoch 10 Step 1 Train Loss: 0.6519
Epoch 10 Step 51 Train Loss: 0.6136
Epoch 10 Step 101 Train Loss: 0.5417
Epoch 10 Step 151 Train Loss: 0.6338
Epoch 10 Step 201 Train Loss: 0.5911
Epoch 10: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0009. 
Train Top 20 DE MSE: 0.0017 Validation Top 20 DE MSE: 0.0010. 
Epoch 11 Step 1 Train Loss: 0.5883
Epoch 11 Step 51 Train Loss: 0.6317
Epoch 11 Step 101 Train Loss: 0.5578
Epoch 11 Step 151 Train Loss: 0.5671
Epoch 11 Step 201 Train Loss: 0.4587
Epoch 11: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0010. 
Train Top 20 DE MSE: 0.0017 Validation Top 20 DE MSE: 0.0009. 
Epoch 12 Step 1 Train Loss: 0.5144
Epoch 12 Step 51 Train Loss: 0.6592
Epoch 12 Step 101 Train Loss: 0.5547
Epoch 12 Step 151 Train Loss: 0.5574
Epoch 12 Step 201 Train Loss: 0.5536
Epoch 12: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0010. 
Train Top 20 DE MSE: 0.0017 Validation Top 20 DE MSE: 0.0009. 
Epoch 13 Step 1 Train Loss: 0.5471
Epoch 13 Step 51 Train Loss: 0.5241
Epoch 13 Step 101 Train Loss: 0.5618
Epoch 13 Step 151 Train Loss: 0.5367
Epoch 13 Step 201 Train Loss: 0.5495
Epoch 13: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0009. 
Train Top 20 DE MSE: 0.0017 Validation Top 20 DE MSE: 0.0010. 
Epoch 14 Step 1 Train Loss: 0.5773
Epoch 14 Step 51 Train Loss: 0.4960
Epoch 14 Step 101 Train Loss: 0.5666
Epoch 14 Step 151 Train Loss: 0.4781
Epoch 14 Step 201 Train Loss: 0.6954
Epoch 14: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0010. 
Train Top 20 DE MSE: 0.0017 Validation Top 20 DE MSE: 0.0010. 
Epoch 15 Step 1 Train Loss: 0.6893
Epoch 15 Step 51 Train Loss: 0.5565
Epoch 15 Step 101 Train Loss: 0.4680
Epoch 15 Step 151 Train Loss: 0.5445
Epoch 15 Step 201 Train Loss: 0.4951
Epoch 15: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0010. 
Train Top 20 DE MSE: 0.0016 Validation Top 20 DE MSE: 0.0009. 
Done!
Start Testing...
Best performing model: Test Top 20 DE MSE: 0.0035
Start doing subgroup analysis for simulation split...
test_combo_seen0_mse: nan
test_combo_seen0_pearson: nan
test_combo_seen0_mse_de: nan
test_combo_seen0_pearson_de: nan
test_combo_seen1_mse: nan
test_combo_seen1_pearson: nan
test_combo_seen1_mse_de: nan
test_combo_seen1_pearson_de: nan
test_combo_seen2_mse: nan
test_combo_seen2_pearson: nan
test_combo_seen2_mse_de: nan
test_combo_seen2_pearson_de: nan
test_unseen_single_mse: 0.00083710166
test_unseen_single_pearson: 0.9986487780493937
test_unseen_single_mse_de: 0.0034749345
test_unseen_single_pearson_de: 0.99879284976964
test_combo_seen0_pearson_delta: nan
test_combo_seen0_frac_opposite_direction_top20_non_dropout: nan
test_combo_seen0_frac_sigma_below_1_non_dropout: nan
test_combo_seen0_mse_top20_de_non_dropout: nan
test_combo_seen1_pearson_delta: nan
test_combo_seen1_frac_opposite_direction_top20_non_dropout: nan
test_combo_seen1_frac_sigma_below_1_non_dropout: nan
test_combo_seen1_mse_top20_de_non_dropout: nan
test_combo_seen2_pearson_delta: nan
test_combo_seen2_frac_opposite_direction_top20_non_dropout: nan
test_combo_seen2_frac_sigma_below_1_non_dropout: nan
test_combo_seen2_mse_top20_de_non_dropout: nan
test_unseen_single_pearson_delta: 0.4278716917721309
test_unseen_single_frac_opposite_direction_top20_non_dropout: 0.07500000000000001
test_unseen_single_frac_sigma_below_1_non_dropout: 0.9875
test_unseen_single_mse_top20_de_non_dropout: 0.0034749346275874194
Done!
Creating new splits....
Saving new splits at /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03final/dixit_gsm2396861/splits/dixit_gsm2396861_simulation_4_0.75.pkl
Simulation split test composition:
combo_seen0:0
combo_seen1:0
combo_seen2:0
unseen_single:4
Done!
Creating dataloaders....
Done!
Start Training...
Epoch 1 Step 1 Train Loss: 1.2880
Epoch 1 Step 51 Train Loss: 0.7977
Epoch 1 Step 101 Train Loss: 0.5312
Epoch 1 Step 151 Train Loss: 0.5734
Epoch 1 Step 201 Train Loss: 0.5956
Epoch 1: Train Overall MSE: 0.0022 Validation Overall MSE: 0.0018. 
Train Top 20 DE MSE: 0.0051 Validation Top 20 DE MSE: 0.0120. 
Epoch 2 Step 1 Train Loss: 0.5405
Epoch 2 Step 51 Train Loss: 0.5480
Epoch 2 Step 101 Train Loss: 0.5940
Epoch 2 Step 151 Train Loss: 0.5860
Epoch 2 Step 201 Train Loss: 0.5583
Epoch 2: Train Overall MSE: 0.0011 Validation Overall MSE: 0.0006. 
Train Top 20 DE MSE: 0.0038 Validation Top 20 DE MSE: 0.0011. 
Epoch 3 Step 1 Train Loss: 0.5361
Epoch 3 Step 51 Train Loss: 0.6049
Epoch 3 Step 101 Train Loss: 0.5849
Epoch 3 Step 151 Train Loss: 0.6370
Epoch 3 Step 201 Train Loss: 0.6241
Epoch 3: Train Overall MSE: 0.0007 Validation Overall MSE: 0.0008. 
Train Top 20 DE MSE: 0.0036 Validation Top 20 DE MSE: 0.0011. 
Epoch 4 Step 1 Train Loss: 0.5610
Epoch 4 Step 51 Train Loss: 0.5544
Epoch 4 Step 101 Train Loss: 0.5265
Epoch 4 Step 151 Train Loss: 0.5572
Epoch 4 Step 201 Train Loss: 0.6084
Epoch 4: Train Overall MSE: 0.0008 Validation Overall MSE: 0.0007. 
Train Top 20 DE MSE: 0.0016 Validation Top 20 DE MSE: 0.0010. 
Epoch 5 Step 1 Train Loss: 0.5375
Epoch 5 Step 51 Train Loss: 0.5855
Epoch 5 Step 101 Train Loss: 0.5318
Epoch 5 Step 151 Train Loss: 0.5744
Epoch 5 Step 201 Train Loss: 0.6284
Epoch 5: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0006. 
Train Top 20 DE MSE: 0.0016 Validation Top 20 DE MSE: 0.0009. 
Epoch 6 Step 1 Train Loss: 0.5166
Epoch 6 Step 51 Train Loss: 0.5783
Epoch 6 Step 101 Train Loss: 0.6499
Epoch 6 Step 151 Train Loss: 0.5637
Epoch 6 Step 201 Train Loss: 0.5453
Epoch 6: Train Overall MSE: 0.0008 Validation Overall MSE: 0.0006. 
Train Top 20 DE MSE: 0.0017 Validation Top 20 DE MSE: 0.0009. 
Epoch 7 Step 1 Train Loss: 0.5237
Epoch 7 Step 51 Train Loss: 0.5147
Epoch 7 Step 101 Train Loss: 0.5332
Epoch 7 Step 151 Train Loss: 0.4991
Epoch 7 Step 201 Train Loss: 0.5688
Epoch 7: Train Overall MSE: 0.0008 Validation Overall MSE: 0.0006. 
Train Top 20 DE MSE: 0.0016 Validation Top 20 DE MSE: 0.0009. 
Epoch 8 Step 1 Train Loss: 0.4903
Epoch 8 Step 51 Train Loss: 0.6825
Epoch 8 Step 101 Train Loss: 0.5888
Epoch 8 Step 151 Train Loss: 0.6340
Epoch 8 Step 201 Train Loss: 0.6422
Epoch 8: Train Overall MSE: 0.0008 Validation Overall MSE: 0.0007. 
Train Top 20 DE MSE: 0.0016 Validation Top 20 DE MSE: 0.0010. 
Epoch 9 Step 1 Train Loss: 0.5976
Epoch 9 Step 51 Train Loss: 0.6476
Epoch 9 Step 101 Train Loss: 0.4719
Epoch 9 Step 151 Train Loss: 0.8146
Epoch 9 Step 201 Train Loss: 0.5073
Epoch 9: Train Overall MSE: 0.0008 Validation Overall MSE: 0.0007. 
Train Top 20 DE MSE: 0.0017 Validation Top 20 DE MSE: 0.0010. 
Epoch 10 Step 1 Train Loss: 0.5685
Epoch 10 Step 51 Train Loss: 0.5405
Epoch 10 Step 101 Train Loss: 0.5690
Epoch 10 Step 151 Train Loss: 0.5899
Epoch 10 Step 201 Train Loss: 0.5581
Epoch 10: Train Overall MSE: 0.0008 Validation Overall MSE: 0.0006. 
Train Top 20 DE MSE: 0.0017 Validation Top 20 DE MSE: 0.0010. 
Epoch 11 Step 1 Train Loss: 0.5530
Epoch 11 Step 51 Train Loss: 0.5591
Epoch 11 Step 101 Train Loss: 0.5746
Epoch 11 Step 151 Train Loss: 0.5359
Epoch 11 Step 201 Train Loss: 0.5470
Epoch 11: Train Overall MSE: 0.0008 Validation Overall MSE: 0.0007. 
Train Top 20 DE MSE: 0.0016 Validation Top 20 DE MSE: 0.0010. 
Epoch 12 Step 1 Train Loss: 0.6022
Epoch 12 Step 51 Train Loss: 0.5403
Epoch 12 Step 101 Train Loss: 0.6017
Epoch 12 Step 151 Train Loss: 0.5378
Epoch 12 Step 201 Train Loss: 0.5106
Epoch 12: Train Overall MSE: 0.0008 Validation Overall MSE: 0.0007. 
Train Top 20 DE MSE: 0.0017 Validation Top 20 DE MSE: 0.0010. 
Epoch 13 Step 1 Train Loss: 0.5859
Epoch 13 Step 51 Train Loss: 0.5157
Epoch 13 Step 101 Train Loss: 0.5673
Epoch 13 Step 151 Train Loss: 0.4954
Epoch 13 Step 201 Train Loss: 0.5493
Epoch 13: Train Overall MSE: 0.0008 Validation Overall MSE: 0.0007. 
Train Top 20 DE MSE: 0.0016 Validation Top 20 DE MSE: 0.0010. 
Epoch 14 Step 1 Train Loss: 0.4900
Epoch 14 Step 51 Train Loss: 0.5693
Epoch 14 Step 101 Train Loss: 0.5377
Epoch 14 Step 151 Train Loss: 0.5156
Epoch 14 Step 201 Train Loss: 0.6473
Epoch 14: Train Overall MSE: 0.0008 Validation Overall MSE: 0.0007. 
Train Top 20 DE MSE: 0.0016 Validation Top 20 DE MSE: 0.0010. 
Epoch 15 Step 1 Train Loss: 0.4833
Epoch 15 Step 51 Train Loss: 0.6213
Epoch 15 Step 101 Train Loss: 0.5856
Epoch 15 Step 151 Train Loss: 0.5646
Epoch 15 Step 201 Train Loss: 0.5662
Epoch 15: Train Overall MSE: 0.0008 Validation Overall MSE: 0.0006. 
Train Top 20 DE MSE: 0.0017 Validation Top 20 DE MSE: 0.0010. 
Done!
Start Testing...
Best performing model: Test Top 20 DE MSE: 0.0016
Start doing subgroup analysis for simulation split...
test_combo_seen0_mse: nan
test_combo_seen0_pearson: nan
test_combo_seen0_mse_de: nan
test_combo_seen0_pearson_de: nan
test_combo_seen1_mse: nan
test_combo_seen1_pearson: nan
test_combo_seen1_mse_de: nan
test_combo_seen1_pearson_de: nan
test_combo_seen2_mse: nan
test_combo_seen2_pearson: nan
test_combo_seen2_mse_de: nan
test_combo_seen2_pearson_de: nan
test_unseen_single_mse: 0.00065412984
test_unseen_single_pearson: 0.9989307744266834
test_unseen_single_mse_de: 0.0015670434
test_unseen_single_pearson_de: 0.9993920935931537
test_combo_seen0_pearson_delta: nan
test_combo_seen0_frac_opposite_direction_top20_non_dropout: nan
test_combo_seen0_frac_sigma_below_1_non_dropout: nan
test_combo_seen0_mse_top20_de_non_dropout: nan
test_combo_seen1_pearson_delta: nan
test_combo_seen1_frac_opposite_direction_top20_non_dropout: nan
test_combo_seen1_frac_sigma_below_1_non_dropout: nan
test_combo_seen1_mse_top20_de_non_dropout: nan
test_combo_seen2_pearson_delta: nan
test_combo_seen2_frac_opposite_direction_top20_non_dropout: nan
test_combo_seen2_frac_sigma_below_1_non_dropout: nan
test_combo_seen2_mse_top20_de_non_dropout: nan
test_unseen_single_pearson_delta: 0.48328277495181127
test_unseen_single_frac_opposite_direction_top20_non_dropout: 0.025
test_unseen_single_frac_sigma_below_1_non_dropout: 1.0
test_unseen_single_mse_top20_de_non_dropout: 0.0016130064555963863
Done!
Creating new splits....
Saving new splits at /home/share/huadjyin/home/zhoumin3/zhoumin/benchmark_data/01A_total_re/03final/dixit_gsm2396861/splits/dixit_gsm2396861_simulation_5_0.75.pkl
Simulation split test composition:
combo_seen0:0
combo_seen1:0
combo_seen2:0
unseen_single:4
Done!
Creating dataloaders....
Done!
Start Training...
Epoch 1 Step 1 Train Loss: 0.9811
Epoch 1 Step 51 Train Loss: 0.6127
Epoch 1 Step 101 Train Loss: 0.6588
Epoch 1 Step 151 Train Loss: 0.6405
Epoch 1: Train Overall MSE: 0.0023 Validation Overall MSE: 0.0027. 
Train Top 20 DE MSE: 0.0062 Validation Top 20 DE MSE: 0.0261. 
Epoch 2 Step 1 Train Loss: 0.5668
Epoch 2 Step 51 Train Loss: 0.5459
Epoch 2 Step 101 Train Loss: 0.6999
Epoch 2 Step 151 Train Loss: 0.4968
Epoch 2: Train Overall MSE: 0.0011 Validation Overall MSE: 0.0005. 
Train Top 20 DE MSE: 0.0029 Validation Top 20 DE MSE: 0.0101. 
Epoch 3 Step 1 Train Loss: 0.5768
Epoch 3 Step 51 Train Loss: 0.5662
Epoch 3 Step 101 Train Loss: 0.5654
Epoch 3 Step 151 Train Loss: 0.5329
Epoch 3: Train Overall MSE: 0.0011 Validation Overall MSE: 0.0004. 
Train Top 20 DE MSE: 0.0021 Validation Top 20 DE MSE: 0.0058. 
Epoch 4 Step 1 Train Loss: 0.5672
Epoch 4 Step 51 Train Loss: 0.5300
Epoch 4 Step 101 Train Loss: 0.5834
Epoch 4 Step 151 Train Loss: 0.5161
Epoch 4: Train Overall MSE: 0.0008 Validation Overall MSE: 0.0005. 
Train Top 20 DE MSE: 0.0022 Validation Top 20 DE MSE: 0.0051. 
Epoch 5 Step 1 Train Loss: 0.6125
Epoch 5 Step 51 Train Loss: 0.5300
Epoch 5 Step 101 Train Loss: 0.5130
Epoch 5 Step 151 Train Loss: 0.5110
Epoch 5: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0006. 
Train Top 20 DE MSE: 0.0023 Validation Top 20 DE MSE: 0.0051. 
Epoch 6 Step 1 Train Loss: 0.5688
Epoch 6 Step 51 Train Loss: 0.6401
Epoch 6 Step 101 Train Loss: 0.6323
Epoch 6 Step 151 Train Loss: 0.6384
Epoch 6: Train Overall MSE: 0.0008 Validation Overall MSE: 0.0004. 
Train Top 20 DE MSE: 0.0017 Validation Top 20 DE MSE: 0.0066. 
Epoch 7 Step 1 Train Loss: 0.5867
Epoch 7 Step 51 Train Loss: 0.7246
Epoch 7 Step 101 Train Loss: 0.5504
Epoch 7 Step 151 Train Loss: 0.6197
Epoch 7: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0005. 
Train Top 20 DE MSE: 0.0019 Validation Top 20 DE MSE: 0.0072. 
Epoch 8 Step 1 Train Loss: 0.6381
Epoch 8 Step 51 Train Loss: 0.5627
Epoch 8 Step 101 Train Loss: 0.5114
Epoch 8 Step 151 Train Loss: 0.5032
Epoch 8: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0005. 
Train Top 20 DE MSE: 0.0020 Validation Top 20 DE MSE: 0.0071. 
Epoch 9 Step 1 Train Loss: 0.5648
Epoch 9 Step 51 Train Loss: 0.4607
Epoch 9 Step 101 Train Loss: 0.5070
Epoch 9 Step 151 Train Loss: 0.6450
Epoch 9: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0005. 
Train Top 20 DE MSE: 0.0020 Validation Top 20 DE MSE: 0.0056. 
Epoch 10 Step 1 Train Loss: 0.5045
Epoch 10 Step 51 Train Loss: 0.5779
Epoch 10 Step 101 Train Loss: 0.6025
Epoch 10 Step 151 Train Loss: 0.5951
Epoch 10: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0005. 
Train Top 20 DE MSE: 0.0020 Validation Top 20 DE MSE: 0.0061. 
Epoch 11 Step 1 Train Loss: 0.7219
Epoch 11 Step 51 Train Loss: 0.6201
Epoch 11 Step 101 Train Loss: 0.5667
Epoch 11 Step 151 Train Loss: 0.5997
Epoch 11: Train Overall MSE: 0.0010 Validation Overall MSE: 0.0005. 
Train Top 20 DE MSE: 0.0020 Validation Top 20 DE MSE: 0.0061. 
Epoch 12 Step 1 Train Loss: 0.5725
Epoch 12 Step 51 Train Loss: 0.6090
Epoch 12 Step 101 Train Loss: 0.5728
Epoch 12 Step 151 Train Loss: 0.5791
Epoch 12: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0005. 
Train Top 20 DE MSE: 0.0021 Validation Top 20 DE MSE: 0.0060. 
Epoch 13 Step 1 Train Loss: 0.5793
Epoch 13 Step 51 Train Loss: 0.5326
Epoch 13 Step 101 Train Loss: 0.5475
Epoch 13 Step 151 Train Loss: 0.5426
Epoch 13: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0006. 
Train Top 20 DE MSE: 0.0020 Validation Top 20 DE MSE: 0.0052. 
Epoch 14 Step 1 Train Loss: 0.6101
Epoch 14 Step 51 Train Loss: 0.6302
Epoch 14 Step 101 Train Loss: 0.6600
Epoch 14 Step 151 Train Loss: 0.5412
Epoch 14: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0005. 
Train Top 20 DE MSE: 0.0021 Validation Top 20 DE MSE: 0.0068. 
Epoch 15 Step 1 Train Loss: 0.5395
Epoch 15 Step 51 Train Loss: 0.5066
Epoch 15 Step 101 Train Loss: 0.5156
Epoch 15 Step 151 Train Loss: 0.5306
Epoch 15: Train Overall MSE: 0.0009 Validation Overall MSE: 0.0005. 
Train Top 20 DE MSE: 0.0020 Validation Top 20 DE MSE: 0.0072. 
Done!
Start Testing...
Best performing model: Test Top 20 DE MSE: 0.0028
Start doing subgroup analysis for simulation split...
test_combo_seen0_mse: nan
test_combo_seen0_pearson: nan
test_combo_seen0_mse_de: nan
test_combo_seen0_pearson_de: nan
test_combo_seen1_mse: nan
test_combo_seen1_pearson: nan
test_combo_seen1_mse_de: nan
test_combo_seen1_pearson_de: nan
test_combo_seen2_mse: nan
test_combo_seen2_pearson: nan
test_combo_seen2_mse_de: nan
test_combo_seen2_pearson_de: nan
test_unseen_single_mse: 0.0006604678
test_unseen_single_pearson: 0.998924907218151
test_unseen_single_mse_de: 0.002834721
test_unseen_single_pearson_de: 0.9993028636132191
test_combo_seen0_pearson_delta: nan
test_combo_seen0_frac_opposite_direction_top20_non_dropout: nan
test_combo_seen0_frac_sigma_below_1_non_dropout: nan
test_combo_seen0_mse_top20_de_non_dropout: nan
test_combo_seen1_pearson_delta: nan
test_combo_seen1_frac_opposite_direction_top20_non_dropout: nan
test_combo_seen1_frac_sigma_below_1_non_dropout: nan
test_combo_seen1_mse_top20_de_non_dropout: nan
test_combo_seen2_pearson_delta: nan
test_combo_seen2_frac_opposite_direction_top20_non_dropout: nan
test_combo_seen2_frac_sigma_below_1_non_dropout: nan
test_combo_seen2_mse_top20_de_non_dropout: nan
test_unseen_single_pearson_delta: 0.4837710178185378
test_unseen_single_frac_opposite_direction_top20_non_dropout: 0.075
test_unseen_single_frac_sigma_below_1_non_dropout: 0.9750000000000001
test_unseen_single_mse_top20_de_non_dropout: 0.0029864928288213578
Done!
